{"ast":null,"code":"import LayoutView from './components/LayoutView.vue';\nexport default {\n  name: 'App',\n  components: {\n    LayoutView\n  },\n  data() {\n    return {\n      tokenCheckInterval: null\n    };\n  },\n  mounted() {\n    // Initialize theme\n    this.$store.dispatch('initTheme');\n\n    // ตรวจสอบ token expiration ทุก 1 นาที\n    this.tokenCheckInterval = setInterval(() => {\n      this.checkTokenExpiration();\n    }, 60000);\n  },\n  beforeUnmount() {\n    if (this.tokenCheckInterval) {\n      clearInterval(this.tokenCheckInterval);\n    }\n  },\n  methods: {\n    checkTokenExpiration() {\n      const token = localStorage.getItem('soc_token');\n      if (!token) return;\n      try {\n        const parts = token.split('.');\n        if (parts.length !== 3) return;\n        const payload = JSON.parse(atob(parts[1]));\n        if (Date.now() >= payload.exp * 1000) {\n          // Token หมดอายุ - logout\n          localStorage.clear();\n          sessionStorage.clear();\n          document.cookie.split(\";\").forEach(c => {\n            document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\");\n          });\n          this.$router.push('/login');\n        }\n      } catch {\n        // ignore parse errors\n      }\n    }\n  }\n};","map":{"version":3,"names":["LayoutView","name","components","data","tokenCheckInterval","mounted","$store","dispatch","setInterval","checkTokenExpiration","beforeUnmount","clearInterval","methods","token","localStorage","getItem","parts","split","length","payload","JSON","parse","atob","Date","now","exp","clear","sessionStorage","document","cookie","forEach","c","replace","toUTCString","$router","push"],"sources":["D:\\frontend_cem\\src\\App.vue"],"sourcesContent":["<!-- App.vue -->\n<template>\n  <div id=\"app\" :class=\"{ 'dark-mode': $store.state.darkMode }\" style=\"height: 100vh; overflow: hidden;\">\n    <!-- Global Loading Overlay -->\n    <div v-if=\"$store.state.loading\" class=\"loading-overlay\">\n      <div class=\"spinner\"></div>\n    </div>\n    \n    <!-- Show only router-view for login page -->\n    <div v-if=\"$router.currentRoute.value.fullPath == '/login'\">\n      <router-view />\n    </div>\n    <!-- Show LayoutView with sidebar for other pages -->\n    <div v-else>\n      <LayoutView />\n    </div>\n  </div>\n</template>\n\n<script>\nimport LayoutView from './components/LayoutView.vue';\n\nexport default {\n  name: 'App',\n  components: {\n    LayoutView,\n  },\n  data() {\n    return {\n      tokenCheckInterval: null\n    }\n  },\n  mounted() {\n    // Initialize theme\n    this.$store.dispatch('initTheme')\n    \n    // ตรวจสอบ token expiration ทุก 1 นาที\n    this.tokenCheckInterval = setInterval(() => {\n      this.checkTokenExpiration()\n    }, 60000)\n  },\n  beforeUnmount() {\n    if (this.tokenCheckInterval) {\n      clearInterval(this.tokenCheckInterval)\n    }\n  },\n  methods: {\n    checkTokenExpiration() {\n      const token = localStorage.getItem('soc_token')\n      if (!token) return\n      \n      try {\n        const parts = token.split('.')\n        if (parts.length !== 3) return\n        \n        const payload = JSON.parse(atob(parts[1]))\n        if (Date.now() >= payload.exp * 1000) {\n          // Token หมดอายุ - logout\n          localStorage.clear()\n          sessionStorage.clear()\n          document.cookie.split(\";\").forEach((c) => {\n            document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\")\n          })\n          this.$router.push('/login')\n        }\n      } catch {\n        // ignore parse errors\n      }\n    }\n  }\n};\n</script>\n\n<style>\n@import '/src/assets/styles/main.css';\n\n:root {\n  --label-color: #64748b;\n  --status-closed-red: #A90F0A;\n  --table-font-size: 1rem;\n  --default-font-size: 0.8rem;\n  font-size: var(--default-font-size);\n  \n  /* Light mode (default) */\n  --bg-primary: #ffffff;\n  --bg-secondary: #e5e7eb;\n  --bg-card: #ffffff;\n  --text-primary: #1f2937;\n  --text-secondary: #6b7280;\n  --border-color: #e5e7eb;\n}\n\n[data-theme=\"dark\"] {\n  --bg-primary: #1f2937;\n  --bg-secondary: #111827;\n  --bg-card: #374151;\n  --text-primary: #f9fafb;\n  --text-secondary: #d1d5db;\n  --border-color: #4b5563;\n  --label-color: #9ca3af;\n}\n\nlabel {\n  margin-bottom: 2px;\n  color: var(--label-color);\n  font-size: 0.875rem;\n}\n\n* {\n  box-sizing: border-box;\n}\n\nbody {\n  margin: 0;\n  padding: 0;\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n}\n\n/* Loading Overlay */\n.loading-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 9999;\n}\n\n.spinner {\n  width: 50px;\n  height: 50px;\n  border: 5px solid rgba(255, 255, 255, 0.3);\n  border-top-color: #fff;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n/* Scrollbar */\n::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n}\n\n::-webkit-scrollbar-track {\n  background: #f1f1f1;\n  border-radius: 3px;\n}\n\n::-webkit-scrollbar-thumb {\n  background: #c1c1c1;\n  border-radius: 3px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: #a1a1a1;\n}\n</style>\n"],"mappings":"AAoBA,OAAOA,UAAS,MAAO,6BAA6B;AAEpD,eAAe;EACbC,IAAI,EAAE,KAAK;EACXC,UAAU,EAAE;IACVF;EACF,CAAC;EACDG,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,kBAAkB,EAAE;IACtB;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR;IACA,IAAI,CAACC,MAAM,CAACC,QAAQ,CAAC,WAAW;;IAEhC;IACA,IAAI,CAACH,kBAAiB,GAAII,WAAW,CAAC,MAAM;MAC1C,IAAI,CAACC,oBAAoB,CAAC;IAC5B,CAAC,EAAE,KAAK;EACV,CAAC;EACDC,aAAaA,CAAA,EAAG;IACd,IAAI,IAAI,CAACN,kBAAkB,EAAE;MAC3BO,aAAa,CAAC,IAAI,CAACP,kBAAkB;IACvC;EACF,CAAC;EACDQ,OAAO,EAAE;IACPH,oBAAoBA,CAAA,EAAG;MACrB,MAAMI,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,WAAW;MAC9C,IAAI,CAACF,KAAK,EAAE;MAEZ,IAAI;QACF,MAAMG,KAAI,GAAIH,KAAK,CAACI,KAAK,CAAC,GAAG;QAC7B,IAAID,KAAK,CAACE,MAAK,KAAM,CAAC,EAAE;QAExB,MAAMC,OAAM,GAAIC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACN,KAAK,CAAC,CAAC,CAAC,CAAC;QACzC,IAAIO,IAAI,CAACC,GAAG,CAAC,KAAKL,OAAO,CAACM,GAAE,GAAI,IAAI,EAAE;UACpC;UACAX,YAAY,CAACY,KAAK,CAAC;UACnBC,cAAc,CAACD,KAAK,CAAC;UACrBE,QAAQ,CAACC,MAAM,CAACZ,KAAK,CAAC,GAAG,CAAC,CAACa,OAAO,CAAEC,CAAC,IAAK;YACxCH,QAAQ,CAACC,MAAK,GAAIE,CAAC,CAACC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAACA,OAAO,CAAC,KAAK,EAAE,YAAW,GAAI,IAAIT,IAAI,CAAC,CAAC,CAACU,WAAW,CAAC,IAAI,SAAS;UAC3G,CAAC;UACD,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,QAAQ;QAC5B;MACF,EAAE,MAAM;QACN;MAAA;IAEJ;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}