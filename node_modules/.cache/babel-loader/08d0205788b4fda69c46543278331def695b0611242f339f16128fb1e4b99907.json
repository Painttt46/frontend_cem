{"ast":null,"code":"import axios from '@/utils/axiosConfig';\nimport EnhancedDataTable from '@/components/EnhancedDataTable.vue';\nimport UserInfoDialog from '@/components/UserInfoDialog.vue';\nexport default {\n  name: 'TaskList',\n  components: {\n    EnhancedDataTable,\n    UserInfoDialog\n  },\n  created() {\n    this.$http = axios;\n  },\n  async mounted() {\n    // Listen for task updates\n    window.addEventListener('taskUpdated', this.handleTaskUpdate);\n    window.addEventListener('workRecordUpdated', this.handleTaskUpdate);\n    window.addEventListener('taskStatusChanged', this.handleTaskUpdate);\n    window.addEventListener('categoriesUpdated', this.handleCategoriesUpdate);\n    window.addEventListener('statusesUpdated', this.handleStatusesUpdate);\n\n    // Load categories and statuses first, then tasks\n    await this.loadCategoriesFromStorage();\n    await this.loadStatusesFromStorage();\n    this.loadTasks();\n  },\n  beforeUnmount() {\n    window.removeEventListener('taskUpdated', this.handleTaskUpdate);\n    window.removeEventListener('workRecordUpdated', this.handleTaskUpdate);\n    window.removeEventListener('taskStatusChanged', this.handleTaskUpdate);\n    window.removeEventListener('categoriesUpdated', this.handleCategoriesUpdate);\n    window.removeEventListener('statusesUpdated', this.handleStatusesUpdate);\n  },\n  data() {\n    return {\n      tasks: [],\n      detailDialog: false,\n      selectedTask: null,\n      filesDialog: false,\n      selectedTaskFiles: [],\n      fullImageDialog: false,\n      fullImageUrl: '',\n      editDialog: false,\n      taskWorksDialog: false,\n      taskWorks: [],\n      loadingWorks: false,\n      workFilesDialog: false,\n      selectedWorkFiles: [],\n      showUserInfoDialog: false,\n      selectedUserId: null,\n      selectedUserName: '',\n      workStatusFilter: null,\n      workSortBy: 'date_desc',\n      workSortOptions: [{\n        label: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î',\n        value: 'date_desc'\n      }, {\n        label: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î',\n        value: 'date_asc'\n      }, {\n        label: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞',\n        value: 'status'\n      }],\n      editFormData: {\n        id: null,\n        task_name: '',\n        so_number: '',\n        contract_number: '',\n        sale_owner: '',\n        description: '',\n        category: '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',\n        project_start_date: null,\n        project_end_date: null,\n        existingFiles: [],\n        newFiles: []\n      },\n      categoryOptions: [{\n        label: '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',\n        value: '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ'\n      }, {\n        label: '‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö',\n        value: '‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö'\n      }, {\n        label: '‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤',\n        value: '‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤'\n      }, {\n        label: '‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°',\n        value: '‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'\n      }, {\n        label: '‡∏á‡∏≤‡∏ô‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°',\n        value: '‡∏á‡∏≤‡∏ô‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°'\n      }, {\n        label: '‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢',\n        value: '‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢'\n      }, {\n        label: '‡∏á‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£',\n        value: '‡∏á‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£'\n      }, {\n        label: '‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤',\n        value: '‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤'\n      }],\n      categories: [],\n      workStatuses: []\n    };\n  },\n  computed: {\n    workStatusFilterOptions() {\n      const options = [{\n        label: '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',\n        value: null\n      }];\n      this.workStatuses.forEach(s => {\n        options.push({\n          label: s.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim(),\n          value: s.value\n        });\n      });\n      return options;\n    },\n    enrichedTasks() {\n      // Add status and category labels to tasks for better search\n      return this.tasks.map(task => ({\n        ...task,\n        statusLabel: this.getStatusLabel(task.status),\n        categoryLabel: this.getCategoryLabel(task.category)\n      }));\n    },\n    filteredAndSortedWorks() {\n      let works = [...this.taskWorks];\n\n      // Filter by status\n      if (this.workStatusFilter) {\n        works = works.filter(work => work.work_status === this.workStatusFilter);\n      }\n\n      // Sort\n      if (this.workSortBy === 'date_desc') {\n        works.sort((a, b) => new Date(b.work_date) - new Date(a.work_date));\n      } else if (this.workSortBy === 'date_asc') {\n        works.sort((a, b) => new Date(a.work_date) - new Date(b.work_date));\n      } else if (this.workSortBy === 'status') {\n        const statusOrder = {\n          'completed': 1,\n          'in_progress': 2,\n          'pending': 3,\n          'on_hold': 4\n        };\n        works.sort((a, b) => (statusOrder[a.work_status] || 5) - (statusOrder[b.work_status] || 5));\n      }\n      return works;\n    }\n  },\n  methods: {\n    confirmDeleteTask(task) {\n      this.$confirm.require({\n        message: `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏á‡∏≤‡∏ô \"${task.task_name}\" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`,\n        header: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',\n        icon: 'pi pi-exclamation-triangle',\n        acceptLabel: '‡∏•‡∏ö',\n        rejectLabel: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',\n        acceptClass: 'p-button-danger',\n        accept: () => {\n          this.deleteTask(task.id);\n        }\n      });\n    },\n    async deleteTask(taskId) {\n      try {\n        await this.$http.delete(`/api/tasks/${taskId}`);\n        this.$toast.add({\n          severity: 'success',\n          summary: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',\n          detail: '‡∏•‡∏ö‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',\n          life: 3000\n        });\n        this.loadTasks();\n        window.dispatchEvent(new CustomEvent('taskUpdated'));\n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: error.response?.data?.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\n          life: 5000\n        });\n      }\n    },\n    async loadCategoriesFromStorage() {\n      try {\n        const response = await this.$http.get('/api/settings/categories');\n        this.categories = response.data;\n      } catch (error) {\n        // Fallback to default\n        this.categories = [{\n          label: 'üíº ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',\n          value: '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',\n          icon: 'emoji:üíº',\n          color: '#6366f1'\n        }, {\n          label: 'üíª ‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤',\n          value: '‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤',\n          icon: 'emoji:üíª',\n          color: '#14b8a6'\n        }, {\n          label: 'üîß ‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤',\n          value: '‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤',\n          icon: 'emoji:üîß',\n          color: '#f97316'\n        }];\n      }\n    },\n    async loadStatusesFromStorage() {\n      try {\n        const response = await this.$http.get('/api/settings/statuses');\n        this.workStatuses = response.data;\n      } catch (error) {\n        // Fallback to default\n        this.workStatuses = [{\n          label: '‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',\n          value: 'pending',\n          icon: 'emoji:‚è≥',\n          color: '#f59e0b'\n        }, {\n          label: 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',\n          value: 'in_progress',\n          icon: 'emoji:üîÑ',\n          color: '#3b82f6'\n        }, {\n          label: '‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô',\n          value: 'completed',\n          icon: 'emoji:‚úÖ',\n          color: '#10b981'\n        }, {\n          label: '‚è∏Ô∏è ‡∏£‡∏∞‡∏á‡∏±‡∏ö',\n          value: 'on_hold',\n          icon: 'emoji:‚è∏Ô∏è',\n          color: '#6c757d'\n        }];\n      }\n    },\n    getCategoryIcon(categoryValue) {\n      const category = this.categories.find(cat => cat.value === categoryValue);\n      return category ? category.icon : 'pi pi-tag';\n    },\n    getCategoryLabel(categoryValue) {\n      const category = this.categories.find(cat => cat.value === categoryValue);\n      if (category && category.label) {\n        // Remove all emoji and special characters\n        return category.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim();\n      }\n      return categoryValue;\n    },\n    getCategoryColor(categoryValue) {\n      if (!this.categories || this.categories.length === 0) {\n        return '#6c757d';\n      }\n      const category = this.categories.find(cat => cat.value === categoryValue);\n      return category && category.color ? category.color : '#6c757d';\n    },\n    getStatusIcon(statusValue) {\n      const status = this.workStatuses.find(s => s.value === statusValue);\n      return status ? status.icon : 'pi pi-circle';\n    },\n    getStatusLabel(statusValue) {\n      if (!statusValue) return '-';\n      // ‡∏•‡∏≠‡∏á match ‡∏î‡πâ‡∏ß‡∏¢ value ‡∏Å‡πà‡∏≠‡∏ô\n      let status = this.workStatuses.find(s => s.value === statusValue);\n      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ ‡∏•‡∏≠‡∏á match ‡∏î‡πâ‡∏ß‡∏¢ label\n      if (!status) {\n        status = this.workStatuses.find(s => s.label && s.label.includes(statusValue));\n      }\n      if (status && status.label) {\n        // Remove all emoji and special characters\n        return status.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim();\n      }\n      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏ô workStatuses ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á\n      return statusValue;\n    },\n    getStatusColor(statusValue) {\n      if (!statusValue) return '#9e9e9e';\n      // ‡∏•‡∏≠‡∏á match ‡∏î‡πâ‡∏ß‡∏¢ value ‡∏Å‡πà‡∏≠‡∏ô\n      let status = this.workStatuses.find(s => s.value === statusValue);\n      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ ‡∏•‡∏≠‡∏á match ‡∏î‡πâ‡∏ß‡∏¢ label\n      if (!status) {\n        status = this.workStatuses.find(s => s.label && s.label.includes(statusValue));\n      }\n      return status?.color || '#9e9e9e';\n    },\n    async loadTasks() {\n      try {\n        const response = await this.$http.get('/api/tasks');\n        // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á format array ‡∏ï‡∏£‡∏á‡πÜ ‡πÅ‡∏•‡∏∞ format ‡∏ó‡∏µ‡πà‡∏°‡∏µ wrapper\n        this.tasks = response.data.data || response.data || [];\n      } catch (error) {\n        this.tasks = [];\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\n          life: 5000\n        });\n      }\n    },\n    formatDate(date) {\n      if (!date) return '-';\n      try {\n        // For date-only strings (YYYY-MM-DD), parse manually to avoid timezone issues\n        if (typeof date === 'string' && date.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n          const [year, month, day] = date.split('-');\n          const d = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\n          return d.toLocaleDateString('th-TH', {\n            year: 'numeric',\n            month: 'long',\n            day: 'numeric'\n          });\n        }\n        return new Date(date).toLocaleDateString('th-TH', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric'\n        });\n      } catch (error) {\n        return date;\n      }\n    },\n    showTaskDetails(task) {\n      this.selectedTask = task;\n      this.detailDialog = true;\n    },\n    isImageFile(fileName) {\n      const extension = fileName.split('.').pop()?.toLowerCase();\n      return ['jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp'].includes(extension);\n    },\n    getFileUrl(fileName) {\n      const token = localStorage.getItem('soc_token');\n      return `/api/files/download/${fileName}?token=${token}`;\n    },\n    viewFullImage(fileName) {\n      this.fullImageUrl = this.getFileUrl(fileName);\n      this.fullImageDialog = true;\n    },\n    hasFiles(task) {\n      return task.files && Array.isArray(task.files) && task.files.length > 0;\n    },\n    downloadTaskFiles(task) {\n      if (this.hasFiles(task)) {\n        this.selectedTaskFiles = task.files;\n        this.filesDialog = true;\n      }\n    },\n    async downloadFile(fileName) {\n      try {\n        const response = await this.$http.get(`/api/files/download/${fileName}`, {\n          responseType: 'blob'\n        });\n        const url = window.URL.createObjectURL(new Blob([response.data]));\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = fileName.split('-').slice(2).join('-') || fileName;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        window.URL.revokeObjectURL(url);\n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ',\n          life: 3000\n        });\n      }\n    },\n    editTask(task) {\n      // Parse dates from string to Date object\n      const parseDate = dateStr => {\n        if (!dateStr) return null;\n        if (typeof dateStr === 'string' && dateStr.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n          const [year, month, day] = dateStr.split('-');\n          // Create date at noon to avoid timezone issues\n          return new Date(parseInt(year), parseInt(month) - 1, parseInt(day), 12, 0, 0);\n        }\n        return new Date(dateStr);\n      };\n      this.editFormData = {\n        id: task.id,\n        task_name: task.task_name,\n        so_number: task.so_number || '',\n        contract_number: task.contract_number || '',\n        sale_owner: task.sale_owner || '',\n        description: task.description || '',\n        category: task.category || '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',\n        status: task.status || 'pending',\n        project_start_date: parseDate(task.project_start_date),\n        project_end_date: parseDate(task.project_end_date),\n        existingFiles: [...(task.files || [])],\n        newFiles: []\n      };\n      this.editDialog = true;\n    },\n    handleEditFileUpload(event) {\n      const files = Array.from(event.target.files);\n      this.editFormData.newFiles = [...this.editFormData.newFiles, ...files];\n    },\n    removeExistingFile(index) {\n      this.editFormData.existingFiles.splice(index, 1);\n    },\n    removeNewFile(index) {\n      this.editFormData.newFiles.splice(index, 1);\n    },\n    async uploadNewFiles() {\n      if (this.editFormData.newFiles.length === 0) return [];\n      const formData = new FormData();\n      this.editFormData.newFiles.forEach(file => {\n        formData.append('files', file);\n      });\n      try {\n        const response = await this.$http.post('/api/files/upload', formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        return response.data.files || [];\n      } catch (error) {\n        return [];\n      }\n    },\n    async updateTask() {\n      try {\n        // Upload ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà\n        const newUploadedFiles = await this.uploadNewFiles();\n\n        // ‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà\n        const allFiles = [...this.editFormData.existingFiles, ...newUploadedFiles];\n\n        // Format dates to YYYY-MM-DD\n        const formatDate = date => {\n          if (!date) return null;\n          const d = new Date(date);\n          const year = d.getFullYear();\n          const month = String(d.getMonth() + 1).padStart(2, '0');\n          const day = String(d.getDate()).padStart(2, '0');\n          return `${year}-${month}-${day}`;\n        };\n        const updateData = {\n          ...this.editFormData,\n          project_start_date: formatDate(this.editFormData.project_start_date),\n          project_end_date: formatDate(this.editFormData.project_end_date),\n          files: allFiles\n        };\n        delete updateData.existingFiles;\n        delete updateData.newFiles;\n        await this.$http.put(`/api/tasks/${this.editFormData.id}`, updateData);\n        this.$toast.add({\n          severity: 'success',\n          summary: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',\n          detail: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',\n          life: 3000\n        });\n        this.editDialog = false;\n\n        // Auto-refresh data\n        await this.loadTasks();\n\n        // Dispatch global event for real-time update\n        window.dispatchEvent(new CustomEvent('taskUpdated'));\n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: error.response?.data?.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\n          life: 5000\n        });\n      }\n    },\n    handleTaskUpdate() {\n      // Auto-refresh tasks when updated\n      this.loadTasks();\n    },\n    handleCategoriesUpdate() {\n      this.loadCategoriesFromStorage();\n    },\n    handleStatusesUpdate() {\n      this.loadStatusesFromStorage();\n    },\n    async refreshData() {\n      // Method for external refresh calls\n      await this.loadTasks();\n    },\n    async viewTaskWorks(task) {\n      this.selectedTask = task;\n      this.taskWorks = [];\n      this.loadingWorks = true;\n      this.taskWorksDialog = true;\n      this.workStatusFilter = null;\n      this.workSortBy = 'date_desc';\n      try {\n        const response = await this.$http.get(`/api/daily-work?task_id=${task.id}`);\n        this.taskWorks = response.data || [];\n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡πÑ‡∏î‡πâ',\n          life: 3000\n        });\n        this.taskWorks = [];\n      } finally {\n        this.loadingWorks = false;\n      }\n    },\n    formatDateTime(date) {\n      try {\n        return new Date(date).toLocaleString('th-TH', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n      } catch (error) {\n        return date;\n      }\n    },\n    getTotalHours() {\n      if (!this.taskWorks || this.taskWorks.length === 0) return '0 ‡∏ä‡∏°. 0 ‡∏ô‡∏≤‡∏ó‡∏µ';\n      const total = this.taskWorks.reduce((sum, work) => sum + (parseFloat(work.total_hours) || 0), 0);\n      const hours = Math.floor(total);\n      const minutes = Math.round((total - hours) * 60);\n      return `${hours} ‡∏ä‡∏°. ${minutes} ‡∏ô‡∏≤‡∏ó‡∏µ`;\n    },\n    showWorkFiles(work) {\n      this.selectedWorkFiles = work.files || [];\n      this.workFilesDialog = true;\n    },\n    downloadWorkFile(fileName) {\n      const link = document.createElement('a');\n      link.href = `/api/files/download/${fileName}`;\n      link.download = fileName;\n      link.target = '_blank';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    },\n    formatHoursMinutes(hours) {\n      const h = parseFloat(hours) || 0;\n      const hrs = Math.floor(h);\n      const mins = Math.round((h - hrs) * 60);\n      return `${hrs} ‡∏ä‡∏°. ${mins} ‡∏ô‡∏≤‡∏ó‡∏µ`;\n    },\n    showUserInfo(name, userId) {\n      this.selectedUserName = name;\n      this.selectedUserId = userId;\n      this.showUserInfoDialog = true;\n    }\n  }\n};","map":{"version":3,"names":["axios","EnhancedDataTable","UserInfoDialog","name","components","created","$http","mounted","window","addEventListener","handleTaskUpdate","handleCategoriesUpdate","handleStatusesUpdate","loadCategoriesFromStorage","loadStatusesFromStorage","loadTasks","beforeUnmount","removeEventListener","data","tasks","detailDialog","selectedTask","filesDialog","selectedTaskFiles","fullImageDialog","fullImageUrl","editDialog","taskWorksDialog","taskWorks","loadingWorks","workFilesDialog","selectedWorkFiles","showUserInfoDialog","selectedUserId","selectedUserName","workStatusFilter","workSortBy","workSortOptions","label","value","editFormData","id","task_name","so_number","contract_number","sale_owner","description","category","project_start_date","project_end_date","existingFiles","newFiles","categoryOptions","categories","workStatuses","computed","workStatusFilterOptions","options","forEach","s","push","replace","trim","enrichedTasks","map","task","statusLabel","getStatusLabel","status","categoryLabel","getCategoryLabel","filteredAndSortedWorks","works","filter","work","work_status","sort","a","b","Date","work_date","statusOrder","methods","confirmDeleteTask","$confirm","require","message","header","icon","acceptLabel","rejectLabel","acceptClass","accept","deleteTask","taskId","delete","$toast","add","severity","summary","detail","life","dispatchEvent","CustomEvent","error","response","get","color","getCategoryIcon","categoryValue","find","cat","getCategoryColor","length","getStatusIcon","statusValue","includes","getStatusColor","formatDate","date","match","year","month","day","split","d","parseInt","toLocaleDateString","showTaskDetails","isImageFile","fileName","extension","pop","toLowerCase","getFileUrl","token","localStorage","getItem","viewFullImage","hasFiles","files","Array","isArray","downloadTaskFiles","downloadFile","responseType","url","URL","createObjectURL","Blob","link","document","createElement","href","download","slice","join","body","appendChild","click","removeChild","revokeObjectURL","editTask","parseDate","dateStr","handleEditFileUpload","event","from","target","removeExistingFile","index","splice","removeNewFile","uploadNewFiles","formData","FormData","file","append","post","headers","updateTask","newUploadedFiles","allFiles","getFullYear","String","getMonth","padStart","getDate","updateData","put","refreshData","viewTaskWorks","formatDateTime","toLocaleString","hour","minute","getTotalHours","total","reduce","sum","parseFloat","total_hours","hours","Math","floor","minutes","round","showWorkFiles","downloadWorkFile","formatHoursMinutes","h","hrs","mins","showUserInfo","userId"],"sources":["D:\\frontend_cem\\src\\views\\daily_work\\TaskList.vue"],"sourcesContent":["<template>\n  <Card class=\"history-card\">\n    <template #content>\n      <div v-if=\"tasks.length === 0\" class=\"empty-state\">\n        <i class=\"pi pi-briefcase\" style=\"font-size: 4rem; color: #ccc;\"></i>\n        <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ß‡πâ</p>\n      </div>\n\n      <EnhancedDataTable v-else-if=\"categories.length > 0\" :data=\"enrichedTasks\" \n        :paginator=\"true\" :rows=\"10\" :rowsPerPageOptions=\"[5, 10, 20]\" \n        responsiveLayout=\"scroll\" class=\"history-table\" stripedRows>\n        \n        <Column field=\"id\" header=\"‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô\" :sortable=\"true\">\n          <template #body=\"slotProps\">\n            <div style=\"text-align: center;\">\n              <Badge :value=\"slotProps.data.id\" class=\"custom-id-badge\" />\n            </div>\n          </template>\n        </Column>\n\n        <Column field=\"task_name\" header=\"‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£\" :sortable=\"true\" style=\"min-width: 150px; max-width: 250px;\">\n          <template #body=\"slotProps\">\n            <div class=\"task-name\">{{ slotProps.data.task_name }}</div>\n          </template>\n        </Column>\n\n        <Column field=\"so_number\" header=\"‡πÄ‡∏•‡∏Ç SO\" class=\"hide-mobile\">\n          <template #body=\"slotProps\">\n            <div v-if=\"slotProps.data.so_number\" class=\"so-number\">\n              {{ slotProps.data.so_number }}\n            </div>\n            <span v-else class=\"text-muted\">-</span>\n          </template>\n        </Column>\n\n        <Column field=\"contract_number\" header=\"‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏ç‡∏ç‡∏≤\" class=\"hide-mobile\">\n          <template #body=\"slotProps\">\n            {{ slotProps.data.contract_number || '-' }}\n          </template>\n        </Column>\n\n        <Column field=\"sale_owner\" header=\"Sale ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô\" class=\"hide-mobile\">\n          <template #body=\"slotProps\">\n            <div v-if=\"slotProps.data.sale_owner\" class=\"sale-info\">\n              <i class=\"pi pi-user\"></i>\n              {{ slotProps.data.sale_owner }}\n            </div>\n            <span v-else class=\"text-muted\">-</span>\n          </template>\n        </Column>\n\n        <Column field=\"category\" header=\"‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà\" :sortable=\"true\" style=\"min-width: 120px; text-align: center;\">\n          <template #body=\"slotProps\">\n            <Badge :value=\"getCategoryLabel(slotProps.data.category)\" \n                   :style=\"{ backgroundColor: getCategoryColor(slotProps.data.category), color: '#fff', fontWeight: 'bold' }\" \n                   class=\"category-badge\" />\n          </template>\n        </Column>\n\n        <Column field=\"project_start_date\" header=\"‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£\" :sortable=\"true\">\n          <template #body=\"slotProps\">\n            {{ slotProps.data.project_start_date ? formatDate(slotProps.data.project_start_date) : '-' }}\n          </template>\n        </Column>\n\n        <Column field=\"project_end_date\" header=\"‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£\" :sortable=\"true\" class=\"hide-mobile\">\n          <template #body=\"slotProps\">\n            {{ slotProps.data.project_end_date ? formatDate(slotProps.data.project_end_date) : '-' }}\n          </template>\n        </Column>\n\n        <Column header=\"‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î\" class=\"hide-mobile\">\n          <template #body=\"slotProps\">\n            <Button \n              label=\"‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î\" \n              icon=\"pi pi-info-circle\" \n              size=\"small\" \n              severity=\"info\" \n              outlined \n              @click=\"showTaskDetails(slotProps.data)\"\n              :disabled=\"!slotProps.data.description\" />\n          </template>\n        </Column>\n\n        <Column header=\"‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\" style=\"text-align: center; min-width: 140px;\">\n          <template #body=\"slotProps\">\n            <div class=\"badge-container\">\n              <Badge v-if=\"slotProps.data.status && workStatuses.find(s => s.value === slotProps.data.status)\" \n                     :value=\"getStatusLabel(slotProps.data.status)\" \n                     :style=\"{ backgroundColor: getStatusColor(slotProps.data.status), color: '#fff', fontWeight: 'bold' }\" />\n              <span v-else class=\"no-status\">-</span>\n            </div>\n          </template>\n        </Column>\n\n        <Column header=\"‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£\" style=\"width: 200px;\">\n          <template #body=\"slotProps\">\n            <div class=\"action-buttons\">\n              <Button \n                icon=\"pi pi-eye\" \n                size=\"small\" \n                severity=\"info\" \n                outlined\n                @click=\"viewTaskWorks(slotProps.data)\"\n                v-tooltip=\"'‡∏î‡∏π‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô'\"\n              />\n              <Button \n                icon=\"pi pi-pencil\" \n                size=\"small\" \n                severity=\"warning\" \n                outlined\n                @click=\"editTask(slotProps.data)\"\n                v-tooltip=\"'‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç'\"\n              />\n              <Button \n                icon=\"pi pi-trash\" \n                size=\"small\" \n                severity=\"danger\" \n                outlined\n                @click=\"confirmDeleteTask(slotProps.data)\"\n                v-tooltip=\"'‡∏•‡∏ö'\"\n              />\n            </div>\n          </template>\n        </Column>\n\n        <Column header=\"‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö\" style=\"width: 80px;\">\n          <template #body=\"slotProps\">\n            <div v-if=\"hasFiles(slotProps.data)\" class=\"attachments-info\">\n              <Button icon=\"pi pi-paperclip\" size=\"small\" severity=\"info\" outlined\n                @click=\"downloadTaskFiles(slotProps.data)\" v-tooltip=\"`${slotProps.data.files.length} ‡πÑ‡∏ü‡∏•‡πå`\" />\n            </div>\n            <span v-else class=\"no-files\">-</span>\n          </template>\n        </Column>\n      </EnhancedDataTable>\n    </template>\n  </Card>\n\n  <!-- Dialog ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô -->\n  <div v-if=\"detailDialog\" class=\"dialog-overlay\" @click=\"detailDialog = false\">\n    <div class=\"dialog-content\" @click.stop>\n      <div class=\"dialog-header\">\n        <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô</h3>\n        <button class=\"dialog-close\" @click=\"detailDialog = false\">&times;</button>\n      </div>\n      <div class=\"dialog-body\">\n        <div class=\"work-description\">\n          {{ selectedTask?.description || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î' }}\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Files Dialog -->\n  <Dialog v-model:visible=\"filesDialog\" modal header=\"‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö\" :style=\"{ width: '90vw', maxWidth: '800px' }\" :draggable=\"false\">\n    <div v-if=\"selectedTaskFiles && selectedTaskFiles.length > 0\" class=\"files-list\">\n      <div v-for=\"(file, index) in selectedTaskFiles\" :key=\"index\" class=\"file-item\">\n        <div class=\"file-info\">\n          <img v-if=\"isImageFile(file)\" :src=\"getFileUrl(file)\" class=\"file-preview\" @click=\"viewFullImage(file)\" />\n          <i v-else class=\"pi pi-file file-icon\"></i>\n          <span class=\"file-name\">{{ file }}</span>\n        </div>\n        <Button \n          icon=\"pi pi-download\" \n          size=\"small\" \n          severity=\"success\" \n          outlined\n          @click=\"downloadFile(file)\"\n          v-tooltip=\"'‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î'\"\n        />\n      </div>\n    </div>\n    <div v-else class=\"no-files\">\n      <p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</p>\n    </div>\n  </Dialog>\n\n  <!-- Full Image Dialog -->\n  <Dialog v-model:visible=\"fullImageDialog\" modal header=\"‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û\" :style=\"{ width: '90vw', maxWidth: '900px' }\" :draggable=\"false\">\n    <img :src=\"fullImageUrl\" class=\"full-image\" />\n  </Dialog>\n\n  <!-- Task Works Dialog -->\n  <Dialog v-model:visible=\"taskWorksDialog\" modal :header=\"`‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£: ${selectedTask?.task_name || ''}`\" \n          :style=\"{ width: '90vw', maxWidth: '1200px' }\" :draggable=\"false\" position=\"center\">\n    <div v-if=\"loadingWorks\" class=\"loading-state\">\n      <i class=\"pi pi-spin pi-spinner\" style=\"font-size: 2rem;\"></i>\n      <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>\n    </div>\n    \n    <div v-else-if=\"taskWorks.length === 0\" class=\"empty-works\">\n      <i class=\"pi pi-inbox\" style=\"font-size: 3rem; color: #ccc;\"></i>\n      <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</p>\n    </div>\n    \n    <div v-else class=\"works-container\">\n      <div class=\"works-summary\">\n        <div class=\"summary-item\">\n          <i class=\"pi pi-calendar\"></i>\n          <span>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <strong>{{ taskWorks.length }}</strong> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>\n        </div>\n        <div class=\"summary-item\">\n          <i class=\"pi pi-clock\"></i>\n          <span>‡∏£‡∏ß‡∏°: <strong>{{ getTotalHours() }}</strong></span>\n        </div>\n      </div>\n      \n      <div class=\"works-filters\">\n        <div class=\"filter-group\">\n          <label>‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label>\n          <Dropdown v-model=\"workStatusFilter\" :options=\"workStatusFilterOptions\" \n                    optionLabel=\"label\" optionValue=\"value\" placeholder=\"‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\" \n                    class=\"filter-dropdown\" />\n        </div>\n        <div class=\"filter-group\">\n          <label>‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°:</label>\n          <Dropdown v-model=\"workSortBy\" :options=\"workSortOptions\" \n                    optionLabel=\"label\" optionValue=\"value\" \n                    class=\"filter-dropdown\" />\n        </div>\n      </div>\n      \n      <div class=\"works-table-wrapper\">\n        <table class=\"works-table\">\n          <thead>\n            <tr>\n              <th>ID</th>\n              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>\n              <th>‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</th>\n              <th>‡πÄ‡∏ß‡∏•‡∏≤</th>\n              <th>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</th>\n              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>\n              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>\n              <th>‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"work in filteredAndSortedWorks\" :key=\"work.id\">\n              <td class=\"text-center\">\n                <Badge :value=\"work.id\" severity=\"info\" />\n              </td>\n              <td>{{ formatDate(work.work_date) }}</td>\n              <td>\n                <span class=\"clickable-name\" @click=\"showUserInfo(work.employee_name, work.user_id)\">\n                  {{ work.employee_name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}\n                </span>\n              </td>\n              <td>{{ work.start_time }} - {{ work.end_time }}</td>\n              <td class=\"text-center\">{{ formatHoursMinutes(work.total_hours) }}</td>\n              <td class=\"text-center\">\n                <Badge :value=\"getStatusLabel(work.work_status)\" \n                       :style=\"{ backgroundColor: getStatusColor(work.work_status), color: '#fff', fontWeight: 'bold' }\" />\n              </td>\n              <td>{{ work.location || '-' }}</td>\n              <td class=\"text-center\">\n                <Button v-if=\"work.files && work.files.length > 0\"\n                        icon=\"pi pi-paperclip\" \n                        :label=\"work.files.length.toString()\"\n                        size=\"small\" \n                        severity=\"success\" \n                        outlined\n                        @click=\"showWorkFiles(work)\"\n                        v-tooltip=\"`${work.files.length} ‡πÑ‡∏ü‡∏•‡πå`\" />\n                <span v-else>-</span>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n    \n    <template #footer>\n      <Button label=\"‡∏õ‡∏¥‡∏î\" icon=\"pi pi-times\" @click=\"taskWorksDialog = false\" />\n    </template>\n  </Dialog>\n\n  <!-- Work Files Dialog -->\n  <Dialog v-model:visible=\"workFilesDialog\" modal header=\"‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö\" \n          :style=\"{ width: '500px' }\" :draggable=\"false\">\n    <div v-if=\"selectedWorkFiles && selectedWorkFiles.length > 0\" class=\"files-list\">\n      <div v-for=\"(file, index) in selectedWorkFiles\" :key=\"index\" class=\"file-item\">\n        <div class=\"file-info\">\n          <img v-if=\"isImageFile(file)\" :src=\"getFileUrl(file)\" class=\"file-preview\" @click=\"viewFullImage(file)\" />\n          <i v-else class=\"pi pi-file file-icon\"></i>\n          <span class=\"file-name\">{{ file }}</span>\n        </div>\n        <Button icon=\"pi pi-download\" size=\"small\" severity=\"success\" outlined\n                @click=\"downloadWorkFile(file)\" v-tooltip=\"'‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î'\" />\n      </div>\n    </div>\n  </Dialog>\n\n  <!-- Edit Task Dialog -->\n  <Dialog v-model:visible=\"editDialog\" modal header=\"‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô\" :style=\"{ width: '90vw', maxWidth: '800px' }\" :draggable=\"false\" position=\"center\">\n    <form @submit.prevent=\"updateTask\" class=\"edit-form\">\n      <div class=\"form-grid\">\n        <div class=\"input-group\">\n          <label class=\"input-label\">‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô *</label>\n          <InputText v-model=\"editFormData.task_name\" required class=\"corporate-input\" />\n        </div>\n        \n        <div class=\"input-group\">\n          <label class=\"input-label\">SO Number</label>\n          <InputText v-model=\"editFormData.so_number\" class=\"corporate-input\" />\n        </div>\n        \n        <div class=\"input-group\">\n          <label class=\"input-label\">Contract Number</label>\n          <InputText v-model=\"editFormData.contract_number\" class=\"corporate-input\" />\n        </div>\n        \n        <div class=\"input-group\">\n          <label class=\"input-label\">Sale Owner</label>\n          <InputText v-model=\"editFormData.sale_owner\" class=\"corporate-input\" />\n        </div>\n\n        <div class=\"input-group\">\n          <label class=\"input-label\">‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>\n          <Calendar v-model=\"editFormData.project_start_date\" dateFormat=\"dd/mm/yy\" class=\"corporate-input\" />\n        </div>\n\n        <div class=\"input-group\">\n          <label class=\"input-label\">‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>\n          <Calendar v-model=\"editFormData.project_end_date\" dateFormat=\"dd/mm/yy\" \n                    :minDate=\"editFormData.project_start_date\" class=\"corporate-input\" />\n        </div>\n\n        <div class=\"input-group\">\n          <label class=\"input-label\">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏á‡∏≤‡∏ô *</label>\n          <Dropdown v-model=\"editFormData.category\" :options=\"categories\" \n                    optionLabel=\"label\" optionValue=\"value\" placeholder=\"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏á‡∏≤‡∏ô\" \n                    class=\"corporate-input\" required>\n            <template #value=\"slotProps\">\n              <span v-if=\"slotProps.value\">{{ getCategoryLabel(slotProps.value) }}</span>\n            </template>\n            <template #option=\"slotProps\">\n              <span>{{ slotProps.option.label }}</span>\n            </template>\n          </Dropdown>\n        </div>\n\n        <div class=\"input-group\">\n          <label class=\"input-label\">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô</label>\n          <Dropdown v-model=\"editFormData.status\" :options=\"workStatuses\" \n                    optionLabel=\"label\" optionValue=\"value\" placeholder=\"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô\" \n                    class=\"corporate-input\">\n            <template #value=\"slotProps\">\n              <span v-if=\"slotProps.value\">{{ getStatusLabel(slotProps.value) }}</span>\n            </template>\n            <template #option=\"slotProps\">\n              <span>{{ slotProps.option.label }}</span>\n            </template>\n          </Dropdown>\n        </div>\n        \n        <div class=\"input-group full-width\">\n          <label class=\"input-label\">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>\n          <Textarea v-model=\"editFormData.description\" rows=\"4\" class=\"corporate-input\" />\n        </div>\n\n        <div class=\"input-group full-width\">\n          <label class=\"input-label\">‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</label>\n          <div class=\"file-upload-section\">\n            <input type=\"file\" ref=\"editFileInput\" @change=\"handleEditFileUpload\" \n              accept=\"image/*,.pdf,.doc,.docx,.xls,.xlsx\" multiple class=\"file-input\" style=\"display: none;\">\n            <Button type=\"button\" \n              label=\"‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå\" \n              icon=\"pi pi-upload\" \n              severity=\"secondary\" \n              outlined \n              @click=\"$refs.editFileInput.click()\" />\n          </div>\n          \n          <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏° -->\n          <div v-if=\"editFormData.existingFiles?.length > 0\" class=\"existing-files\">\n            <h4>‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°:</h4>\n            <div v-for=\"(file, index) in editFormData.existingFiles\" :key=\"index\" class=\"file-item\">\n              <i class=\"pi pi-file\"></i>\n              <span class=\"file-name\">{{ file }}</span>\n              <Button icon=\"pi pi-times\" size=\"small\" severity=\"danger\" text @click=\"removeExistingFile(index)\" />\n            </div>\n          </div>\n          \n          <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà -->\n          <div v-if=\"editFormData.newFiles?.length > 0\" class=\"new-files\">\n            <h4>‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà:</h4>\n            <div v-for=\"(file, index) in editFormData.newFiles\" :key=\"index\" class=\"file-item\">\n              <i class=\"pi pi-file\"></i>\n              <span class=\"file-name\">{{ file.name }}</span>\n              <Button icon=\"pi pi-times\" size=\"small\" severity=\"danger\" text @click=\"removeNewFile(index)\" />\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"form-actions\">\n        <Button type=\"button\" label=\"‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å\" severity=\"secondary\" outlined @click=\"editDialog = false\" />\n        <Button type=\"submit\" label=\"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å\" severity=\"success\" />\n      </div>\n    </form>\n  </Dialog>\n\n  <!-- User Info Dialog -->\n  <UserInfoDialog \n    v-model:visible=\"showUserInfoDialog\" \n    :userId=\"selectedUserId\"\n    :userName=\"selectedUserName\"\n  />\n</template>\n\n<script>\nimport axios from '@/utils/axiosConfig'\nimport EnhancedDataTable from '@/components/EnhancedDataTable.vue'\nimport UserInfoDialog from '@/components/UserInfoDialog.vue'\n\nexport default {\n  name: 'TaskList',\n  components: {\n    EnhancedDataTable,\n    UserInfoDialog\n  },\n  created() {\n    this.$http = axios\n  },\n  async mounted() {\n    // Listen for task updates\n    window.addEventListener('taskUpdated', this.handleTaskUpdate)\n    window.addEventListener('workRecordUpdated', this.handleTaskUpdate)\n    window.addEventListener('taskStatusChanged', this.handleTaskUpdate)\n    window.addEventListener('categoriesUpdated', this.handleCategoriesUpdate)\n    window.addEventListener('statusesUpdated', this.handleStatusesUpdate)\n    \n    // Load categories and statuses first, then tasks\n    await this.loadCategoriesFromStorage()\n    await this.loadStatusesFromStorage()\n    this.loadTasks()\n  },\n  beforeUnmount() {\n    window.removeEventListener('taskUpdated', this.handleTaskUpdate)\n    window.removeEventListener('workRecordUpdated', this.handleTaskUpdate)\n    window.removeEventListener('taskStatusChanged', this.handleTaskUpdate)\n    window.removeEventListener('categoriesUpdated', this.handleCategoriesUpdate)\n    window.removeEventListener('statusesUpdated', this.handleStatusesUpdate)\n  },\n  data() {\n    return {\n      tasks: [],\n      detailDialog: false,\n      selectedTask: null,\n      filesDialog: false,\n      selectedTaskFiles: [],\n      fullImageDialog: false,\n      fullImageUrl: '',\n      editDialog: false,\n      taskWorksDialog: false,\n      taskWorks: [],\n      loadingWorks: false,\n      workFilesDialog: false,\n      selectedWorkFiles: [],\n      showUserInfoDialog: false,\n      selectedUserId: null,\n      selectedUserName: '',\n      workStatusFilter: null,\n      workSortBy: 'date_desc',\n      workSortOptions: [\n        { label: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î', value: 'date_desc' },\n        { label: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î', value: 'date_asc' },\n        { label: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', value: 'status' }\n      ],\n      editFormData: {\n        id: null,\n        task_name: '',\n        so_number: '',\n        contract_number: '',\n        sale_owner: '',\n        description: '',\n        category: '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',\n        project_start_date: null,\n        project_end_date: null,\n        existingFiles: [],\n        newFiles: []\n      },\n      categoryOptions: [\n        { label: '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', value: '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ' },\n        { label: '‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö', value: '‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö' },\n        { label: '‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤', value: '‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤' },\n        { label: '‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°', value: '‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°' },\n        { label: '‡∏á‡∏≤‡∏ô‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°', value: '‡∏á‡∏≤‡∏ô‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°' },\n        { label: '‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢', value: '‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢' },\n        { label: '‡∏á‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£', value: '‡∏á‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£' },\n        { label: '‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤', value: '‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤' }\n      ],\n      categories: [],\n      workStatuses: []\n    }\n  },\n  computed: {\n    workStatusFilterOptions() {\n      const options = [{ label: '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', value: null }]\n      this.workStatuses.forEach(s => {\n        options.push({\n          label: s.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim(),\n          value: s.value\n        })\n      })\n      return options\n    },\n    enrichedTasks() {\n      // Add status and category labels to tasks for better search\n      return this.tasks.map(task => ({\n        ...task,\n        statusLabel: this.getStatusLabel(task.status),\n        categoryLabel: this.getCategoryLabel(task.category)\n      }))\n    },\n    filteredAndSortedWorks() {\n      let works = [...this.taskWorks]\n      \n      // Filter by status\n      if (this.workStatusFilter) {\n        works = works.filter(work => work.work_status === this.workStatusFilter)\n      }\n      \n      // Sort\n      if (this.workSortBy === 'date_desc') {\n        works.sort((a, b) => new Date(b.work_date) - new Date(a.work_date))\n      } else if (this.workSortBy === 'date_asc') {\n        works.sort((a, b) => new Date(a.work_date) - new Date(b.work_date))\n      } else if (this.workSortBy === 'status') {\n        const statusOrder = { 'completed': 1, 'in_progress': 2, 'pending': 3, 'on_hold': 4 }\n        works.sort((a, b) => (statusOrder[a.work_status] || 5) - (statusOrder[b.work_status] || 5))\n      }\n      \n      return works\n    }\n  },\n  methods: {\n    confirmDeleteTask(task) {\n      this.$confirm.require({\n        message: `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏á‡∏≤‡∏ô \"${task.task_name}\" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`,\n        header: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',\n        icon: 'pi pi-exclamation-triangle',\n        acceptLabel: '‡∏•‡∏ö',\n        rejectLabel: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',\n        acceptClass: 'p-button-danger',\n        accept: () => {\n          this.deleteTask(task.id)\n        }\n      })\n    },\n    async deleteTask(taskId) {\n      try {\n        await this.$http.delete(`/api/tasks/${taskId}`)\n        \n        this.$toast.add({\n          severity: 'success',\n          summary: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',\n          detail: '‡∏•‡∏ö‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',\n          life: 3000\n        })\n        \n        this.loadTasks()\n        window.dispatchEvent(new CustomEvent('taskUpdated'))\n      } catch (error) {\n        \n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: error.response?.data?.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\n          life: 5000\n        })\n      }\n    },\n    async loadCategoriesFromStorage() {\n      try {\n        const response = await this.$http.get('/api/settings/categories')\n        this.categories = response.data\n      } catch (error) {\n        \n        // Fallback to default\n        this.categories = [\n          { label: 'üíº ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', value: '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', icon: 'emoji:üíº', color: '#6366f1' },\n          { label: 'üíª ‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤', value: '‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤', icon: 'emoji:üíª', color: '#14b8a6' },\n          { label: 'üîß ‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤', value: '‡∏á‡∏≤‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤', icon: 'emoji:üîß', color: '#f97316' }\n        ]\n      }\n    },\n    async loadStatusesFromStorage() {\n      try {\n        const response = await this.$http.get('/api/settings/statuses')\n        \n        this.workStatuses = response.data\n      } catch (error) {\n        \n        // Fallback to default\n        this.workStatuses = [\n          { label: '‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', value: 'pending', icon: 'emoji:‚è≥', color: '#f59e0b' },\n          { label: 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', value: 'in_progress', icon: 'emoji:üîÑ', color: '#3b82f6' },\n          { label: '‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', value: 'completed', icon: 'emoji:‚úÖ', color: '#10b981' },\n          { label: '‚è∏Ô∏è ‡∏£‡∏∞‡∏á‡∏±‡∏ö', value: 'on_hold', icon: 'emoji:‚è∏Ô∏è', color: '#6c757d' }\n        ]\n      }\n    },\n    getCategoryIcon(categoryValue) {\n      const category = this.categories.find(cat => cat.value === categoryValue)\n      return category ? category.icon : 'pi pi-tag'\n    },\n    getCategoryLabel(categoryValue) {\n      const category = this.categories.find(cat => cat.value === categoryValue)\n      if (category && category.label) {\n        // Remove all emoji and special characters\n        return category.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim()\n      }\n      return categoryValue\n    },\n    getCategoryColor(categoryValue) {\n      if (!this.categories || this.categories.length === 0) {\n        return '#6c757d'\n      }\n      const category = this.categories.find(cat => cat.value === categoryValue)\n      return category && category.color ? category.color : '#6c757d'\n    },\n    getStatusIcon(statusValue) {\n      const status = this.workStatuses.find(s => s.value === statusValue)\n      return status ? status.icon : 'pi pi-circle'\n    },\n    getStatusLabel(statusValue) {\n      if (!statusValue) return '-'\n      // ‡∏•‡∏≠‡∏á match ‡∏î‡πâ‡∏ß‡∏¢ value ‡∏Å‡πà‡∏≠‡∏ô\n      let status = this.workStatuses.find(s => s.value === statusValue)\n      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ ‡∏•‡∏≠‡∏á match ‡∏î‡πâ‡∏ß‡∏¢ label\n      if (!status) {\n        status = this.workStatuses.find(s => s.label && s.label.includes(statusValue))\n      }\n      if (status && status.label) {\n        // Remove all emoji and special characters\n        return status.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim()\n      }\n      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏ô workStatuses ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á\n      return statusValue\n    },\n    getStatusColor(statusValue) {\n      if (!statusValue) return '#9e9e9e'\n      // ‡∏•‡∏≠‡∏á match ‡∏î‡πâ‡∏ß‡∏¢ value ‡∏Å‡πà‡∏≠‡∏ô\n      let status = this.workStatuses.find(s => s.value === statusValue)\n      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ ‡∏•‡∏≠‡∏á match ‡∏î‡πâ‡∏ß‡∏¢ label\n      if (!status) {\n        status = this.workStatuses.find(s => s.label && s.label.includes(statusValue))\n      }\n      return status?.color || '#9e9e9e'\n    },\n    async loadTasks() {\n      try {\n        const response = await this.$http.get('/api/tasks')\n        // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á format array ‡∏ï‡∏£‡∏á‡πÜ ‡πÅ‡∏•‡∏∞ format ‡∏ó‡∏µ‡πà‡∏°‡∏µ wrapper\n        this.tasks = response.data.data || response.data || []\n      } catch (error) {\n        this.tasks = []\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\n          life: 5000\n        })\n      }\n    },\n    formatDate(date) {\n      if (!date) return '-'\n      try {\n        // For date-only strings (YYYY-MM-DD), parse manually to avoid timezone issues\n        if (typeof date === 'string' && date.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n          const [year, month, day] = date.split('-')\n          const d = new Date(parseInt(year), parseInt(month) - 1, parseInt(day))\n          return d.toLocaleDateString('th-TH', {\n            year: 'numeric',\n            month: 'long',\n            day: 'numeric'\n          })\n        }\n        return new Date(date).toLocaleDateString('th-TH', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric'\n        })\n      } catch (error) {\n        return date\n      }\n    },\n    showTaskDetails(task) {\n      this.selectedTask = task\n      this.detailDialog = true\n    },\n    isImageFile(fileName) {\n      const extension = fileName.split('.').pop()?.toLowerCase()\n      return ['jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp'].includes(extension)\n    },\n    getFileUrl(fileName) {\n      const token = localStorage.getItem('soc_token')\n      return `/api/files/download/${fileName}?token=${token}`\n    },\n    viewFullImage(fileName) {\n      this.fullImageUrl = this.getFileUrl(fileName)\n      this.fullImageDialog = true\n    },\n    hasFiles(task) {\n      return task.files && Array.isArray(task.files) && task.files.length > 0\n    },\n    downloadTaskFiles(task) {\n      if (this.hasFiles(task)) {\n        this.selectedTaskFiles = task.files\n        this.filesDialog = true\n      }\n    },\n    async downloadFile(fileName) {\n      try {\n        const response = await this.$http.get(`/api/files/download/${fileName}`, {\n          responseType: 'blob'\n        })\n        const url = window.URL.createObjectURL(new Blob([response.data]))\n        const link = document.createElement('a')\n        link.href = url\n        link.download = fileName.split('-').slice(2).join('-') || fileName\n        document.body.appendChild(link)\n        link.click()\n        document.body.removeChild(link)\n        window.URL.revokeObjectURL(url)\n      } catch (error) {\n        \n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ',\n          life: 3000\n        })\n      }\n    },\n    editTask(task) {\n      // Parse dates from string to Date object\n      const parseDate = (dateStr) => {\n        if (!dateStr) return null\n        if (typeof dateStr === 'string' && dateStr.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n          const [year, month, day] = dateStr.split('-')\n          // Create date at noon to avoid timezone issues\n          return new Date(parseInt(year), parseInt(month) - 1, parseInt(day), 12, 0, 0)\n        }\n        return new Date(dateStr)\n      }\n      \n      this.editFormData = {\n        id: task.id,\n        task_name: task.task_name,\n        so_number: task.so_number || '',\n        contract_number: task.contract_number || '',\n        sale_owner: task.sale_owner || '',\n        description: task.description || '',\n        category: task.category || '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',\n        status: task.status || 'pending',\n        project_start_date: parseDate(task.project_start_date),\n        project_end_date: parseDate(task.project_end_date),\n        existingFiles: [...(task.files || [])],\n        newFiles: []\n      }\n      this.editDialog = true\n    },\n    handleEditFileUpload(event) {\n      const files = Array.from(event.target.files)\n      this.editFormData.newFiles = [...this.editFormData.newFiles, ...files]\n    },\n    removeExistingFile(index) {\n      this.editFormData.existingFiles.splice(index, 1)\n    },\n    removeNewFile(index) {\n      this.editFormData.newFiles.splice(index, 1)\n    },\n    async uploadNewFiles() {\n      if (this.editFormData.newFiles.length === 0) return []\n      \n      const formData = new FormData()\n      this.editFormData.newFiles.forEach(file => {\n        formData.append('files', file)\n      })\n      \n      try {\n        const response = await this.$http.post('/api/files/upload', formData, {\n          headers: { 'Content-Type': 'multipart/form-data' }\n        })\n        return response.data.files || []\n      } catch (error) {\n        return []\n      }\n    },\n    async updateTask() {\n      try {\n        // Upload ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà\n        const newUploadedFiles = await this.uploadNewFiles()\n        \n        // ‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà\n        const allFiles = [...this.editFormData.existingFiles, ...newUploadedFiles]\n        \n        // Format dates to YYYY-MM-DD\n        const formatDate = (date) => {\n          if (!date) return null\n          const d = new Date(date)\n          const year = d.getFullYear()\n          const month = String(d.getMonth() + 1).padStart(2, '0')\n          const day = String(d.getDate()).padStart(2, '0')\n          return `${year}-${month}-${day}`\n        }\n        \n        const updateData = {\n          ...this.editFormData,\n          project_start_date: formatDate(this.editFormData.project_start_date),\n          project_end_date: formatDate(this.editFormData.project_end_date),\n          files: allFiles\n        }\n        delete updateData.existingFiles\n        delete updateData.newFiles\n        \n        await this.$http.put(`/api/tasks/${this.editFormData.id}`, updateData)\n        \n        this.$toast.add({\n          severity: 'success',\n          summary: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',\n          detail: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',\n          life: 3000\n        })\n        \n        this.editDialog = false\n        \n        // Auto-refresh data\n        await this.loadTasks()\n        \n        // Dispatch global event for real-time update\n        window.dispatchEvent(new CustomEvent('taskUpdated'))\n        \n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: error.response?.data?.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\n          life: 5000\n        })\n      }\n    },\n    handleTaskUpdate() {\n      // Auto-refresh tasks when updated\n      this.loadTasks()\n    },\n    handleCategoriesUpdate() {\n      this.loadCategoriesFromStorage()\n    },\n    handleStatusesUpdate() {\n      this.loadStatusesFromStorage()\n    },\n    async refreshData() {\n      // Method for external refresh calls\n      await this.loadTasks()\n    },\n    async viewTaskWorks(task) {\n      this.selectedTask = task\n      this.taskWorks = []\n      this.loadingWorks = true\n      this.taskWorksDialog = true\n      this.workStatusFilter = null\n      this.workSortBy = 'date_desc'\n      \n      try {\n        const response = await this.$http.get(`/api/daily-work?task_id=${task.id}`)\n        this.taskWorks = response.data || []\n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡πÑ‡∏î‡πâ',\n          life: 3000\n        })\n        this.taskWorks = []\n      } finally {\n        this.loadingWorks = false\n      }\n    },\n    formatDateTime(date) {\n      try {\n        return new Date(date).toLocaleString('th-TH', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit'\n        })\n      } catch (error) {\n        return date\n      }\n    },\n    getTotalHours() {\n      if (!this.taskWorks || this.taskWorks.length === 0) return '0 ‡∏ä‡∏°. 0 ‡∏ô‡∏≤‡∏ó‡∏µ'\n      const total = this.taskWorks.reduce((sum, work) => sum + (parseFloat(work.total_hours) || 0), 0)\n      const hours = Math.floor(total)\n      const minutes = Math.round((total - hours) * 60)\n      return `${hours} ‡∏ä‡∏°. ${minutes} ‡∏ô‡∏≤‡∏ó‡∏µ`\n    },\n    showWorkFiles(work) {\n      this.selectedWorkFiles = work.files || []\n      this.workFilesDialog = true\n    },\n    downloadWorkFile(fileName) {\n      const link = document.createElement('a')\n      link.href = `/api/files/download/${fileName}`\n      link.download = fileName\n      link.target = '_blank'\n      document.body.appendChild(link)\n      link.click()\n      document.body.removeChild(link)\n    },\n    formatHoursMinutes(hours) {\n      const h = parseFloat(hours) || 0\n      const hrs = Math.floor(h)\n      const mins = Math.round((h - hrs) * 60)\n      return `${hrs} ‡∏ä‡∏°. ${mins} ‡∏ô‡∏≤‡∏ó‡∏µ`\n    },\n    showUserInfo(name, userId) {\n      this.selectedUserName = name\n      this.selectedUserId = userId\n      this.showUserInfoDialog = true\n    }\n  }\n}\n</script>\n\n<style scoped>\n.history-card {\n  width: 100%;\n  margin: 0;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n  border: 1px solid #e9ecef;\n}\n\n.empty-state {\n  text-align: center;\n  padding: 4rem 2rem;\n  color: #6c757d;\n  background: #f8f9fa;\n  border-radius: 8px;\n  margin: 1rem;\n}\n\n.empty-state p {\n  margin-top: 1rem;\n  font-size: 1.1rem;\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n}\n\n.history-table :deep(.p-datatable) {\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n}\n\n.history-table :deep(.p-datatable-thead > tr > th) {\n  background: #f8f9fa;\n  color: #495057;\n  font-weight: 600;\n  border-bottom: 2px solid #e9ecef;\n  padding: 1rem 0.75rem;\n  font-size: 0.9rem;\n}\n\n.history-table :deep(.p-datatable-tbody > tr > td) {\n  padding: 1rem 0.75rem;\n  border-bottom: 1px solid #f1f3f4;\n  vertical-align: middle;\n}\n\n.history-table :deep(.p-datatable-tbody > tr:hover) {\n  background: #f8f9fa;\n}\n\n.history-table :deep(.p-paginator) {\n  background: #f8f9fa;\n  border-top: 2px solid #e9ecef;\n  padding: 1rem;\n}\n\n.custom-id-badge {\n  background: linear-gradient(135deg, #28a745 0%, #20c997 100%);\n  color: white;\n  font-weight: 600;\n  padding: 0.5rem 0.75rem;\n  border-radius: 20px;\n  font-size: 0.8rem;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 40px;\n}\n\n.task-name {\n  font-weight: 600;\n  color: #495057;\n}\n\n.so-number {\n  font-size: 0.9rem;\n  color: #6c757d;\n  background: #e3f2fd;\n  padding: 0.2rem 0.5rem;\n  border-radius: 12px;\n  display: inline-block;\n  width: fit-content;\n}\n\n.sale-info {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  color: #495057;\n}\n\n.sale-info i {\n  color: #667eea;\n}\n\n.text-muted {\n  color: #6c757d;\n}\n\n.dialog-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.dialog-content {\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);\n  max-width: 600px;\n  width: 90%;\n  max-height: 80vh;\n  overflow: hidden;\n  animation: dialogSlideIn 0.3s ease-out;\n}\n\n@keyframes dialogSlideIn {\n  from {\n    opacity: 0;\n    transform: scale(0.8) translateY(-20px);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n  }\n}\n\n.dialog-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1.5rem;\n  border-bottom: 1px solid #e9ecef;\n  background: #f8f9fa;\n}\n\n.dialog-header h3 {\n  margin: 0;\n  color: #495057;\n  font-size: 1.25rem;\n}\n\n.dialog-close {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: #6c757d;\n  padding: 0;\n  width: 30px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  transition: all 0.2s;\n}\n\n.dialog-close:hover {\n  background: #e9ecef;\n  color: #495057;\n}\n\n.dialog-body {\n  padding: 1.5rem;\n}\n\n.work-description {\n  background: #f8f9fa;\n  padding: 1rem;\n  border-radius: 6px;\n  border-left: 4px solid #28a745;\n  white-space: pre-wrap;\n  line-height: 1.6;\n  color: #495057;\n  font-size: 0.95rem;\n}\n\n/* Mobile Responsive */\n.files-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.file-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem;\n  border: 1px solid #e0e0e0;\n  border-radius: 6px;\n  background-color: #f9f9f9;\n}\n\n.file-info {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.file-preview {\n  width: 60px;\n  height: 60px;\n  object-fit: contain;\n  border-radius: 4px;\n  border: 1px solid #ddd;\n  cursor: pointer;\n}\n\n.file-preview:hover {\n  opacity: 0.8;\n}\n\n.file-icon {\n  font-size: 1.5rem;\n  color: #666;\n}\n\n.file-name {\n  font-weight: 500;\n}\n\n.full-image {\n  width: 100%;\n  max-height: 80vh;\n  object-fit: contain;\n}\n\n.no-files {\n  text-align: center;\n  padding: 2rem;\n  color: #666;\n}\n\n@media (max-width: 768px) {\n  :deep(.hide-mobile) {\n    display: none !important;\n  }\n  \n  .history-table :deep(.p-datatable-tbody > tr > td) {\n    padding: 0.75rem 0.5rem;\n    font-size: 0.9rem;\n  }\n  \n  .history-table :deep(.p-datatable-thead > tr > th) {\n    padding: 0.75rem 0.5rem;\n    font-size: 0.85rem;\n  }\n  \n  .task-name {\n    font-size: 0.9rem;\n    line-height: 1.2;\n  }\n}\n\n.edit-form {\n  padding: 1rem 0;\n}\n\n.form-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n}\n\n.input-group {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.input-group.full-width {\n  grid-column: 1 / -1;\n}\n\n.input-label {\n  font-weight: 500;\n  color: #333;\n}\n\n.corporate-input, .corporate-dropdown {\n  width: 100%;\n}\n\n.file-upload-section {\n  margin-bottom: 1rem;\n}\n\n.existing-files, .new-files {\n  margin-top: 1rem;\n}\n\n.existing-files h4, .new-files h4 {\n  margin: 0 0 0.5rem 0;\n  font-size: 0.9rem;\n  color: #666;\n}\n\n.file-item {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem;\n  border: 1px solid #e0e0e0;\n  border-radius: 4px;\n  margin-bottom: 0.5rem;\n  background-color: #f9f9f9;\n}\n\n.file-name {\n  flex: 1;\n  font-size: 0.9rem;\n}\n\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 1rem;\n  padding-top: 1rem;\n  border-top: 1px solid #e0e0e0;\n}\n\n.action-buttons {\n  display: flex;\n  gap: 0.5rem;\n  justify-content: center;\n}\n\n.loading-state,\n.empty-works {\n  text-align: center;\n  padding: 3rem 2rem;\n  color: #6c757d;\n}\n\n.loading-state p,\n.empty-works p {\n  margin-top: 1rem;\n  font-size: 1rem;\n}\n\n.works-container {\n  max-height: 70vh;\n  overflow-y: auto;\n}\n\n.works-summary {\n  display: flex;\n  gap: 2rem;\n  padding: 1rem;\n  background: #f8f9fa;\n  border-radius: 8px;\n  margin-bottom: 1rem;\n}\n\n.works-filters {\n  display: flex;\n  gap: 1rem;\n  padding: 1rem;\n  background: white;\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  margin-bottom: 1rem;\n  flex-wrap: wrap;\n}\n\n.filter-group {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.filter-group label {\n  font-size: 0.9rem;\n  font-weight: 500;\n  color: #495057;\n  white-space: nowrap;\n}\n\n.filter-dropdown {\n  min-width: 180px;\n}\n\n.summary-item {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  color: #495057;\n}\n\n.summary-item i {\n  color: #4A90E2;\n  font-size: 1.1rem;\n}\n\n.summary-item strong {\n  color: #4A90E2;\n  font-size: 1.1rem;\n}\n\n.works-table-wrapper {\n  overflow-x: auto;\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n}\n\n.works-table {\n  width: 100%;\n  border-collapse: collapse;\n  background: white;\n}\n\n.works-table thead {\n  background: #f8f9fa;\n}\n\n.works-table th {\n  padding: 1rem 0.75rem;\n  text-align: left;\n  font-weight: 600;\n  color: #495057;\n  border-bottom: 2px solid #e9ecef;\n  white-space: nowrap;\n}\n\n.works-table td {\n  padding: 0.75rem;\n  border-bottom: 1px solid #f1f3f4;\n  color: #495057;\n}\n\n.works-table tbody tr:hover {\n  background: #f8f9fa;\n}\n\n.works-table .text-center {\n  text-align: center;\n}\n\n.files-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.file-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem;\n  border: 1px solid #e9ecef;\n  border-radius: 6px;\n  background: #f8f9fa;\n}\n\n.file-info {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  flex: 1;\n}\n\n.file-info i {\n  color: #6c757d;\n  font-size: 1rem;\n}\n\n.file-name {\n  font-size: 0.9rem;\n  color: #495057;\n  word-break: break-all;\n}\n\n.description-preview {\n  font-size: 0.9rem;\n  color: #666;\n}\n\n.attachments-info {\n  display: flex;\n  justify-content: center;\n}\n\n.no-files,\n.no-status {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #999;\n  font-size: 0.9rem;\n  width: 100%;\n  text-align: center;\n}\n\n.category-badge {\n  white-space: nowrap;\n  overflow: visible;\n  text-overflow: unset;\n  max-width: none;\n  width: auto;\n  color: white !important;\n}\n\n@media (max-width: 480px) {\n  .history-table :deep(.p-datatable-tbody > tr > td) {\n    padding: 0.5rem 0.25rem;\n    font-size: 0.8rem;\n  }\n  \n  .history-table :deep(.p-datatable-thead > tr > th) {\n    padding: 0.5rem 0.25rem;\n    font-size: 0.8rem;\n  }\n  \n  .custom-id-badge {\n    font-size: 0.7rem;\n    padding: 0.3rem 0.5rem;\n  }\n}\n\n.badge-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  min-height: 40px;\n}\n\n.badge-container :deep(.p-badge) {\n  white-space: normal !important;\n  word-break: keep-all !important;\n  overflow-wrap: break-word !important;\n  text-align: center;\n  font-weight: 600;\n  font-size: 0.9rem;\n  padding: 0.25rem 0.4rem !important;\n  line-height: 1.5 !important;\n  display: inline-block !important;\n  max-width: 100%;\n  height: auto !important;\n}\n\n.category-display,\n.category-option,\n.status-display,\n.status-option {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.category-display .emoji,\n.category-option .emoji,\n.status-display .emoji,\n.status-option .emoji {\n  font-size: 16px;\n}\n\n.category-display i,\n.category-option i,\n.status-display i,\n.status-option i {\n  color: #4A90E2;\n  font-size: 14px;\n}\n\n/* Lock edit dialog position */\n.p-dialog .p-dialog-header {\n  cursor: default !important;\n}\n\n.p-dialog .p-dialog-header .p-dialog-title {\n  cursor: default !important;\n}\n\n.clickable-name {\n  color: #2563eb;\n  cursor: pointer;\n  text-decoration: underline;\n}\n\n.clickable-name:hover {\n  color: #1d4ed8;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}