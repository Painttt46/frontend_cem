{"ast":null,"code":"import Calendar from './Calendar.vue';\nimport History from './History.vue';\nimport BookingFormPrime from './BookingFormPrime.vue';\nimport axios from '@/utils/axiosConfig';\nexport default {\n  components: {\n    Calendar,\n    History,\n    BookingForm: BookingFormPrime\n  },\n  data() {\n    return {\n      activeTabIndex: 0,\n      selectedDate: null,\n      showForm: false,\n      activeForm: 'borrow',\n      borrowForm: {\n        license: 'ชฮ-3706',\n        time: '',\n        location: '',\n        project: '',\n        discription: '',\n        colleagues: [],\n        images: []\n      },\n      returnForm: {\n        borrowId: '',\n        license: 'ชฮ-3706',\n        location: '',\n        discription: '',\n        images: []\n      },\n      cancelForm: {\n        borrowId: '',\n        reason: ''\n      },\n      records: [],\n      currentTime: new Date(),\n      serverTimeOffset: 0,\n      currentBookingData: null,\n      showImageModal: false,\n      selectedImages: [],\n      showFullImageModal: false,\n      fullSizeImage: '',\n      teamsWebhookUrl: 'YOUR_TEAMS_WEBHOOK_URL_HERE',\n      notifiedActiveBookings: new Set(),\n      refreshInterval: null,\n      timeInterval: null,\n      syncInterval: null\n    };\n  },\n  computed: {\n    currentDateTime() {\n      return this.currentTime.toLocaleString('th-TH', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit'\n      });\n    },\n    hasActiveBorrow() {\n      return this.records.some(r => r.status === 'active');\n    },\n    availableBorrows() {\n      const currentUserName = this.getCurrentUserName();\n      return this.records.filter(r => {\n        // Must be active status (past borrow time, not returned)\n        if (r.status !== 'active') return false;\n\n        // Only borrower can return\n        return r.name === currentUserName;\n      });\n    },\n    pendingBorrows() {\n      const currentUserName = this.getCurrentUserName();\n      return this.records.filter(r => {\n        // Must be pending status (future booking, not started yet)\n        if (r.status !== 'pending') return false;\n\n        // Check if current user is authorized to cancel this booking\n        const isBorrower = r.name === currentUserName;\n        const isColleague = r.colleagues && Array.isArray(r.colleagues) && r.colleagues.some(colleague => {\n          const colleagueName = typeof colleague === 'string' ? colleague : colleague?.name;\n          return colleagueName === currentUserName;\n        });\n        return isBorrower || isColleague;\n      });\n    },\n    currentReturnTime() {\n      return this.currentTime.toLocaleTimeString('th-TH', {\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    },\n    selectedBorrowProject() {\n      if (!this.returnForm.borrowId) return '';\n      const selectedBorrow = this.records.find(r => r.id == this.returnForm.borrowId);\n      return selectedBorrow ? selectedBorrow.project : '';\n    },\n    selectedBorrowDescription() {\n      if (!this.returnForm.borrowId) return '';\n      const selectedBorrow = this.records.find(r => r.id == this.returnForm.borrowId);\n      return selectedBorrow ? selectedBorrow.discription : '';\n    },\n    borrowRecordsCount() {\n      return this.records.filter(r => r.status !== 'returned').length;\n    },\n    bookingsAllowingImageUpload() {\n      const currentUserName = this.getCurrentUserName();\n      return this.records.filter(r => {\n        // Must be active status and user is authorized\n        if (r.status !== 'active') return false;\n        const isBorrower = r.name === currentUserName;\n        const isColleague = r.colleagues && Array.isArray(r.colleagues) && r.colleagues.some(colleague => {\n          const colleagueName = typeof colleague === 'string' ? colleague : colleague?.name;\n          return colleagueName === currentUserName;\n        });\n        return isBorrower || isColleague;\n      });\n    },\n    groupedImages() {\n      const groups = {};\n      this.selectedImages.forEach(image => {\n        if (!groups[image.type]) {\n          groups[image.type] = [];\n        }\n        groups[image.type].push(image);\n      });\n      return Object.keys(groups).map(type => ({\n        type,\n        images: groups[type]\n      }));\n    }\n  },\n  mounted() {\n    this.syncServerTime();\n    this.timeInterval = setInterval(() => {\n      this.currentTime = new Date(Date.now() + this.serverTimeOffset);\n    }, 1000);\n\n    // Auto refresh ทุก 30 วินาที\n    this.refreshInterval = setInterval(() => {\n      this.loadRecords(true);\n    }, 30000);\n    this.syncInterval = setInterval(() => {\n      this.syncServerTime();\n    }, 300000);\n  },\n  beforeUnmount() {\n    // Clear intervals เมื่อออกจากหน้านี้\n    if (this.refreshInterval) clearInterval(this.refreshInterval);\n    if (this.timeInterval) clearInterval(this.timeInterval);\n    if (this.syncInterval) clearInterval(this.syncInterval);\n  },\n  created() {\n    this.$http = axios;\n    this.loadRecords();\n  },\n  methods: {\n    async syncServerTime() {\n      try {\n        const response = await axios.get('/api/server-time', {\n          silent: true\n        });\n        const serverTime = new Date(response.data.serverTime);\n        const clientTime = new Date();\n        this.serverTimeOffset = serverTime.getTime() - clientTime.getTime();\n        this.currentTime = new Date(Date.now() + this.serverTimeOffset);\n      } catch {// ignore\n      }\n    },\n    getCurrentUserName() {\n      const firstName = localStorage.getItem('soc_firstname') || '';\n      const lastName = localStorage.getItem('soc_lastname') || '';\n      return `${firstName} ${lastName}`.trim();\n    },\n    async loadRecords(silent = false) {\n      try {\n        const response = await axios.get('/api/car-booking', {\n          silent\n        });\n        this.records = response.data;\n      } catch {\n        // ignore\n        if (!silent) {\n          this.$toast.add({\n            severity: 'error',\n            summary: 'โหลดข้อมูลไม่สำเร็จ',\n            detail: 'กรุณารีเฟรชหน้าเว็บ',\n            life: 4000\n          });\n        }\n      }\n    },\n    triggerFileUpload() {\n      document.getElementById('modal-upload').click();\n    },\n    selectDate(date) {\n      this.selectedDate = date;\n      this.showForm = true;\n      this.activeForm = 'borrow';\n    },\n    showReturnForm() {\n      this.selectedDate = new Date(Date.now() + this.serverTimeOffset);\n      this.showForm = true;\n      this.activeForm = 'return';\n    },\n    showCancelForm() {\n      this.selectedDate = new Date(Date.now() + this.serverTimeOffset);\n      this.showForm = true;\n      this.activeForm = 'cancel';\n    },\n    closeForm() {\n      this.showForm = false;\n      this.selectedDate = null;\n      this.resetForms();\n    },\n    handleImageUpload(event, formType) {\n      const files = Array.from(event.target.files);\n      if (formType === 'borrow') {\n        this.borrowForm.images = [...(this.borrowForm.images || []), ...files];\n      } else {\n        this.returnForm.images = [...(this.returnForm.images || []), ...files];\n      }\n    },\n    removeImage(index, formType) {\n      if (formType === 'borrow') {\n        this.borrowForm.images.splice(index, 1);\n      } else {\n        this.returnForm.images.splice(index, 1);\n      }\n    },\n    async convertImagesToBase64(images) {\n      const promises = images.map(img => {\n        if (img instanceof File) {\n          return new Promise(resolve => {\n            const reader = new FileReader();\n            reader.onload = () => resolve(reader.result);\n            reader.readAsDataURL(img);\n          });\n        }\n        return Promise.resolve(img);\n      });\n      return Promise.all(promises);\n    },\n    openImageModal(imageSrc) {\n      this.selectedImages = [{\n        src: imageSrc,\n        type: 'รูปภาพ'\n      }];\n      this.showImageModal = true;\n    },\n    calculateUsageDuration(borrowDate, borrowTime, returnDate) {\n      const borrowDateTime = new Date(borrowDate);\n      const [hour, minute] = borrowTime.split(':').map(Number);\n      borrowDateTime.setHours(hour, minute, 0, 0);\n      const diffMs = returnDate - borrowDateTime;\n      const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n      const diffMinutes = Math.floor(diffMs % (1000 * 60 * 60) / (1000 * 60));\n      if (diffHours > 0) {\n        return `${diffHours} ชั่วโมง ${diffMinutes} นาที`;\n      } else {\n        return `${diffMinutes} นาที`;\n      }\n    },\n    viewImages(images, bookingData = null) {\n      this.selectedImages = images;\n      this.currentBookingData = bookingData;\n      this.showImageModal = true;\n    },\n    handleImageError() {\n      this.$toast.add({\n        severity: 'error',\n        summary: 'โหลดรูปไม่สำเร็จ',\n        detail: 'รูปภาพอาจถูกลบหรือไม่พร้อมใช้งาน',\n        life: 4000\n      });\n    },\n    handleImageLoad() {},\n    viewFullImage(imageSrc) {\n      // Handle nested proxy objects\n      let imageUrl = imageSrc;\n      if (typeof imageSrc === 'object' && imageSrc.src) {\n        imageUrl = typeof imageSrc.src === 'string' ? imageSrc.src : imageSrc.src.src;\n      }\n      this.fullSizeImage = imageUrl;\n      this.showFullImageModal = true;\n    },\n    formatDateForDB(date) {\n      const d = new Date(date);\n      // Convert to Bangkok timezone\n      const bangkokTime = new Date(d.toLocaleString('en-US', {\n        timeZone: 'Asia/Bangkok'\n      }));\n      const year = bangkokTime.getFullYear();\n      const month = String(bangkokTime.getMonth() + 1).padStart(2, '0');\n      const day = String(bangkokTime.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    },\n    async handleAdditionalImageUpload(event, bookingId) {\n      const files = Array.from(event.target.files);\n      if (files.length === 0) return;\n      try {\n        // Find the booking record\n        const booking = this.records.find(r => r.id === bookingId);\n        if (!booking) return;\n\n        // Convert files to base64\n        const newImages = [];\n        for (const file of files) {\n          const reader = new FileReader();\n          const base64 = await new Promise(resolve => {\n            reader.onload = () => resolve(reader.result);\n            reader.readAsDataURL(file);\n          });\n          newImages.push({\n            name: file.name,\n            src: base64,\n            type: 'เพิ่มเติม',\n            timestamp: new Date(Date.now() + this.serverTimeOffset).toLocaleString('th-TH')\n          });\n        }\n\n        // Update booking with new images\n        const currentImages = booking.images || [];\n        const updatedImages = [...currentImages, ...newImages];\n\n        // Update in database via API (need to add PUT endpoint)\n        await this.$http.put(`/api/car-booking/${bookingId}`, {\n          images: updatedImages\n        });\n        await this.loadRecords();\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: `อัปโหลดรูปภาพ ${files.length} ไฟล์เรียบร้อย`,\n          life: 3000\n        });\n\n        // Clear file input\n        event.target.value = '';\n      } catch {\n        // ignore\n        this.$toast.add({\n          severity: 'error',\n          summary: 'อัปโหลดไม่สำเร็จ',\n          detail: 'ไฟล์อาจใหญ่เกินไป หรือรูปแบบไม่รองรับ',\n          life: 4000\n        });\n      }\n    },\n    async submitBorrow() {\n      try {\n        const images = await this.convertImagesToBase64(this.borrowForm.images || []);\n        const borrowData = {\n          type: 'borrow',\n          location: this.borrowForm.location,\n          project: this.borrowForm.project,\n          description: this.borrowForm.discription,\n          selected_date: this.formatDateForDB(this.selectedDate),\n          time: this.borrowForm.time,\n          license: 'ชฮ-3706',\n          colleagues: this.borrowForm.colleagues || [],\n          images,\n          user_id: localStorage.getItem('soc_user_id')\n        };\n        await this.$http.post('/api/car-booking', borrowData);\n        await this.loadRecords();\n        this.closeForm();\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'บันทึกการจองรถเรียบร้อยแล้ว',\n          life: 3000\n        });\n      } catch (err) {\n        // Handle conflict error (409)\n        if (err.response?.status === 409) {\n          this.$toast.add({\n            severity: 'warn',\n            summary: 'ไม่สามารถจองได้',\n            detail: err.response.data.details || err.response.data.error,\n            life: 5000\n          });\n        } else {\n          this.$toast.add({\n            severity: 'error',\n            summary: 'บันทึกไม่สำเร็จ',\n            detail: 'กรุณาลองใหม่อีกครั้ง',\n            life: 4000\n          });\n        }\n      }\n    },\n    async submitReturn() {\n      const borrowId = this.returnForm.borrowId || this.$refs.bookingForm?.selectedReturnBorrow;\n      if (!borrowId) {\n        this.$toast.add({\n          severity: 'error',\n          summary: 'กรุณาเลือกข้อมูล',\n          detail: 'เลือกการแจ้งใช้รถที่ต้องการคืน',\n          life: 4000\n        });\n        return;\n      }\n      try {\n        const firstName = localStorage.getItem('soc_firstname') || '';\n        const lastName = localStorage.getItem('soc_lastname') || '';\n        const currentUserName = `${firstName} ${lastName}`.trim();\n        const bangkokTime = new Date(Date.now() + this.serverTimeOffset);\n        const currentTime = bangkokTime.toLocaleTimeString('th-TH', {\n          hour: '2-digit',\n          minute: '2-digit',\n          hour12: false\n        });\n        const images = await this.convertImagesToBase64(this.returnForm.images || []);\n        const returnData = {\n          return_name: currentUserName,\n          return_location: this.returnForm.location,\n          return_description: this.returnForm.discription,\n          return_time: currentTime,\n          return_date: this.formatDateForDB(bangkokTime),\n          images\n        };\n        await axios.put(`/api/car-booking/${borrowId}`, returnData);\n        await this.loadRecords();\n        this.closeForm();\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'บันทึกการคืนรถเรียบร้อยแล้ว',\n          life: 3000\n        });\n      } catch {\n        // ignore\n        this.$toast.add({\n          severity: 'error',\n          summary: 'บันทึกไม่สำเร็จ',\n          detail: 'กรุณาลองใหม่อีกครั้ง',\n          life: 4000\n        });\n      }\n    },\n    async submitCancel() {\n      if (!this.cancelForm.borrowId) {\n        this.$toast.add({\n          severity: 'error',\n          summary: 'กรุณาเลือกข้อมูล',\n          detail: 'เลือกการจองที่ต้องการยกเลิก',\n          life: 4000\n        });\n        return;\n      }\n      try {\n        await this.$http.delete(`/api/car-booking/${this.cancelForm.borrowId}`);\n        await this.loadRecords();\n        this.closeForm();\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'ยกเลิกการจองเรียบร้อยแล้ว',\n          life: 3000\n        });\n      } catch {\n        // ignore\n        this.$toast.add({\n          severity: 'error',\n          summary: 'ยกเลิกไม่สำเร็จ',\n          detail: 'กรุณาลองใหม่อีกครั้ง',\n          life: 4000\n        });\n      }\n    },\n    updateBorrowForm({\n      field,\n      value\n    }) {\n      this.borrowForm[field] = value;\n    },\n    updateReturnForm(field, value) {\n      this.returnForm[field] = value;\n    },\n    updateCancelForm({\n      field,\n      value\n    }) {\n      this.cancelForm[field] = value;\n    },\n    async handleAdditionalImageUploadFromHistory({\n      files,\n      bookingId\n    }) {\n      if (files.length === 0) return;\n      try {\n        // Find the booking record\n        const booking = this.records.find(r => r.id === bookingId);\n        if (!booking) return;\n\n        // Convert files to base64\n        const newImages = [];\n        for (const file of files) {\n          const reader = new FileReader();\n          const base64 = await new Promise(resolve => {\n            reader.onload = () => resolve(reader.result);\n            reader.readAsDataURL(file);\n          });\n          newImages.push({\n            name: file.name,\n            src: base64,\n            type: 'เพิ่มเติม',\n            timestamp: new Date(Date.now() + this.serverTimeOffset).toLocaleString('th-TH')\n          });\n        }\n\n        // Update booking with new images\n        const currentImages = booking.images || [];\n        const updatedImages = [...currentImages, ...newImages];\n\n        // Update in database via API\n        await this.$http.put(`/api/car-booking/${bookingId}`, {\n          images: updatedImages\n        });\n        await this.loadRecords();\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: `อัปโหลดรูปภาพ ${files.length} ไฟล์เรียบร้อย`,\n          life: 3000\n        });\n      } catch {\n        // ignore\n        this.$toast.add({\n          severity: 'error',\n          summary: 'อัปโหลดไม่สำเร็จ',\n          detail: 'ไฟล์อาจใหญ่เกินไป หรือรูปแบบไม่รองรับ',\n          life: 4000\n        });\n      }\n    },\n    resetForms() {\n      this.borrowForm = {\n        license: 'ชฮ-3706',\n        time: '',\n        location: '',\n        project: '',\n        discription: '',\n        colleagues: [],\n        images: []\n      };\n      this.returnForm = {\n        borrowId: '',\n        license: 'ชฮ-3706',\n        location: '',\n        discription: '',\n        images: []\n      };\n      this.cancelForm = {\n        borrowId: '',\n        reason: ''\n      };\n    },\n    canUploadForBooking(bookingData) {\n      if (!bookingData) return false;\n\n      // Find the actual record from this.records\n      const record = this.records.find(r => r.id === bookingData.id);\n      if (!record) return false;\n\n      // Can upload if status is active\n      return record.status === 'active';\n    },\n    async handleModalImageUpload(event) {\n      if (!this.currentBookingData) return;\n      const files = Array.from(event.target.files);\n      if (files.length === 0) return;\n      await this.handleAdditionalImageUploadFromHistory({\n        files,\n        bookingId: this.currentBookingData.id\n      });\n\n      // Clear file input and close modal\n      event.target.value = '';\n      this.showImageModal = false;\n    }\n  }\n};","map":{"version":3,"names":["Calendar","History","BookingFormPrime","axios","components","BookingForm","data","activeTabIndex","selectedDate","showForm","activeForm","borrowForm","license","time","location","project","discription","colleagues","images","returnForm","borrowId","cancelForm","reason","records","currentTime","Date","serverTimeOffset","currentBookingData","showImageModal","selectedImages","showFullImageModal","fullSizeImage","teamsWebhookUrl","notifiedActiveBookings","Set","refreshInterval","timeInterval","syncInterval","computed","currentDateTime","toLocaleString","year","month","day","hour","minute","second","hasActiveBorrow","some","r","status","availableBorrows","currentUserName","getCurrentUserName","filter","name","pendingBorrows","isBorrower","isColleague","Array","isArray","colleague","colleagueName","currentReturnTime","toLocaleTimeString","selectedBorrowProject","selectedBorrow","find","id","selectedBorrowDescription","borrowRecordsCount","length","bookingsAllowingImageUpload","groupedImages","groups","forEach","image","type","push","Object","keys","map","mounted","syncServerTime","setInterval","now","loadRecords","beforeUnmount","clearInterval","created","$http","methods","response","get","silent","serverTime","clientTime","getTime","firstName","localStorage","getItem","lastName","trim","$toast","add","severity","summary","detail","life","triggerFileUpload","document","getElementById","click","selectDate","date","showReturnForm","showCancelForm","closeForm","resetForms","handleImageUpload","event","formType","files","from","target","removeImage","index","splice","convertImagesToBase64","promises","img","File","Promise","resolve","reader","FileReader","onload","result","readAsDataURL","all","openImageModal","imageSrc","src","calculateUsageDuration","borrowDate","borrowTime","returnDate","borrowDateTime","split","Number","setHours","diffMs","diffHours","Math","floor","diffMinutes","viewImages","bookingData","handleImageError","handleImageLoad","viewFullImage","imageUrl","formatDateForDB","d","bangkokTime","timeZone","getFullYear","String","getMonth","padStart","getDate","handleAdditionalImageUpload","bookingId","booking","newImages","file","base64","timestamp","currentImages","updatedImages","put","value","submitBorrow","borrowData","description","selected_date","user_id","post","err","details","error","submitReturn","$refs","bookingForm","selectedReturnBorrow","hour12","returnData","return_name","return_location","return_description","return_time","return_date","submitCancel","delete","updateBorrowForm","field","updateReturnForm","updateCancelForm","handleAdditionalImageUploadFromHistory","canUploadForBooking","record","handleModalImageUpload"],"sources":["D:\\frontend_cem\\src\\views\\car_booking\\car_booking.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"main-tabs\">\n      <div class=\"tabs-header\">\n        <div class=\"header-title\">\n          <i class=\"pi pi-car\"></i>\n          <h1>ระบบแจ้งใช้รถ/แจ้งคืนรถ</h1>\n        </div>\n        \n        <TabView v-model:activeIndex=\"activeTabIndex\" class=\"tab-navigation\">\n          <TabPanel>\n            <template #header>\n              <div class=\"tab-header\">\n                <i class=\"pi pi-calendar\"></i>\n                <span>ปฏิทิน</span>\n              </div>\n            </template>\n          </TabPanel>\n\n          <TabPanel>\n            <template #header>\n              <div class=\"tab-header\">\n                <i class=\"pi pi-history\"></i>\n                <span>ประวัติการใช้รถ</span>\n                <Badge v-if=\"borrowRecordsCount > 0\" :value=\"borrowRecordsCount\" severity=\"info\" />\n              </div>\n            </template>\n          </TabPanel>\n        </TabView>\n\n        <div v-if=\"activeTabIndex === 0\" class=\"action-buttons-header\">\n          <Button @click=\"showReturnForm\" :disabled=\"availableBorrows.length === 0\" severity=\"warning\"\n            icon=\"pi pi-upload\" raised>\n            <Badge v-if=\"availableBorrows.length > 0\" :value=\"availableBorrows.length\" severity=\"warning\" />\n            แจ้งคืนรถ\n          </Button>\n\n          <Button @click=\"showCancelForm\" :disabled=\"pendingBorrows.length === 0\" severity=\"danger\"\n            icon=\"pi pi-times-circle\" raised>\n            ยกเลิกการจอง\n            <Badge v-if=\"pendingBorrows.length > 0\" :value=\"pendingBorrows.length\" \n                   :style=\"{ backgroundColor: 'white', color: 'black', fontSize: '0.75rem', \n                            width: '1.2rem', height: '1.2rem', borderRadius: '50%',\n                            display: 'inline-flex', alignItems: 'center', justifyContent: 'center',\n                            lineHeight: '1', fontWeight: 'bold', border: '2px solid white' }\" />\n          </Button>\n        </div>\n      </div>\n\n      <div class=\"tab-content-area\">\n        <div v-if=\"activeTabIndex === 0\" class=\"tab-content\">\n          <Calendar :records=\"records\" :available-borrows=\"availableBorrows\" :pending-borrows=\"pendingBorrows\"\n            :has-active-borrow=\"hasActiveBorrow\" @select-date=\"selectDate\" @show-return-form=\"showReturnForm\"\n            @show-cancel-form=\"showCancelForm\" />\n        </div>\n\n        <div v-if=\"activeTabIndex === 1\" class=\"tab-content\">\n          <History :records=\"records\" @view-images=\"viewImages\"\n            @upload-images=\"handleAdditionalImageUploadFromHistory\" />\n        </div>\n      </div>\n    </div>\n\n    <!-- Form Modal -->\n    <BookingForm ref=\"bookingForm\" v-if=\"showForm\" :show-form=\"showForm\" :selected-date=\"selectedDate\"\n      :active-form=\"activeForm\" :borrow-form=\"borrowForm\" :return-form=\"returnForm\" :cancel-form=\"cancelForm\"\n      :available-borrows=\"availableBorrows\" :pending-borrows=\"pendingBorrows\" :current-return-time=\"currentReturnTime\"\n      :selected-borrow-project=\"selectedBorrowProject\" :selected-borrow-description=\"selectedBorrowDescription\" @close-form=\"closeForm\" @submit-borrow=\"submitBorrow\"\n      @submit-return=\"submitReturn\" @submit-cancel=\"submitCancel\" @handle-image-upload=\"handleImageUpload\"\n      @remove-image=\"removeImage\" @update-borrow-form=\"updateBorrowForm\" @updateReturnForm=\"updateReturnForm\"\n      @update-cancel-form=\"updateCancelForm\" />\n\n    <!-- Image Modal -->\n    <Dialog v-model:visible=\"showImageModal\" modal header=\"รูปภาพ\" :style=\"{ width: '80vw' }\" :draggable=\"false\">\n      <div v-if=\"selectedImages.length === 0\" class=\"no-images-state\">\n        <i class=\"pi pi-image\" style=\"font-size: 4rem; color: #ccc;\"></i>\n        <p>ไม่มีรูปภาพ</p>\n      </div>\n\n      <div v-else class=\"image-viewer\">\n        <div v-for=\"imageType in groupedImages\" :key=\"imageType.type\"\n          :class=\"['image-section', imageType.type.includes('ใช้') ? 'borrow-section' : 'return-section']\">\n          <div class=\"section-header\">\n            <i :class=\"imageType.type.includes('ใช้') ? 'pi pi-download' : 'pi pi-upload'\"></i>\n            รูปภาพตอน{{ imageType.type }}\n          </div>\n          <div class=\"images-grid\">\n            <div v-for=\"(image, index) in imageType.images\" :key=\"index\" class=\"image-container\">\n              <img :src=\"image.src?.src || image.src\" class=\"grid-image\" @click=\"viewFullImage(image)\" alt=\"รูปภาพ\" />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Upload section -->\n      <div v-if=\"currentBookingData && canUploadForBooking(currentBookingData)\" class=\"upload-section\">\n        <Divider />\n        <div class=\"upload-controls\">\n          <input type=\"file\" id=\"modal-upload\" @change=\"handleModalImageUpload\" accept=\"image/*\" multiple\n            style=\"display: none\" />\n          <Button label=\"อัปโหลดรูปเพิ่ม\" icon=\"pi pi-camera\" @click=\"triggerFileUpload\" severity=\"secondary\" />\n        </div>\n      </div>\n\n    </Dialog>\n    <!-- Full Size Image Modal -->\n    <Dialog v-model:visible=\"showFullImageModal\" modal header=\"รูปภาพขนาดใหญ่\" :style=\"{ width: '90vw' }\"\n      :draggable=\"false\">\n      <div v-if=\"!fullSizeImage\" class=\"no-image-placeholder\">\n        <p>ไม่สามารถโหลดรูปภาพได้</p>\n      </div>\n      <img v-else :src=\"typeof fullSizeImage === 'string' ? fullSizeImage : fullSizeImage.src\" class=\"full-size-image\"\n        @error=\"handleImageError\" @load=\"handleImageLoad\" />\n    </Dialog>\n\n    <!-- Toast for notifications -->\n    <Toast />\n  </div>\n</template>\n\n<script>\nimport Calendar from './Calendar.vue'\nimport History from './History.vue'\nimport BookingFormPrime from './BookingFormPrime.vue'\nimport axios from '@/utils/axiosConfig'\n\nexport default {\n  components: {\n    Calendar,\n    History,\n    BookingForm: BookingFormPrime\n  },\n  data() {\n    return {\n      activeTabIndex: 0,\n      selectedDate: null,\n      showForm: false,\n      activeForm: 'borrow',\n      borrowForm: {\n        license: 'ชฮ-3706',\n        time: '',\n        location: '',\n        project: '',\n        discription: '',\n        colleagues: [],\n        images: []\n      },\n      returnForm: {\n        borrowId: '',\n        license: 'ชฮ-3706',\n        location: '',\n        discription: '',\n        images: []\n      },\n      cancelForm: {\n        borrowId: '',\n        reason: ''\n      },\n      records: [],\n      currentTime: new Date(),\n      serverTimeOffset: 0,\n      currentBookingData: null,\n      showImageModal: false,\n      selectedImages: [],\n      showFullImageModal: false,\n      fullSizeImage: '',\n      teamsWebhookUrl: 'YOUR_TEAMS_WEBHOOK_URL_HERE',\n      notifiedActiveBookings: new Set(),\n      refreshInterval: null,\n      timeInterval: null,\n      syncInterval: null\n    }\n  },\n  computed: {\n    currentDateTime() {\n      return this.currentTime.toLocaleString('th-TH', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit'\n      })\n    },\n    hasActiveBorrow() {\n      return this.records.some(r => r.status === 'active')\n    },\n    availableBorrows() {\n      const currentUserName = this.getCurrentUserName()\n      \n      return this.records.filter(r => {\n        // Must be active status (past borrow time, not returned)\n        if (r.status !== 'active') return false\n\n        // Only borrower can return\n        return r.name === currentUserName\n      })\n    },\n    pendingBorrows() {\n      const currentUserName = this.getCurrentUserName()\n\n      return this.records.filter(r => {\n        // Must be pending status (future booking, not started yet)\n        if (r.status !== 'pending') return false\n\n        // Check if current user is authorized to cancel this booking\n        const isBorrower = r.name === currentUserName\n        const isColleague = r.colleagues && Array.isArray(r.colleagues) &&\n          r.colleagues.some(colleague => {\n            const colleagueName = typeof colleague === 'string' ? colleague : colleague?.name\n            return colleagueName === currentUserName\n          })\n\n        return isBorrower || isColleague\n      })\n    },\n    currentReturnTime() {\n      return this.currentTime.toLocaleTimeString('th-TH', {\n        hour: '2-digit',\n        minute: '2-digit'\n      })\n    },\n    selectedBorrowProject() {\n      if (!this.returnForm.borrowId) return ''\n      const selectedBorrow = this.records.find(r => r.id == this.returnForm.borrowId)\n      return selectedBorrow ? selectedBorrow.project : ''\n    },\n    selectedBorrowDescription() {\n      if (!this.returnForm.borrowId) return ''\n      const selectedBorrow = this.records.find(r => r.id == this.returnForm.borrowId)\n      return selectedBorrow ? selectedBorrow.discription : ''\n    },\n    borrowRecordsCount() {\n      return this.records.filter(r => r.status !== 'returned').length\n    },\n    bookingsAllowingImageUpload() {\n      const currentUserName = this.getCurrentUserName()\n      \n      return this.records.filter(r => {\n        // Must be active status and user is authorized\n        if (r.status !== 'active') return false\n\n        const isBorrower = r.name === currentUserName\n        const isColleague = r.colleagues && Array.isArray(r.colleagues) &&\n          r.colleagues.some(colleague => {\n            const colleagueName = typeof colleague === 'string' ? colleague : colleague?.name\n            return colleagueName === currentUserName\n          })\n\n        return isBorrower || isColleague\n      })\n    },\n    groupedImages() {\n      const groups = {}\n      this.selectedImages.forEach(image => {\n        if (!groups[image.type]) {\n          groups[image.type] = []\n        }\n        groups[image.type].push(image)\n      })\n      return Object.keys(groups).map(type => ({\n        type,\n        images: groups[type]\n      }))\n    }\n  },\n  mounted() {\n    this.syncServerTime()\n    \n    this.timeInterval = setInterval(() => {\n      this.currentTime = new Date(Date.now() + this.serverTimeOffset)\n    }, 1000)\n    \n    // Auto refresh ทุก 30 วินาที\n    this.refreshInterval = setInterval(() => {\n      this.loadRecords(true)\n    }, 30000)\n    \n    this.syncInterval = setInterval(() => {\n      this.syncServerTime()\n    }, 300000)\n  },\n  beforeUnmount() {\n    // Clear intervals เมื่อออกจากหน้านี้\n    if (this.refreshInterval) clearInterval(this.refreshInterval)\n    if (this.timeInterval) clearInterval(this.timeInterval)\n    if (this.syncInterval) clearInterval(this.syncInterval)\n  },\n  created() {\n    this.$http = axios\n    this.loadRecords()\n  },\n  methods: {\n    async syncServerTime() {\n      try {\n        const response = await axios.get('/api/server-time', { silent: true })\n        const serverTime = new Date(response.data.serverTime)\n        const clientTime = new Date()\n        this.serverTimeOffset = serverTime.getTime() - clientTime.getTime()\n        this.currentTime = new Date(Date.now() + this.serverTimeOffset)\n      } catch { // ignore\n      }\n    },\n    getCurrentUserName() {\n      const firstName = localStorage.getItem('soc_firstname') || ''\n      const lastName = localStorage.getItem('soc_lastname') || ''\n      return `${firstName} ${lastName}`.trim()\n    },\n    async loadRecords(silent = false) {\n      try {\n        const response = await axios.get('/api/car-booking', { silent })\n        this.records = response.data\n      } catch { // ignore\n        if (!silent) {\n          this.$toast.add({\n            severity: 'error',\n            summary: 'โหลดข้อมูลไม่สำเร็จ',\n            detail: 'กรุณารีเฟรชหน้าเว็บ',\n            life: 4000\n          })\n        }\n      }\n    },\n    triggerFileUpload() {\n      document.getElementById('modal-upload').click()\n    },\n    selectDate(date) {\n      this.selectedDate = date\n      this.showForm = true\n      this.activeForm = 'borrow'\n    },\n    showReturnForm() {\n      this.selectedDate = new Date(Date.now() + this.serverTimeOffset)\n      this.showForm = true\n      this.activeForm = 'return'\n    },\n    showCancelForm() {\n      this.selectedDate = new Date(Date.now() + this.serverTimeOffset)\n      this.showForm = true\n      this.activeForm = 'cancel'\n    },\n    closeForm() {\n      this.showForm = false\n      this.selectedDate = null\n      this.resetForms()\n    },\n    handleImageUpload(event, formType) {\n      const files = Array.from(event.target.files)\n      if (formType === 'borrow') {\n        this.borrowForm.images = [...(this.borrowForm.images || []), ...files]\n      } else {\n        this.returnForm.images = [...(this.returnForm.images || []), ...files]\n      }\n    },\n    removeImage(index, formType) {\n      if (formType === 'borrow') {\n        this.borrowForm.images.splice(index, 1)\n      } else {\n        this.returnForm.images.splice(index, 1)\n      }\n    },\n    async convertImagesToBase64(images) {\n      const promises = images.map(img => {\n        if (img instanceof File) {\n          return new Promise((resolve) => {\n            const reader = new FileReader()\n            reader.onload = () => resolve(reader.result)\n            reader.readAsDataURL(img)\n          })\n        }\n        return Promise.resolve(img)\n      })\n      return Promise.all(promises)\n    },\n    openImageModal(imageSrc) {\n      this.selectedImages = [{ src: imageSrc, type: 'รูปภาพ' }]\n      this.showImageModal = true\n    },\n    calculateUsageDuration(borrowDate, borrowTime, returnDate) {\n      const borrowDateTime = new Date(borrowDate)\n      const [hour, minute] = borrowTime.split(':').map(Number)\n      borrowDateTime.setHours(hour, minute, 0, 0)\n\n      const diffMs = returnDate - borrowDateTime\n      const diffHours = Math.floor(diffMs / (1000 * 60 * 60))\n      const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60))\n\n      if (diffHours > 0) {\n        return `${diffHours} ชั่วโมง ${diffMinutes} นาที`\n      } else {\n        return `${diffMinutes} นาที`\n      }\n    },\n    viewImages(images, bookingData = null) {\n      this.selectedImages = images\n      this.currentBookingData = bookingData\n      this.showImageModal = true\n    },\n    handleImageError() {\n      this.$toast.add({\n        severity: 'error',\n        summary: 'โหลดรูปไม่สำเร็จ',\n        detail: 'รูปภาพอาจถูกลบหรือไม่พร้อมใช้งาน',\n        life: 4000\n      })\n    },\n    handleImageLoad() {\n    },\n    viewFullImage(imageSrc) {\n      // Handle nested proxy objects\n      let imageUrl = imageSrc\n      if (typeof imageSrc === 'object' && imageSrc.src) {\n        imageUrl = typeof imageSrc.src === 'string' ? imageSrc.src : imageSrc.src.src\n      }\n      this.fullSizeImage = imageUrl\n      this.showFullImageModal = true\n    },\n    formatDateForDB(date) {\n      const d = new Date(date)\n      // Convert to Bangkok timezone\n      const bangkokTime = new Date(d.toLocaleString('en-US', { timeZone: 'Asia/Bangkok' }))\n      const year = bangkokTime.getFullYear()\n      const month = String(bangkokTime.getMonth() + 1).padStart(2, '0')\n      const day = String(bangkokTime.getDate()).padStart(2, '0')\n      return `${year}-${month}-${day}`\n    },\n    async handleAdditionalImageUpload(event, bookingId) {\n      const files = Array.from(event.target.files)\n      if (files.length === 0) return\n\n      try {\n        // Find the booking record\n        const booking = this.records.find(r => r.id === bookingId)\n        if (!booking) return\n\n        // Convert files to base64\n        const newImages = []\n        for (const file of files) {\n          const reader = new FileReader()\n          const base64 = await new Promise((resolve) => {\n            reader.onload = () => resolve(reader.result)\n            reader.readAsDataURL(file)\n          })\n          newImages.push({\n            name: file.name,\n            src: base64,\n            type: 'เพิ่มเติม',\n            timestamp: new Date(Date.now() + this.serverTimeOffset).toLocaleString('th-TH')\n          })\n        }\n\n        // Update booking with new images\n        const currentImages = booking.images || []\n        const updatedImages = [...currentImages, ...newImages]\n\n        // Update in database via API (need to add PUT endpoint)\n        await this.$http.put(`/api/car-booking/${bookingId}`, {\n          images: updatedImages\n        })\n\n        await this.loadRecords()\n\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: `อัปโหลดรูปภาพ ${files.length} ไฟล์เรียบร้อย`,\n          life: 3000\n        })\n\n        // Clear file input\n        event.target.value = ''\n      } catch { // ignore\n        this.$toast.add({\n          severity: 'error',\n          summary: 'อัปโหลดไม่สำเร็จ',\n          detail: 'ไฟล์อาจใหญ่เกินไป หรือรูปแบบไม่รองรับ',\n          life: 4000\n        })\n      }\n    },\n    async submitBorrow() {\n      try {\n        const images = await this.convertImagesToBase64(this.borrowForm.images || [])\n        const borrowData = {\n          type: 'borrow',\n          location: this.borrowForm.location,\n          project: this.borrowForm.project,\n          description: this.borrowForm.discription,\n          selected_date: this.formatDateForDB(this.selectedDate),\n          time: this.borrowForm.time,\n          license: 'ชฮ-3706',\n          colleagues: this.borrowForm.colleagues || [],\n          images,\n          user_id: localStorage.getItem('soc_user_id')\n        }\n\n        await this.$http.post('/api/car-booking', borrowData)\n\n\n        await this.loadRecords()\n        this.closeForm()\n\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'บันทึกการจองรถเรียบร้อยแล้ว',\n          life: 3000\n        })\n      } catch (err) {\n        // Handle conflict error (409)\n        if (err.response?.status === 409) {\n          this.$toast.add({\n            severity: 'warn',\n            summary: 'ไม่สามารถจองได้',\n            detail: err.response.data.details || err.response.data.error,\n            life: 5000\n          })\n        } else {\n          this.$toast.add({\n            severity: 'error',\n            summary: 'บันทึกไม่สำเร็จ',\n            detail: 'กรุณาลองใหม่อีกครั้ง',\n            life: 4000\n          })\n        }\n      }\n    },\n    async submitReturn() {\n      const borrowId = this.returnForm.borrowId || this.$refs.bookingForm?.selectedReturnBorrow\n\n      if (!borrowId) {\n        this.$toast.add({ severity: 'error', summary: 'กรุณาเลือกข้อมูล', detail: 'เลือกการแจ้งใช้รถที่ต้องการคืน', life: 4000 })\n        return\n      }\n\n      try {\n        const firstName = localStorage.getItem('soc_firstname') || ''\n        const lastName = localStorage.getItem('soc_lastname') || ''\n        const currentUserName = `${firstName} ${lastName}`.trim()\n\n        const bangkokTime = new Date(Date.now() + this.serverTimeOffset)\n        const currentTime = bangkokTime.toLocaleTimeString('th-TH', {\n          hour: '2-digit',\n          minute: '2-digit',\n          hour12: false\n        })\n\n        const images = await this.convertImagesToBase64(this.returnForm.images || [])\n        const returnData = {\n          return_name: currentUserName,\n          return_location: this.returnForm.location,\n          return_description: this.returnForm.discription,\n          return_time: currentTime,\n          return_date: this.formatDateForDB(bangkokTime),\n          images\n        }\n\n        await axios.put(`/api/car-booking/${borrowId}`, returnData)\n\n        await this.loadRecords()\n        this.closeForm()\n\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'บันทึกการคืนรถเรียบร้อยแล้ว',\n          life: 3000\n        })\n      } catch { // ignore\n        this.$toast.add({\n          severity: 'error',\n          summary: 'บันทึกไม่สำเร็จ',\n          detail: 'กรุณาลองใหม่อีกครั้ง',\n          life: 4000\n        })\n      }\n    },\n    async submitCancel() {\n\n      if (!this.cancelForm.borrowId) {\n        this.$toast.add({ severity: 'error', summary: 'กรุณาเลือกข้อมูล', detail: 'เลือกการจองที่ต้องการยกเลิก', life: 4000 })\n        return\n      }\n\n      try {\n        await this.$http.delete(`/api/car-booking/${this.cancelForm.borrowId}`)\n\n        await this.loadRecords()\n        this.closeForm()\n\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'ยกเลิกการจองเรียบร้อยแล้ว',\n          life: 3000\n        })\n      } catch { // ignore\n        this.$toast.add({\n          severity: 'error',\n          summary: 'ยกเลิกไม่สำเร็จ',\n          detail: 'กรุณาลองใหม่อีกครั้ง',\n          life: 4000\n        })\n      }\n    },\n    updateBorrowForm({ field, value }) {\n      this.borrowForm[field] = value\n    },\n    updateReturnForm(field, value) {\n      this.returnForm[field] = value\n    },\n    updateCancelForm({ field, value }) {\n      this.cancelForm[field] = value\n    },\n    async handleAdditionalImageUploadFromHistory({ files, bookingId }) {\n      if (files.length === 0) return\n\n      try {\n        // Find the booking record\n        const booking = this.records.find(r => r.id === bookingId)\n        if (!booking) return\n\n        // Convert files to base64\n        const newImages = []\n        for (const file of files) {\n          const reader = new FileReader()\n          const base64 = await new Promise((resolve) => {\n            reader.onload = () => resolve(reader.result)\n            reader.readAsDataURL(file)\n          })\n          newImages.push({\n            name: file.name,\n            src: base64,\n            type: 'เพิ่มเติม',\n            timestamp: new Date(Date.now() + this.serverTimeOffset).toLocaleString('th-TH')\n          })\n        }\n\n        // Update booking with new images\n        const currentImages = booking.images || []\n        const updatedImages = [...currentImages, ...newImages]\n\n        // Update in database via API\n        await this.$http.put(`/api/car-booking/${bookingId}`, {\n          images: updatedImages\n        })\n\n        await this.loadRecords()\n\n        this.$toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: `อัปโหลดรูปภาพ ${files.length} ไฟล์เรียบร้อย`,\n          life: 3000\n        })\n      } catch { // ignore\n        this.$toast.add({\n          severity: 'error',\n          summary: 'อัปโหลดไม่สำเร็จ',\n          detail: 'ไฟล์อาจใหญ่เกินไป หรือรูปแบบไม่รองรับ',\n          life: 4000\n        })\n      }\n    },\n    resetForms() {\n      this.borrowForm = {\n        license: 'ชฮ-3706',\n        time: '',\n        location: '',\n        project: '',\n        discription: '',\n        colleagues: [],\n        images: []\n      }\n      this.returnForm = {\n        borrowId: '',\n        license: 'ชฮ-3706',\n        location: '',\n        discription: '',\n        images: []\n      }\n      this.cancelForm = {\n        borrowId: '',\n        reason: ''\n      }\n    },\n    canUploadForBooking(bookingData) {\n      if (!bookingData) return false\n      \n      // Find the actual record from this.records\n      const record = this.records.find(r => r.id === bookingData.id)\n      if (!record) return false\n      \n      // Can upload if status is active\n      return record.status === 'active'\n    },\n    async handleModalImageUpload(event) {\n      if (!this.currentBookingData) return\n\n      const files = Array.from(event.target.files)\n      if (files.length === 0) return\n\n      await this.handleAdditionalImageUploadFromHistory({\n        files,\n        bookingId: this.currentBookingData.id\n      })\n\n      // Clear file input and close modal\n      event.target.value = ''\n      this.showImageModal = false\n    }\n  }\n}\n</script>\n\n<style scoped>\n.calendar-card {\n  width: 100%;\n  margin: 0;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n  border: 1px solid #e9ecef;\n}\n\n.app-container {\n  padding: 1rem;\n  padding-bottom: 0;\n  max-width: 100%;\n  margin: 0 auto;\n  \n  background: #e5e7eb;\n  height: 100%;\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n  overflow: auto;\n}\n\n.main-tabs {\n  margin-top: 0;\n  box-shadow: 0 4px 20px rgba(74, 144, 226, 0.15);\n  border-radius: 15px;\n  overflow: hidden;\n  border: 1px solid rgba(74, 144, 226, 0.2);\n  background: white;\n}\n\n.tabs-header {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0.75rem 1.5rem;\n  background: linear-gradient(135deg, #4A90E2, #D73527);\n  position: relative;\n  flex-wrap: wrap;\n  gap: 1rem;\n}\n\n.header-title {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  color: white;\n  position: absolute;\n  left: 50%;\n  transform: translateX(-50%);\n  z-index: 2;\n}\n\n.header-title h1 {\n  margin: 0;\n  font-size: 1.8rem;\n  font-weight: 600;\n}\n\n.header-title i {\n  font-size: 1.5rem;\n}\n\n.tab-navigation {\n  background: transparent;\n  max-width: 100%;\n  overflow: hidden;\n  margin-right: auto;\n}\n\n.tab-navigation :deep(.p-tabview-nav) {\n  background: transparent;\n  border: none;\n  margin: 0;\n  padding: 0;\n  flex-wrap: wrap;\n  justify-content: center;\n}\n\n.tab-navigation :deep(.p-tabview-nav-link) {\n  color: white;\n  border: none;\n  font-weight: 500;\n  padding: 0.75rem 1rem;\n  font-size: 0.9rem;\n  transition: all 0.3s ease;\n  border-radius: 8px;\n  margin: 0.25rem;\n  white-space: nowrap;\n}\n\n.tab-navigation :deep(.p-tabview-nav li.p-highlight .p-tabview-nav-link) {\n  background: rgba(255, 255, 255, 0.25);\n  color: white;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n  transform: translateY(-2px);\n  border-bottom: none !important;\n}\n\n.tab-navigation :deep(.p-tabview-nav-link:hover) {\n  background: rgba(255, 255, 255, 0.15);\n  transform: translateY(-1px);\n}\n\n.tab-navigation :deep(.p-tabview-ink-bar) {\n  display: none !important;\n}\n\n.tab-navigation :deep(.p-tabview-panels) {\n  display: none;\n}\n\n.action-buttons-header {\n  display: flex;\n  gap: 1rem;\n  flex-shrink: 0;\n  z-index: 1;\n  margin-left: auto;\n}\n\n.action-buttons-header .p-button {\n  font-weight: 700;\n  padding: 0.75rem 1.25rem;\n  font-size: 0.95rem;\n  border-radius: 8px;\n  min-width: 140px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n  border: 3px solid white;\n}\n\n.action-buttons-header .p-button:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n  border: 3px solid white;\n}\n\n.tab-content-area {\n  background: white;\n}\n\n.tab-content {\n  padding: 0;\n}\n\n.main-tabs :deep(.p-tabview-nav) {\n  background: transparent;\n  border: none;\n  margin: 0;\n  padding: 0.5rem;\n  gap: 0.5rem;\n}\n\n.main-tabs :deep(.p-tabview-nav-link) {\n  color: black !important;\n  border: none;\n  font-weight: 800 !important;\n  padding: 1rem 1.5rem;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n  border-radius: 8px;\n  margin: 0 0.25rem;\n  background: rgba(255, 255, 255, 0.4\n  )\n}\n\n.tab-header {\n  font-weight: 800 !important;\n  color: black !important;\n}\n\n.tab-header span {\n  font-weight: 800 !important;\n  color: black !important;\n}\n\n.tab-header i {\n  font-size: 1.2rem;\n  font-weight: 900;\n}\n\n.main-tabs :deep(.p-tabview-nav li.p-highlight .p-tabview-nav-link) {\n  background: white;\n  color: #4A90E2;\n  box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);\n  transform: translateY(-2px);\n  border-bottom: none !important;\n  font-weight: 700;\n  border-radius: 8px;\n}\n\n.main-tabs :deep(.p-tabview-nav-link:hover) {\n  background: rgba(255, 255, 255, 0.2);\n  transform: translateY(-1px);\n  border-radius: 8px;\n}\n\n.main-tabs :deep(.p-tabview-ink-bar) {\n  display: none !important;\n}\n\n.main-tabs :deep(.p-tabview-panels) {\n  background: white;\n  padding: 0;\n  border-radius: 0 0 15px 15px;\n}\n\n.main-tabs :deep(.p-tabview-panel) {\n  padding: 0;\n}\n\n.tab-header {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  font-weight: 500;\n}\n\n.tab-header i {\n  font-size: 1.1rem;\n}\n\n.tab-content {\n  padding: 0;\n}\n\n.image-viewer {\n  display: flex;\n  flex-direction: column;\n  gap: 2rem;\n}\n\n.image-section {\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.borrow-section {\n  border: 2px solid #dc3545;\n}\n\n.borrow-section .section-header {\n  background: #f8d7da;\n  color: #721c24;\n  border-bottom: 1px solid #f5c6cb;\n}\n\n.borrow-section .grid-image {\n  border: 3px solid #dc3545;\n}\n\n.return-section {\n  border: 2px solid #28a745;\n}\n\n.return-section .section-header {\n  background: #d4edda;\n  color: #155724;\n  border-bottom: 1px solid #c3e6cb;\n}\n\n.return-section .grid-image {\n  border: 3px solid #28a745;\n}\n\n.section-header {\n  background: #f8f9fa;\n  padding: 1rem;\n  font-weight: 600;\n  color: #495057;\n  border-bottom: 1px solid #e9ecef;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.images-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(100px, 120px));\n  gap: 0.5rem;\n  padding: 0.5rem;\n}\n\n.image-container {\n  position: relative;\n  width: 100%;\n  height: 100px;\n}\n\n.grid-image {\n  width: 100%;\n  height: 100px;\n  object-fit: contain;\n  border-radius: 6px;\n  border: 1px solid #e9ecef;\n  cursor: pointer;\n  transition: transform 0.2s ease;\n}\n\n.image-placeholder {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 200px;\n  background: #f8f9fa;\n  border: 1px dashed #dee2e6;\n  border-radius: 6px;\n  color: #6c757d;\n}\n\n.grid-image:hover {\n  transform: scale(1.05);\n}\n\n.full-size-image {\n  max-width: 100%;\n  max-height: 80vh;\n  object-fit: contain;\n  border-radius: 8px;\n  display: block;\n  margin: 0 auto;\n}\n\n.no-images-state {\n  text-align: center;\n  padding: 3rem;\n  color: #6c757d;\n}\n\n.no-images-state p {\n  margin-top: 1rem;\n  font-size: 1.1rem;\n}\n\n.upload-section {\n  margin-top: 1rem;\n}\n\n.upload-controls {\n  text-align: center;\n  padding: 1rem;\n}\n\n@media (max-width: 768px) {\n  .app-container {\n    padding: 1rem;\n  }\n\n  .main-header {\n    flex-direction: column;\n    text-align: center;\n    padding: 1.5rem;\n  }\n\n  .main-header h1 {\n    font-size: 1.5rem;\n  }\n\n  .car-status {\n    margin-bottom: 1rem !important;\n  }\n\n  .status-card {\n    min-width: 100%;\n    max-width: 100%;\n  }\n\n  .status-content {\n    padding: 1rem;\n    gap: 1rem;\n    flex-direction: column;\n    text-align: center;\n  }\n\n  .status-icon {\n    font-size: 2rem;\n  }\n\n  .status-text {\n    align-items: center;\n  }\n\n  .tabs-header {\n    flex-direction: column;\n    gap: 1rem;\n    padding: 1rem;\n    text-align: center;\n  }\n\n  .header-title {\n    order: 1;\n    position: static;\n    transform: none;\n    justify-content: center;\n    width: 100%;\n  }\n\n  .tab-navigation {\n    order: 2;\n    width: 100%;\n    margin-right: 0;\n  }\n\n  .tab-navigation :deep(.p-tabview-nav) {\n    flex-direction: column;\n    gap: 0.5rem;\n    padding: 0.5rem;\n  }\n\n  .tab-navigation :deep(.p-tabview-nav-link) {\n    padding: 0.75rem 1rem;\n    font-size: 0.85rem;\n    margin: 0;\n    width: 100%;\n    text-align: center;\n  }\n\n  .action-buttons-header {\n    order: 3;\n    width: 100%;\n    justify-content: center;\n    flex-wrap: wrap;\n  }\n\n  .action-buttons-header {\n    width: 100%;\n    justify-content: center;\n    flex-wrap: wrap;\n  }\n\n  .action-buttons-header .p-button {\n    flex: 1;\n    font-size: 0.9rem;\n    padding: 0.75rem 1rem;\n    min-width: auto;\n  }\n}\n\n@media (max-width: 480px) {\n  .app-container {\n    padding: 0.5rem;\n  }\n\n  .main-header h1 {\n    font-size: 1.25rem;\n  }\n\n  .header-title h1 {\n    font-size: 1.2rem;\n  }\n\n  .status-card {\n    min-width: 100%;\n  }\n\n  .status-content {\n    padding: 0.8rem;\n  }\n\n  .status-icon {\n    font-size: 1.8rem;\n  }\n\n  .status-text strong {\n    font-size: 1rem;\n  }\n\n  .action-buttons-header {\n    flex-direction: column;\n    gap: 0.8rem;\n  }\n\n  .action-buttons-header .p-button {\n    width: 100%;\n    font-size: 0.85rem;\n    padding: 0.75rem;\n  }\n\n  .tab-navigation :deep(.p-tabview-nav-link) {\n    padding: 0.6rem 0.8rem;\n    font-size: 0.8rem;\n  }\n\n  .tab-header {\n    gap: 0.5rem;\n  }\n\n  .tab-header span {\n    font-size: 0.8rem;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}