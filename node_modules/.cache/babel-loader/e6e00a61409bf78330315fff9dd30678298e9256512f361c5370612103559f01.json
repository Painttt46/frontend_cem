{"ast":null,"code":"import axios from 'axios';\nimport router from '@/router';\n\n// Configure axios defaults\naxios.defaults.baseURL = '';\naxios.defaults.withCredentials = true;\naxios.defaults.timeout = 30000; // 30 seconds\n\n// Request interceptor\naxios.interceptors.request.use(config => {\n  // ไม่ส่ง request ถ้าอยู่หน้า login (ยกเว้น auth API)\n  if (router.currentRoute.value.path === '/login' && !config.url?.includes('/auth/')) {\n    const error = new Error('Request cancelled - on login page');\n    error.silent = true;\n    return Promise.reject(error);\n  }\n\n  // Add token to Authorization header\n  const token = localStorage.getItem('soc_token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  // Add timestamp to prevent caching\n  config.params = {\n    ...config.params,\n    _t: Date.now()\n  };\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor\naxios.interceptors.response.use(response => {\n  return response;\n}, error => {\n  // Handle different error types\n  if (error.response) {\n    // Server responded with error status\n    const {\n      status,\n      data\n    } = error.response;\n    switch (status) {\n      case 401:\n        // Unauthorized - clear all auth data and redirect to login\n        localStorage.clear();\n        sessionStorage.clear();\n        // Clear all cookies\n        document.cookie.split(\";\").forEach(c => {\n          document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\");\n        });\n\n        // Redirect to login\n        if (router.currentRoute.value.path !== '/login') {\n          router.push('/login');\n        }\n        error.silent = true;\n        break;\n      case 403:\n        // Forbidden\n        error.userMessage = 'คุณไม่มีสิทธิ์เข้าถึงข้อมูลนี้';\n        break;\n      case 404:\n        // Not found\n        error.userMessage = 'ไม่พบข้อมูลที่ต้องการ';\n        break;\n      case 422:\n        // Validation error\n        error.userMessage = data.error || 'ข้อมูลไม่ถูกต้อง กรุณาตรวจสอบอีกครั้ง';\n        break;\n      case 429:\n        // Too many requests\n        error.userMessage = 'คำขอมากเกินไป กรุณารอสักครู่แล้วลองใหม่';\n        break;\n      case 500:\n      case 502:\n      case 503:\n      case 504:\n        // Server error\n        error.userMessage = 'เกิดข้อผิดพลาดจากเซิร์ฟเวอร์ กรุณาลองใหม่อีกครั้ง';\n        break;\n      default:\n        error.userMessage = data.error || 'เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง';\n    }\n  } else if (error.request) {\n    // Request was made but no response\n    if (error.code === 'ECONNABORTED') {\n      error.userMessage = 'การเชื่อมต่อหมดเวลา กรุณาลองใหม่อีกครั้ง';\n    } else if (error.code === 'ERR_NETWORK') {\n      error.userMessage = 'ไม่สามารถเชื่อมต่อได้ กรุณาตรวจสอบอินเทอร์เน็ต';\n    } else {\n      error.userMessage = 'ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้';\n    }\n  } else if (error.silent) {\n    // Silent error - don't log\n    return Promise.reject(error);\n  } else {\n    // Something else happened\n    error.userMessage = 'เกิดข้อผิดพลาดที่ไม่คาดคิด';\n  }\n  return Promise.reject(error);\n});\nexport default axios;","map":{"version":3,"names":["axios","router","defaults","baseURL","withCredentials","timeout","interceptors","request","use","config","currentRoute","value","path","url","includes","error","Error","silent","Promise","reject","token","localStorage","getItem","headers","Authorization","params","_t","Date","now","response","status","data","clear","sessionStorage","document","cookie","split","forEach","c","replace","toUTCString","push","userMessage","code"],"sources":["D:/frontend_cem/src/utils/axiosConfig.js"],"sourcesContent":["import axios from 'axios'\nimport router from '@/router'\n\n// Configure axios defaults\naxios.defaults.baseURL = ''\naxios.defaults.withCredentials = true\naxios.defaults.timeout = 30000 // 30 seconds\n\n// Request interceptor\naxios.interceptors.request.use(\n  (config) => {\n    // ไม่ส่ง request ถ้าอยู่หน้า login (ยกเว้น auth API)\n    if (router.currentRoute.value.path === '/login' && !config.url?.includes('/auth/')) {\n      const error = new Error('Request cancelled - on login page')\n      error.silent = true\n      return Promise.reject(error)\n    }\n    \n    // Add token to Authorization header\n    const token = localStorage.getItem('soc_token')\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`\n    }\n    // Add timestamp to prevent caching\n    config.params = {\n      ...config.params,\n      _t: Date.now()\n    }\n    return config\n  },\n  (error) => {\n    return Promise.reject(error)\n  }\n)\n\n// Response interceptor\naxios.interceptors.response.use(\n  (response) => {\n    return response\n  },\n  (error) => {\n    // Handle different error types\n    if (error.response) {\n      // Server responded with error status\n      const { status, data } = error.response\n      \n      switch (status) {\n        case 401:\n          // Unauthorized - clear all auth data and redirect to login\n          localStorage.clear()\n          sessionStorage.clear()\n          // Clear all cookies\n          document.cookie.split(\";\").forEach((c) => {\n            document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\")\n          })\n          \n          // Redirect to login\n          if (router.currentRoute.value.path !== '/login') {\n            router.push('/login')\n          }\n          error.silent = true\n          break\n          \n        case 403:\n          // Forbidden\n          error.userMessage = 'คุณไม่มีสิทธิ์เข้าถึงข้อมูลนี้'\n          break\n          \n        case 404:\n          // Not found\n          error.userMessage = 'ไม่พบข้อมูลที่ต้องการ'\n          break\n          \n        case 422:\n          // Validation error\n          error.userMessage = data.error || 'ข้อมูลไม่ถูกต้อง กรุณาตรวจสอบอีกครั้ง'\n          break\n          \n        case 429:\n          // Too many requests\n          error.userMessage = 'คำขอมากเกินไป กรุณารอสักครู่แล้วลองใหม่'\n          break\n          \n        case 500:\n        case 502:\n        case 503:\n        case 504:\n          // Server error\n          error.userMessage = 'เกิดข้อผิดพลาดจากเซิร์ฟเวอร์ กรุณาลองใหม่อีกครั้ง'\n          break\n          \n        default:\n          error.userMessage = data.error || 'เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง'\n      }\n    } else if (error.request) {\n      // Request was made but no response\n      if (error.code === 'ECONNABORTED') {\n        error.userMessage = 'การเชื่อมต่อหมดเวลา กรุณาลองใหม่อีกครั้ง'\n      } else if (error.code === 'ERR_NETWORK') {\n        error.userMessage = 'ไม่สามารถเชื่อมต่อได้ กรุณาตรวจสอบอินเทอร์เน็ต'\n      } else {\n        error.userMessage = 'ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้'\n      }\n    } else if (error.silent) {\n      // Silent error - don't log\n      return Promise.reject(error)\n    } else {\n      // Something else happened\n      error.userMessage = 'เกิดข้อผิดพลาดที่ไม่คาดคิด'\n    }\n    \n    return Promise.reject(error)\n  }\n)\n\nexport default axios\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}