{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"loading-overlay\"\n};\nconst _hoisted_2 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_view = _resolveComponent(\"router-view\");\n  const _component_LayoutView = _resolveComponent(\"LayoutView\");\n  return _openBlock(), _createElementBlock(\"div\", {\n    id: \"app\",\n    class: _normalizeClass({\n      'dark-mode': _ctx.$store.state.darkMode\n    }),\n    style: {\n      \"height\": \"100vh\",\n      \"overflow\": \"hidden\"\n    }\n  }, [_createCommentVNode(\" Global Loading Overlay \"), _ctx.$store.state.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [...(_cache[0] || (_cache[0] = [_createElementVNode(\"div\", {\n    class: \"spinner\"\n  }, null, -1 /* CACHED */)]))])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Show only router-view for login page \"), _ctx.$router.currentRoute.value.fullPath == '/login' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode(_component_router_view)])) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 2\n  }, [_createCommentVNode(\" Show LayoutView with sidebar for other pages \"), _createElementVNode(\"div\", null, [_createVNode(_component_LayoutView)])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))], 2 /* CLASS */);\n}","map":{"version":3,"names":["class","_createElementBlock","id","_normalizeClass","_ctx","$store","state","darkMode","style","_createCommentVNode","loading","_hoisted_1","_cache","_createElementVNode","$router","currentRoute","value","fullPath","_hoisted_2","_createVNode","_component_router_view","_Fragment","key","_component_LayoutView"],"sources":["D:\\frontend_cem\\src\\App.vue"],"sourcesContent":["<!-- App.vue -->\n<template>\n  <div id=\"app\" :class=\"{ 'dark-mode': $store.state.darkMode }\" style=\"height: 100vh; overflow: hidden;\">\n    <!-- Global Loading Overlay -->\n    <div v-if=\"$store.state.loading\" class=\"loading-overlay\">\n      <div class=\"spinner\"></div>\n    </div>\n    \n    <!-- Show only router-view for login page -->\n    <div v-if=\"$router.currentRoute.value.fullPath == '/login'\">\n      <router-view />\n    </div>\n    <!-- Show LayoutView with sidebar for other pages -->\n    <div v-else>\n      <LayoutView />\n    </div>\n  </div>\n</template>\n\n<script>\nimport LayoutView from './components/LayoutView.vue';\n\nexport default {\n  name: 'App',\n  components: {\n    LayoutView,\n  },\n  data() {\n    return {\n      tokenCheckInterval: null\n    }\n  },\n  mounted() {\n    // Initialize theme\n    this.$store.dispatch('initTheme')\n    \n    // ตรวจสอบ token expiration ทุก 1 นาที\n    this.tokenCheckInterval = setInterval(() => {\n      this.checkTokenExpiration()\n    }, 60000)\n  },\n  beforeUnmount() {\n    if (this.tokenCheckInterval) {\n      clearInterval(this.tokenCheckInterval)\n    }\n  },\n  methods: {\n    checkTokenExpiration() {\n      const token = localStorage.getItem('soc_token')\n      if (!token) return\n      \n      try {\n        const parts = token.split('.')\n        if (parts.length !== 3) return\n        \n        const payload = JSON.parse(atob(parts[1]))\n        if (Date.now() >= payload.exp * 1000) {\n          // Token หมดอายุ - logout\n          localStorage.clear()\n          sessionStorage.clear()\n          document.cookie.split(\";\").forEach((c) => {\n            document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\")\n          })\n          this.$router.push('/login')\n        }\n      } catch {\n        // ignore parse errors\n      }\n    }\n  }\n};\n</script>\n\n<style>\n@import '/src/assets/styles/main.css';\n\n:root {\n  --label-color: #64748b;\n  --status-closed-red: #A90F0A;\n  --table-font-size: 1rem;\n  --default-font-size: 0.8rem;\n  font-size: var(--default-font-size);\n  \n  /* Light mode (default) */\n  --bg-primary: #ffffff;\n  --bg-secondary: #e5e7eb;\n  --bg-card: #ffffff;\n  --text-primary: #1f2937;\n  --text-secondary: #6b7280;\n  --border-color: #e5e7eb;\n}\n\n[data-theme=\"dark\"] {\n  --bg-primary: #1f2937;\n  --bg-secondary: #111827;\n  --bg-card: #374151;\n  --text-primary: #f9fafb;\n  --text-secondary: #d1d5db;\n  --border-color: #4b5563;\n  --label-color: #9ca3af;\n}\n\nlabel {\n  margin-bottom: 2px;\n  color: var(--label-color);\n  font-size: 0.875rem;\n}\n\n* {\n  box-sizing: border-box;\n}\n\nbody {\n  margin: 0;\n  padding: 0;\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n}\n\n/* Loading Overlay */\n.loading-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 9999;\n}\n\n.spinner {\n  width: 50px;\n  height: 50px;\n  border: 5px solid rgba(255, 255, 255, 0.3);\n  border-top-color: #fff;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n/* Scrollbar */\n::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n}\n\n::-webkit-scrollbar-track {\n  background: #f1f1f1;\n  border-radius: 3px;\n}\n\n::-webkit-scrollbar-thumb {\n  background: #c1c1c1;\n  border-radius: 3px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: #a1a1a1;\n}\n</style>\n"],"mappings":";;;EAIqCA,KAAK,EAAC;;;;;;;;uBAFzCC,mBAAA,CAcM;IAdDC,EAAE,EAAC,KAAK;IAAEF,KAAK,EAAAG,eAAA;MAAA,aAAiBC,IAAA,CAAAC,MAAM,CAACC,KAAK,CAACC;IAAQ;IAAIC,KAAwC,EAAxC;MAAA;MAAA;IAAA;MAC5DC,mBAAA,4BAA+B,EACpBL,IAAA,CAAAC,MAAM,CAACC,KAAK,CAACI,OAAO,I,cAA/BT,mBAAA,CAEM,OAFNU,UAEM,OAAAC,MAAA,QAAAA,MAAA,OADJC,mBAAA,CAA2B;IAAtBb,KAAK,EAAC;EAAS,0B,2CAGtBS,mBAAA,0CAA6C,EAClCL,IAAA,CAAAU,OAAO,CAACC,YAAY,CAACC,KAAK,CAACC,QAAQ,gB,cAA9ChB,mBAAA,CAEM,OAAAiB,UAAA,GADJC,YAAA,CAAeC,sBAAA,E,oBAGjBnB,mBAAA,CAEMoB,SAAA;IAAAC,GAAA;EAAA,IAHNb,mBAAA,kDAAqD,EACrDI,mBAAA,CAEM,cADJM,YAAA,CAAcI,qBAAA,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}