{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, withCtx as _withCtx, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, createBlock as _createBlock, unref as _unref, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"leave-management-container\"\n};\nconst _hoisted_2 = {\n  class: \"header-content\"\n};\nconst _hoisted_3 = {\n  class: \"table-header\"\n};\nconst _hoisted_4 = {\n  class: \"filters-section\"\n};\nconst _hoisted_5 = {\n  class: \"table-wrapper\"\n};\nconst _hoisted_6 = {\n  class: \"leave-type-header\"\n};\nconst _hoisted_7 = {\n  class: \"quota-cell\"\n};\nconst _hoisted_8 = {\n  class: \"quota-row\"\n};\nconst _hoisted_9 = {\n  class: \"quota-value\"\n};\nconst _hoisted_10 = {\n  class: \"remaining\"\n};\nconst _hoisted_11 = {\n  class: \"leave-type-form\"\n};\nconst _hoisted_12 = {\n  class: \"field\"\n};\nconst _hoisted_13 = {\n  class: \"field\"\n};\nconst _hoisted_14 = {\n  key: 0,\n  class: \"edit-quota-form\"\n};\nconst _hoisted_15 = {\n  class: \"user-info\"\n};\nconst _hoisted_16 = {\n  class: \"field\"\n};\nconst _hoisted_17 = {\n  class: \"field\"\n};\nconst _hoisted_18 = {\n  class: \"field-hint\"\n};\nconst _hoisted_19 = {\n  class: \"field\"\n};\nconst _hoisted_20 = {\n  class: \"field-hint\"\n};\nimport { ref, onMounted, computed } from 'vue';\nimport { useToast } from 'primevue/usetoast';\nimport { useConfirm } from 'primevue/useconfirm';\nimport axios from '@/utils/axiosConfig';\nimport InputNumber from 'primevue/inputnumber';\nimport Divider from 'primevue/divider';\nexport default {\n  __name: 'LeaveManagement',\n  setup(__props) {\n    const toast = useToast();\n    const confirm = useConfirm();\n    const users = ref([]);\n    const leaveTypes = ref([]);\n    const showAddLeaveTypeDialog = ref(false);\n    const showEditQuotaDialog = ref(false);\n    const adding = ref(false);\n    const saving = ref(false);\n    const newLeaveTypeName = ref('');\n    const newLeaveTypeQuota = ref(0);\n\n    // Filter states\n    const searchQuery = ref('');\n    const selectedDepartment = ref(null);\n    const selectedPosition = ref(null);\n    const departments = ref([]);\n    const positions = ref([]);\n\n    // Edit quota states\n    const editingUser = ref(null);\n    const editingLeaveType = ref(null);\n    const currentQuota = ref(0);\n    const currentRemaining = ref(0);\n    const newQuota = ref(0);\n    const newRemaining = ref(0);\n\n    // Computed filtered users\n    const filteredUsers = computed(() => {\n      let filtered = users.value;\n\n      // Search filter\n      if (searchQuery.value) {\n        const query = searchQuery.value.toLowerCase();\n        filtered = filtered.filter(user => user.firstname?.toLowerCase().includes(query) || user.lastname?.toLowerCase().includes(query) || user.department?.toLowerCase().includes(query) || user.position?.toLowerCase().includes(query));\n      }\n\n      // Department filter\n      if (selectedDepartment.value) {\n        filtered = filtered.filter(user => user.department === selectedDepartment.value);\n      }\n\n      // Position filter\n      if (selectedPosition.value) {\n        filtered = filtered.filter(user => user.position === selectedPosition.value);\n      }\n      return filtered;\n    });\n    onMounted(() => {\n      loadLeaveTypes();\n      loadUsers();\n    });\n    const loadLeaveTypes = async () => {\n      try {\n        const response = await axios.get('/api/leave/leave-types');\n        leaveTypes.value = response.data;\n      } catch (error) {\n        console.error('Error loading leave types:', error);\n      }\n    };\n    const loadUsers = async () => {\n      try {\n        const usersRes = await axios.get('/api/users');\n        users.value = await Promise.all(usersRes.data.map(async user => {\n          try {\n            const quotaRes = await axios.get(`/api/leave/quota/${user.id}`);\n            const quotaData = quotaRes.data;\n            const userData = {\n              ...user\n            };\n\n            // Add quota data for each leave type dynamically\n            for (const [leaveType, data] of Object.entries(quotaData)) {\n              userData[`${leaveType}_quota`] = data?.quota || 0;\n              userData[`${leaveType}_used`] = data?.usedDays || 0;\n              userData[`${leaveType}_remaining`] = data?.remainingDays || 0;\n            }\n            return userData;\n          } catch (error) {\n            console.error(`Error loading quota for user ${user.id}:`, error);\n            return {\n              ...user\n            };\n          }\n        }));\n\n        // Extract unique departments and positions\n        extractFilters();\n      } catch (error) {\n        toast.add({\n          severity: 'error',\n          summary: 'เกิดข้อผิดพลาด',\n          detail: 'ไม่สามารถโหลดข้อมูลได้',\n          life: 3000\n        });\n      }\n    };\n    const extractFilters = () => {\n      // Extract unique departments\n      const depts = [...new Set(users.value.map(u => u.department).filter(Boolean))];\n      departments.value = depts.map(d => ({\n        label: d,\n        value: d\n      }));\n\n      // Extract unique positions\n      const pos = [...new Set(users.value.map(u => u.position).filter(Boolean))];\n      positions.value = pos.map(p => ({\n        label: p,\n        value: p\n      }));\n    };\n    const editQuota = (user, leaveType) => {\n      editingUser.value = user;\n      editingLeaveType.value = leaveType;\n      currentQuota.value = user[`${leaveType.value}_quota`] || 0;\n      currentRemaining.value = user[`${leaveType.value}_remaining`] || 0;\n      newQuota.value = currentQuota.value;\n      newRemaining.value = currentRemaining.value;\n      showEditQuotaDialog.value = true;\n    };\n    const closeEditDialog = () => {\n      showEditQuotaDialog.value = false;\n      editingUser.value = null;\n      editingLeaveType.value = null;\n      currentQuota.value = 0;\n      currentRemaining.value = 0;\n      newQuota.value = 0;\n      newRemaining.value = 0;\n    };\n    const saveQuota = async () => {\n      if (newQuota.value === currentQuota.value && newRemaining.value === currentRemaining.value) {\n        toast.add({\n          severity: 'info',\n          summary: 'ไม่มีการเปลี่ยนแปลง',\n          detail: 'โควต้าไม่ได้เปลี่ยนแปลง',\n          life: 3000\n        });\n        return;\n      }\n      if (newRemaining.value > newQuota.value) {\n        toast.add({\n          severity: 'error',\n          summary: 'ข้อผิดพลาด',\n          detail: 'โควต้าคงเหลือต้องไม่เกินโควต้าทั้งหมด',\n          life: 3000\n        });\n        return;\n      }\n      saving.value = true;\n      try {\n        await axios.put(`/api/leave/quota/${editingUser.value.id}/${editingLeaveType.value.value}`, {\n          quota: newQuota.value,\n          remaining: newRemaining.value\n        });\n        toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'แก้ไขโควต้าเรียบร้อยแล้ว',\n          life: 3000\n        });\n        closeEditDialog();\n        await loadUsers();\n      } catch (error) {\n        console.error('Save quota error:', error);\n        toast.add({\n          severity: 'error',\n          summary: 'เกิดข้อผิดพลาด',\n          detail: error.response?.data?.error || 'ไม่สามารถแก้ไขโควต้าได้',\n          life: 3000\n        });\n      } finally {\n        saving.value = false;\n      }\n    };\n    const closeAddDialog = () => {\n      showAddLeaveTypeDialog.value = false;\n      newLeaveTypeName.value = '';\n      newLeaveTypeQuota.value = 0;\n    };\n    const addLeaveType = async () => {\n      if (!newLeaveTypeName.value.trim()) {\n        toast.add({\n          severity: 'error',\n          summary: 'ข้อผิดพลาด',\n          detail: 'กรุณากรอกชื่อประเภทการลา',\n          life: 3000\n        });\n        return;\n      }\n      adding.value = true;\n      try {\n        await axios.post('/api/leave/leave-types', {\n          name: newLeaveTypeName.value.trim(),\n          default_quota: newLeaveTypeQuota.value\n        });\n        toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'เพิ่มประเภทการลาใหม่เรียบร้อยแล้ว',\n          life: 3000\n        });\n        closeAddDialog();\n        await loadLeaveTypes();\n        await loadUsers();\n      } catch (error) {\n        console.error('Add leave type error:', error);\n        toast.add({\n          severity: 'error',\n          summary: 'เกิดข้อผิดพลาด',\n          detail: error.response?.data?.error || 'ไม่สามารถเพิ่มประเภทการลาได้',\n          life: 3000\n        });\n      } finally {\n        adding.value = false;\n      }\n    };\n    const confirmDeleteLeaveType = type => {\n      confirm.require({\n        message: `ต้องการลบประเภทการลา \"${type.label}\" ใช่หรือไม่?\\n\\nข้อมูลโควต้าของพนักงานทุกคนจะถูกลบด้วย`,\n        header: 'ยืนยันการลบ',\n        icon: 'pi pi-exclamation-triangle',\n        acceptLabel: 'ลบ',\n        rejectLabel: 'ยกเลิก',\n        acceptClass: 'p-button-danger',\n        accept: () => {\n          deleteLeaveType(type.value);\n        }\n      });\n    };\n    const deleteLeaveType = async leaveType => {\n      try {\n        await axios.delete(`/api/leave/leave-types/${encodeURIComponent(leaveType)}`);\n        toast.add({\n          severity: 'success',\n          summary: 'สำเร็จ',\n          detail: 'ลบประเภทการลาเรียบร้อยแล้ว',\n          life: 3000\n        });\n        await loadLeaveTypes();\n        await loadUsers();\n      } catch (error) {\n        console.error('Delete leave type error:', error);\n        toast.add({\n          severity: 'error',\n          summary: 'เกิดข้อผิดพลาด',\n          detail: error.response?.data?.error || 'ไม่สามารถลบประเภทการลาได้',\n          life: 3000\n        });\n      }\n    };\n    return (_ctx, _cache) => {\n      const _component_Toast = _resolveComponent(\"Toast\");\n      const _component_Button = _resolveComponent(\"Button\");\n      const _component_Card = _resolveComponent(\"Card\");\n      const _component_InputIcon = _resolveComponent(\"InputIcon\");\n      const _component_InputText = _resolveComponent(\"InputText\");\n      const _component_IconField = _resolveComponent(\"IconField\");\n      const _component_Dropdown = _resolveComponent(\"Dropdown\");\n      const _component_Column = _resolveComponent(\"Column\");\n      const _component_Badge = _resolveComponent(\"Badge\");\n      const _component_DataTable = _resolveComponent(\"DataTable\");\n      const _component_Dialog = _resolveComponent(\"Dialog\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_Toast), _createVNode(_component_Card, {\n        class: \"header-card mb-4\"\n      }, {\n        content: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_Button, {\n          icon: \"pi pi-arrow-left\",\n          text: \"\",\n          rounded: \"\",\n          onClick: _cache[0] || (_cache[0] = $event => _ctx.$router.push('/management')),\n          class: \"back-btn\"\n        }), _cache[11] || (_cache[11] = _createElementVNode(\"div\", {\n          class: \"header-title\"\n        }, [_createElementVNode(\"i\", {\n          class: \"pi pi-calendar-times\"\n        }), _createElementVNode(\"h1\", null, \"จัดการการลางาน\")], -1))])]),\n        _: 1\n      }), _createVNode(_component_Card, null, {\n        content: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, [_cache[12] || (_cache[12] = _createElementVNode(\"h3\", null, \"โควต้าการลาของพนักงาน\", -1)), _createVNode(_component_Button, {\n          label: \"เพิ่มประเภทการลา\",\n          icon: \"pi pi-plus\",\n          onClick: _cache[1] || (_cache[1] = $event => showAddLeaveTypeDialog.value = true)\n        })]), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_IconField, {\n          iconPosition: \"left\",\n          class: \"search-field\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_InputIcon, {\n            class: \"pi pi-search\"\n          }), _createVNode(_component_InputText, {\n            modelValue: searchQuery.value,\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => searchQuery.value = $event),\n            placeholder: \"ค้นหาชื่อ, แผนก, ตำแหน่ง...\",\n            class: \"w-full\"\n          }, null, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_Dropdown, {\n          modelValue: selectedDepartment.value,\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => selectedDepartment.value = $event),\n          options: departments.value,\n          optionLabel: \"label\",\n          optionValue: \"value\",\n          placeholder: \"ทุกแผนก\",\n          class: \"filter-dropdown\",\n          showClear: \"\"\n        }, null, 8, [\"modelValue\", \"options\"]), _createVNode(_component_Dropdown, {\n          modelValue: selectedPosition.value,\n          \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => selectedPosition.value = $event),\n          options: positions.value,\n          optionLabel: \"label\",\n          optionValue: \"value\",\n          placeholder: \"ทุกตำแหน่ง\",\n          class: \"filter-dropdown\",\n          showClear: \"\"\n        }, null, 8, [\"modelValue\", \"options\"])]), _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_DataTable, {\n          value: filteredUsers.value,\n          paginator: true,\n          rows: 10,\n          stripedRows: \"\",\n          class: \"p-datatable-sm\",\n          scrollable: \"\",\n          scrollHeight: \"600px\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_Column, {\n            field: \"firstname\",\n            header: \"ชื่อ\",\n            sortable: true,\n            frozen: \"\",\n            style: {\n              \"min-width\": \"150px\"\n            }\n          }, {\n            body: _withCtx(({\n              data\n            }) => [_createTextVNode(_toDisplayString(data.firstname) + \" \" + _toDisplayString(data.lastname), 1)]),\n            _: 1\n          }), _createVNode(_component_Column, {\n            field: \"department\",\n            header: \"แผนก\",\n            sortable: true,\n            frozen: \"\",\n            style: {\n              \"min-width\": \"120px\"\n            }\n          }), _createVNode(_component_Column, {\n            field: \"position\",\n            header: \"ตำแหน่ง\",\n            sortable: true,\n            frozen: \"\",\n            style: {\n              \"min-width\": \"120px\"\n            }\n          }), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(leaveTypes.value, type => {\n            return _openBlock(), _createBlock(_component_Column, {\n              key: type.value,\n              style: {\n                \"min-width\": \"150px\"\n              }\n            }, {\n              header: _withCtx(() => [_createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_Badge, {\n                value: type.label,\n                style: _normalizeStyle({\n                  backgroundColor: type.color,\n                  color: '#fff',\n                  fontWeight: 'bold'\n                })\n              }, null, 8, [\"value\", \"style\"]), _createVNode(_component_Button, {\n                icon: \"pi pi-trash\",\n                size: \"small\",\n                text: \"\",\n                severity: \"danger\",\n                onClick: $event => confirmDeleteLeaveType(type)\n              }, null, 8, [\"onClick\"])])]),\n              body: _withCtx(({\n                data\n              }) => [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_cache[13] || (_cache[13] = _createElementVNode(\"small\", null, \"โควต้า:\", -1)), _createElementVNode(\"span\", _hoisted_9, _toDisplayString(data[`${type.value}_quota`] || 0) + \" วัน\", 1), _createVNode(_component_Button, {\n                icon: \"pi pi-pencil\",\n                size: \"small\",\n                text: \"\",\n                onClick: $event => editQuota(data, type)\n              }, null, 8, [\"onClick\"])]), _createElementVNode(\"small\", _hoisted_10, \"คงเหลือ: \" + _toDisplayString(data[`${type.value}_remaining`] || 0) + \" วัน\", 1)])]),\n              _: 2\n            }, 1024);\n          }), 128))]),\n          _: 1\n        }, 8, [\"value\"])])]),\n        _: 1\n      }), _createVNode(_component_Dialog, {\n        visible: showAddLeaveTypeDialog.value,\n        \"onUpdate:visible\": _cache[7] || (_cache[7] = $event => showAddLeaveTypeDialog.value = $event),\n        header: \"เพิ่มประเภทการลาใหม่\",\n        modal: true,\n        draggable: false,\n        style: {\n          \"width\": \"400px\"\n        }\n      }, {\n        footer: _withCtx(() => [_createVNode(_component_Button, {\n          label: \"ยกเลิก\",\n          icon: \"pi pi-times\",\n          onClick: closeAddDialog,\n          severity: \"secondary\"\n        }), _createVNode(_component_Button, {\n          label: \"เพิ่ม\",\n          icon: \"pi pi-check\",\n          onClick: addLeaveType,\n          loading: adding.value\n        }, null, 8, [\"loading\"])]),\n        default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"div\", _hoisted_12, [_cache[14] || (_cache[14] = _createElementVNode(\"label\", null, \"ชื่อประเภทการลา *\", -1)), _createVNode(_component_InputText, {\n          modelValue: newLeaveTypeName.value,\n          \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => newLeaveTypeName.value = $event),\n          placeholder: \"เช่น ลาบวช, ลาอุปสมบท\",\n          class: \"w-full\"\n        }, null, 8, [\"modelValue\"])]), _createElementVNode(\"div\", _hoisted_13, [_cache[15] || (_cache[15] = _createElementVNode(\"label\", null, \"โควต้าเริ่มต้น (วัน/ปี) *\", -1)), _createVNode(_unref(InputNumber), {\n          modelValue: newLeaveTypeQuota.value,\n          \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => newLeaveTypeQuota.value = $event),\n          min: 0,\n          max: 365,\n          showButtons: \"\",\n          class: \"w-full\"\n        }, null, 8, [\"modelValue\"])])])]),\n        _: 1\n      }, 8, [\"visible\"]), _createVNode(_component_Dialog, {\n        visible: showEditQuotaDialog.value,\n        \"onUpdate:visible\": _cache[10] || (_cache[10] = $event => showEditQuotaDialog.value = $event),\n        header: \"แก้ไขโควต้าการลา\",\n        modal: true,\n        draggable: false,\n        style: {\n          \"width\": \"450px\"\n        }\n      }, {\n        footer: _withCtx(() => [_createVNode(_component_Button, {\n          label: \"ยกเลิก\",\n          icon: \"pi pi-times\",\n          onClick: closeEditDialog,\n          severity: \"secondary\"\n        }), _createVNode(_component_Button, {\n          label: \"บันทึก\",\n          icon: \"pi pi-check\",\n          onClick: saveQuota,\n          loading: saving.value\n        }, null, 8, [\"loading\"])]),\n        default: _withCtx(() => [editingUser.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_cache[16] || (_cache[16] = _createElementVNode(\"i\", {\n          class: \"pi pi-user\"\n        }, null, -1)), _createElementVNode(\"div\", null, [_createElementVNode(\"h4\", null, _toDisplayString(editingUser.value.firstname) + \" \" + _toDisplayString(editingUser.value.lastname), 1), _createElementVNode(\"small\", null, _toDisplayString(editingUser.value.department) + \" - \" + _toDisplayString(editingUser.value.position), 1)])]), _createVNode(_unref(Divider)), _createElementVNode(\"div\", _hoisted_16, [_cache[17] || (_cache[17] = _createElementVNode(\"label\", null, \"ประเภทการลา\", -1)), _createVNode(_component_Badge, {\n          value: editingLeaveType.value?.label,\n          style: _normalizeStyle({\n            backgroundColor: editingLeaveType.value?.color,\n            color: '#fff'\n          })\n        }, null, 8, [\"value\", \"style\"])]), _createElementVNode(\"div\", _hoisted_17, [_cache[18] || (_cache[18] = _createElementVNode(\"label\", null, \"โควต้าทั้งหมด (วัน/ปี) *\", -1)), _createVNode(_unref(InputNumber), {\n          modelValue: newQuota.value,\n          \"onUpdate:modelValue\": _cache[8] || (_cache[8] = $event => newQuota.value = $event),\n          min: 0,\n          max: 365,\n          showButtons: \"\",\n          class: \"w-full\",\n          suffix: \" วัน\"\n        }, null, 8, [\"modelValue\"]), _createElementVNode(\"small\", _hoisted_18, \"ปัจจุบัน: \" + _toDisplayString(currentQuota.value) + \" วัน\", 1)]), _createElementVNode(\"div\", _hoisted_19, [_cache[19] || (_cache[19] = _createElementVNode(\"label\", null, \"โควต้าคงเหลือ (วัน) *\", -1)), _createVNode(_unref(InputNumber), {\n          modelValue: newRemaining.value,\n          \"onUpdate:modelValue\": _cache[9] || (_cache[9] = $event => newRemaining.value = $event),\n          min: 0,\n          max: newQuota.value,\n          showButtons: \"\",\n          class: \"w-full\",\n          suffix: \" วัน\"\n        }, null, 8, [\"modelValue\", \"max\"]), _createElementVNode(\"small\", _hoisted_20, \"ปัจจุบัน: \" + _toDisplayString(currentRemaining.value) + \" วัน\", 1)])])) : _createCommentVNode(\"\", true)]),\n        _: 1\n      }, 8, [\"visible\"])]);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","useToast","useConfirm","axios","InputNumber","Divider","toast","confirm","users","leaveTypes","showAddLeaveTypeDialog","showEditQuotaDialog","adding","saving","newLeaveTypeName","newLeaveTypeQuota","searchQuery","selectedDepartment","selectedPosition","departments","positions","editingUser","editingLeaveType","currentQuota","currentRemaining","newQuota","newRemaining","filteredUsers","filtered","value","query","toLowerCase","filter","user","firstname","includes","lastname","department","position","loadLeaveTypes","loadUsers","response","get","data","error","console","usersRes","Promise","all","map","quotaRes","id","quotaData","userData","leaveType","Object","entries","quota","usedDays","remainingDays","extractFilters","add","severity","summary","detail","life","depts","Set","u","Boolean","d","label","pos","p","editQuota","closeEditDialog","saveQuota","put","remaining","closeAddDialog","addLeaveType","trim","post","name","default_quota","confirmDeleteLeaveType","type","require","message","header","icon","acceptLabel","rejectLabel","acceptClass","accept","deleteLeaveType","delete","encodeURIComponent","_createElementBlock","_hoisted_1","_createVNode","_component_Toast","_component_Card","class","content","_withCtx","_createElementVNode","_hoisted_2","_component_Button","text","rounded","onClick","_cache","$event","_ctx","$router","push","_hoisted_3","_hoisted_4","_component_IconField","iconPosition","_component_InputIcon","_component_InputText","placeholder","_component_Dropdown","options","optionLabel","optionValue","showClear","_hoisted_5","_component_DataTable","paginator","rows","stripedRows","scrollable","scrollHeight","_component_Column","field","sortable","frozen","style","body","_toDisplayString","_Fragment","_renderList","_createBlock","key","_hoisted_6","_component_Badge","_normalizeStyle","backgroundColor","color","fontWeight","size","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_component_Dialog","visible","modal","draggable","footer","loading","_hoisted_11","_hoisted_12","_hoisted_13","_unref","min","max","showButtons","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","suffix","_hoisted_18","_hoisted_19","_hoisted_20"],"sources":["D:/frontend_cem/src/views/management/LeaveManagement.vue","D:\\frontend_cem\\src\\views\\management\\LeaveManagement.vue"],"sourcesContent":["<template>\n  <div class=\"leave-management-container\">\n    <Toast />\n    \n    <!-- Header -->\n    <Card class=\"header-card mb-4\">\n      <template #content>\n        <div class=\"header-content\">\n          <Button icon=\"pi pi-arrow-left\" text rounded @click=\"$router.push('/management')\" class=\"back-btn\" />\n          <div class=\"header-title\">\n            <i class=\"pi pi-calendar-times\"></i>\n            <h1>จัดการการลางาน</h1>\n          </div>\n        </div>\n      </template>\n    </Card>\n\n    <!-- User Leave Quota Table -->\n    <Card>\n      <template #content>\n        <div class=\"table-header\">\n          <h3>โควต้าการลาของพนักงาน</h3>\n          <Button label=\"เพิ่มประเภทการลา\" icon=\"pi pi-plus\" @click=\"showAddLeaveTypeDialog = true\" />\n        </div>\n        \n        <!-- Search and Filter -->\n        <div class=\"filters-section\">\n          <IconField iconPosition=\"left\" class=\"search-field\">\n            <InputIcon class=\"pi pi-search\" />\n            <InputText v-model=\"searchQuery\" placeholder=\"ค้นหาชื่อ, แผนก, ตำแหน่ง...\" class=\"w-full\" />\n          </IconField>\n          \n          <Dropdown v-model=\"selectedDepartment\" :options=\"departments\" optionLabel=\"label\" optionValue=\"value\" \n                    placeholder=\"ทุกแผนก\" class=\"filter-dropdown\" showClear />\n          \n          <Dropdown v-model=\"selectedPosition\" :options=\"positions\" optionLabel=\"label\" optionValue=\"value\" \n                    placeholder=\"ทุกตำแหน่ง\" class=\"filter-dropdown\" showClear />\n        </div>\n        \n        <div class=\"table-wrapper\">\n          <DataTable :value=\"filteredUsers\" :paginator=\"true\" :rows=\"10\" stripedRows class=\"p-datatable-sm\" scrollable scrollHeight=\"600px\">\n            <Column field=\"firstname\" header=\"ชื่อ\" :sortable=\"true\" frozen style=\"min-width: 150px\">\n              <template #body=\"{ data }\">\n                {{ data.firstname }} {{ data.lastname }}\n              </template>\n            </Column>\n            <Column field=\"department\" header=\"แผนก\" :sortable=\"true\" frozen style=\"min-width: 120px\" />\n            <Column field=\"position\" header=\"ตำแหน่ง\" :sortable=\"true\" frozen style=\"min-width: 120px\" />\n            <Column v-for=\"type in leaveTypes\" :key=\"type.value\" style=\"min-width: 150px\">\n              <template #header>\n                <div class=\"leave-type-header\">\n                  <Badge :value=\"type.label\" :style=\"{ backgroundColor: type.color, color: '#fff', fontWeight: 'bold' }\" />\n                  <Button icon=\"pi pi-trash\" size=\"small\" text severity=\"danger\" @click=\"confirmDeleteLeaveType(type)\" />\n                </div>\n              </template>\n              <template #body=\"{ data }\">\n                <div class=\"quota-cell\">\n                  <div class=\"quota-row\">\n                    <small>โควต้า:</small>\n                    <span class=\"quota-value\">{{ data[`${type.value}_quota`] || 0 }} วัน</span>\n                    <Button icon=\"pi pi-pencil\" size=\"small\" text @click=\"editQuota(data, type)\" />\n                  </div>\n                  <small class=\"remaining\">คงเหลือ: {{ data[`${type.value}_remaining`] || 0 }} วัน</small>\n                </div>\n              </template>\n            </Column>\n          </DataTable>\n        </div>\n      </template>\n    </Card>\n\n    <!-- Add Leave Type Dialog -->\n    <Dialog v-model:visible=\"showAddLeaveTypeDialog\" header=\"เพิ่มประเภทการลาใหม่\" :modal=\"true\" :draggable=\"false\" style=\"width: 400px\">\n      <div class=\"leave-type-form\">\n        <div class=\"field\">\n          <label>ชื่อประเภทการลา *</label>\n          <InputText v-model=\"newLeaveTypeName\" placeholder=\"เช่น ลาบวช, ลาอุปสมบท\" class=\"w-full\" />\n        </div>\n        <div class=\"field\">\n          <label>โควต้าเริ่มต้น (วัน/ปี) *</label>\n          <InputNumber v-model=\"newLeaveTypeQuota\" :min=\"0\" :max=\"365\" showButtons class=\"w-full\" />\n        </div>\n      </div>\n      <template #footer>\n        <Button label=\"ยกเลิก\" icon=\"pi pi-times\" @click=\"closeAddDialog\" severity=\"secondary\" />\n        <Button label=\"เพิ่ม\" icon=\"pi pi-check\" @click=\"addLeaveType\" :loading=\"adding\" />\n      </template>\n    </Dialog>\n    \n    <!-- Edit Quota Dialog -->\n    <Dialog v-model:visible=\"showEditQuotaDialog\" header=\"แก้ไขโควต้าการลา\" :modal=\"true\" :draggable=\"false\" style=\"width: 450px\">\n      <div class=\"edit-quota-form\" v-if=\"editingUser\">\n        <div class=\"user-info\">\n          <i class=\"pi pi-user\"></i>\n          <div>\n            <h4>{{ editingUser.firstname }} {{ editingUser.lastname }}</h4>\n            <small>{{ editingUser.department }} - {{ editingUser.position }}</small>\n          </div>\n        </div>\n        \n        <Divider />\n        \n        <div class=\"field\">\n          <label>ประเภทการลา</label>\n          <Badge :value=\"editingLeaveType?.label\" :style=\"{ backgroundColor: editingLeaveType?.color, color: '#fff' }\" />\n        </div>\n        \n        <div class=\"field\">\n          <label>โควต้าทั้งหมด (วัน/ปี) *</label>\n          <InputNumber v-model=\"newQuota\" :min=\"0\" :max=\"365\" showButtons class=\"w-full\" suffix=\" วัน\" />\n          <small class=\"field-hint\">ปัจจุบัน: {{ currentQuota }} วัน</small>\n        </div>\n        \n        <div class=\"field\">\n          <label>โควต้าคงเหลือ (วัน) *</label>\n          <InputNumber v-model=\"newRemaining\" :min=\"0\" :max=\"newQuota\" showButtons class=\"w-full\" suffix=\" วัน\" />\n          <small class=\"field-hint\">ปัจจุบัน: {{ currentRemaining }} วัน</small>\n        </div>\n      </div>\n      <template #footer>\n        <Button label=\"ยกเลิก\" icon=\"pi pi-times\" @click=\"closeEditDialog\" severity=\"secondary\" />\n        <Button label=\"บันทึก\" icon=\"pi pi-check\" @click=\"saveQuota\" :loading=\"saving\" />\n      </template>\n    </Dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed } from 'vue'\nimport { useToast } from 'primevue/usetoast'\nimport { useConfirm } from 'primevue/useconfirm'\nimport axios from '@/utils/axiosConfig'\nimport InputNumber from 'primevue/inputnumber'\nimport Divider from 'primevue/divider'\n\nconst toast = useToast()\nconst confirm = useConfirm()\nconst users = ref([])\nconst leaveTypes = ref([])\nconst showAddLeaveTypeDialog = ref(false)\nconst showEditQuotaDialog = ref(false)\nconst adding = ref(false)\nconst saving = ref(false)\nconst newLeaveTypeName = ref('')\nconst newLeaveTypeQuota = ref(0)\n\n// Filter states\nconst searchQuery = ref('')\nconst selectedDepartment = ref(null)\nconst selectedPosition = ref(null)\nconst departments = ref([])\nconst positions = ref([])\n\n// Edit quota states\nconst editingUser = ref(null)\nconst editingLeaveType = ref(null)\nconst currentQuota = ref(0)\nconst currentRemaining = ref(0)\nconst newQuota = ref(0)\nconst newRemaining = ref(0)\n\n// Computed filtered users\nconst filteredUsers = computed(() => {\n  let filtered = users.value\n\n  // Search filter\n  if (searchQuery.value) {\n    const query = searchQuery.value.toLowerCase()\n    filtered = filtered.filter(user => \n      user.firstname?.toLowerCase().includes(query) ||\n      user.lastname?.toLowerCase().includes(query) ||\n      user.department?.toLowerCase().includes(query) ||\n      user.position?.toLowerCase().includes(query)\n    )\n  }\n\n  // Department filter\n  if (selectedDepartment.value) {\n    filtered = filtered.filter(user => user.department === selectedDepartment.value)\n  }\n\n  // Position filter\n  if (selectedPosition.value) {\n    filtered = filtered.filter(user => user.position === selectedPosition.value)\n  }\n\n  return filtered\n})\n\nonMounted(() => {\n  loadLeaveTypes()\n  loadUsers()\n})\n\nconst loadLeaveTypes = async () => {\n  try {\n    const response = await axios.get('/api/leave/leave-types')\n    leaveTypes.value = response.data\n  } catch (error) {\n    console.error('Error loading leave types:', error)\n  }\n}\n\nconst loadUsers = async () => {\n  try {\n    const usersRes = await axios.get('/api/users')\n    \n    users.value = await Promise.all(usersRes.data.map(async (user) => {\n      try {\n        const quotaRes = await axios.get(`/api/leave/quota/${user.id}`)\n        const quotaData = quotaRes.data\n        \n        const userData = { ...user }\n        \n        // Add quota data for each leave type dynamically\n        for (const [leaveType, data] of Object.entries(quotaData)) {\n          userData[`${leaveType}_quota`] = data?.quota || 0\n          userData[`${leaveType}_used`] = data?.usedDays || 0\n          userData[`${leaveType}_remaining`] = data?.remainingDays || 0\n        }\n        \n        return userData\n      } catch (error) {\n        console.error(`Error loading quota for user ${user.id}:`, error)\n        return { ...user }\n      }\n    }))\n    \n    // Extract unique departments and positions\n    extractFilters()\n  } catch (error) {\n    toast.add({\n      severity: 'error',\n      summary: 'เกิดข้อผิดพลาด',\n      detail: 'ไม่สามารถโหลดข้อมูลได้',\n      life: 3000\n    })\n  }\n}\n\nconst extractFilters = () => {\n  // Extract unique departments\n  const depts = [...new Set(users.value.map(u => u.department).filter(Boolean))]\n  departments.value = depts.map(d => ({ label: d, value: d }))\n  \n  // Extract unique positions\n  const pos = [...new Set(users.value.map(u => u.position).filter(Boolean))]\n  positions.value = pos.map(p => ({ label: p, value: p }))\n}\n\nconst editQuota = (user, leaveType) => {\n  editingUser.value = user\n  editingLeaveType.value = leaveType\n  currentQuota.value = user[`${leaveType.value}_quota`] || 0\n  currentRemaining.value = user[`${leaveType.value}_remaining`] || 0\n  newQuota.value = currentQuota.value\n  newRemaining.value = currentRemaining.value\n  showEditQuotaDialog.value = true\n}\n\nconst closeEditDialog = () => {\n  showEditQuotaDialog.value = false\n  editingUser.value = null\n  editingLeaveType.value = null\n  currentQuota.value = 0\n  currentRemaining.value = 0\n  newQuota.value = 0\n  newRemaining.value = 0\n}\n\nconst saveQuota = async () => {\n  if (newQuota.value === currentQuota.value && newRemaining.value === currentRemaining.value) {\n    toast.add({\n      severity: 'info',\n      summary: 'ไม่มีการเปลี่ยนแปลง',\n      detail: 'โควต้าไม่ได้เปลี่ยนแปลง',\n      life: 3000\n    })\n    return\n  }\n\n  if (newRemaining.value > newQuota.value) {\n    toast.add({\n      severity: 'error',\n      summary: 'ข้อผิดพลาด',\n      detail: 'โควต้าคงเหลือต้องไม่เกินโควต้าทั้งหมด',\n      life: 3000\n    })\n    return\n  }\n\n  saving.value = true\n  try {\n    await axios.put(`/api/leave/quota/${editingUser.value.id}/${editingLeaveType.value.value}`, {\n      quota: newQuota.value,\n      remaining: newRemaining.value\n    })\n\n    toast.add({\n      severity: 'success',\n      summary: 'สำเร็จ',\n      detail: 'แก้ไขโควต้าเรียบร้อยแล้ว',\n      life: 3000\n    })\n\n    closeEditDialog()\n    await loadUsers()\n  } catch (error) {\n    console.error('Save quota error:', error)\n    toast.add({\n      severity: 'error',\n      summary: 'เกิดข้อผิดพลาด',\n      detail: error.response?.data?.error || 'ไม่สามารถแก้ไขโควต้าได้',\n      life: 3000\n    })\n  } finally {\n    saving.value = false\n  }\n}\n\nconst closeAddDialog = () => {\n  showAddLeaveTypeDialog.value = false\n  newLeaveTypeName.value = ''\n  newLeaveTypeQuota.value = 0\n}\n\nconst addLeaveType = async () => {\n  if (!newLeaveTypeName.value.trim()) {\n    toast.add({\n      severity: 'error',\n      summary: 'ข้อผิดพลาด',\n      detail: 'กรุณากรอกชื่อประเภทการลา',\n      life: 3000\n    })\n    return\n  }\n\n  adding.value = true\n  try {\n    await axios.post('/api/leave/leave-types', {\n      name: newLeaveTypeName.value.trim(),\n      default_quota: newLeaveTypeQuota.value\n    })\n\n    toast.add({\n      severity: 'success',\n      summary: 'สำเร็จ',\n      detail: 'เพิ่มประเภทการลาใหม่เรียบร้อยแล้ว',\n      life: 3000\n    })\n\n    closeAddDialog()\n    await loadLeaveTypes()\n    await loadUsers()\n  } catch (error) {\n    console.error('Add leave type error:', error)\n    toast.add({\n      severity: 'error',\n      summary: 'เกิดข้อผิดพลาด',\n      detail: error.response?.data?.error || 'ไม่สามารถเพิ่มประเภทการลาได้',\n      life: 3000\n    })\n  } finally {\n    adding.value = false\n  }\n}\n\nconst confirmDeleteLeaveType = (type) => {\n  confirm.require({\n    message: `ต้องการลบประเภทการลา \"${type.label}\" ใช่หรือไม่?\\n\\nข้อมูลโควต้าของพนักงานทุกคนจะถูกลบด้วย`,\n    header: 'ยืนยันการลบ',\n    icon: 'pi pi-exclamation-triangle',\n    acceptLabel: 'ลบ',\n    rejectLabel: 'ยกเลิก',\n    acceptClass: 'p-button-danger',\n    accept: () => {\n      deleteLeaveType(type.value)\n    }\n  })\n}\n\nconst deleteLeaveType = async (leaveType) => {\n  try {\n    await axios.delete(`/api/leave/leave-types/${encodeURIComponent(leaveType)}`)\n\n    toast.add({\n      severity: 'success',\n      summary: 'สำเร็จ',\n      detail: 'ลบประเภทการลาเรียบร้อยแล้ว',\n      life: 3000\n    })\n\n    await loadLeaveTypes()\n    await loadUsers()\n  } catch (error) {\n    console.error('Delete leave type error:', error)\n    toast.add({\n      severity: 'error',\n      summary: 'เกิดข้อผิดพลาด',\n      detail: error.response?.data?.error || 'ไม่สามารถลบประเภทการลาได้',\n      life: 3000\n    })\n  }\n}\n</script>\n\n<style scoped>\n.leave-management-container {\n  padding: 1rem;\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n.header-card {\n  background: linear-gradient(135deg, #4A90E2, #D73527);\n  color: white;\n  border: none;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.header-content {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n}\n\n.back-btn {\n  color: white !important;\n}\n\n.header-title {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n\n.header-title i {\n  font-size: 1.5rem;\n}\n\n.header-title h1 {\n  margin: 0;\n  font-size: 1.5rem;\n  font-weight: 600;\n}\n\n.table-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n}\n\n.table-header h3 {\n  margin: 0;\n  color: #2c3e50;\n}\n\n.filters-section {\n  display: grid;\n  grid-template-columns: 2fr 1fr 1fr;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n}\n\n.search-field {\n  width: 100%;\n}\n\n.filter-dropdown {\n  width: 100%;\n}\n\n.table-wrapper {\n  overflow-x: auto;\n}\n\n.leave-type-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n}\n\n.quota-cell {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.quota-row {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.quota-row small {\n  font-size: 0.85rem;\n  color: #6c757d;\n  min-width: 60px;\n}\n\n.quota-value {\n  font-weight: 600;\n  color: #2c3e50;\n  font-size: 0.9rem;\n}\n\n.remaining {\n  font-size: 0.85rem;\n  color: #6c757d;\n  padding-left: 60px;\n}\n\n.edit-quota-form {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem 0;\n}\n\n.edit-quota-form .field {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.edit-quota-form label {\n  font-weight: 600;\n  color: #2c3e50;\n}\n\n.field-hint {\n  color: #6c757d;\n  font-size: 0.85rem;\n  margin-top: 0.25rem;\n}\n\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n  background: #f8f9fa;\n  border-radius: 8px;\n}\n\n.user-info i {\n  font-size: 2rem;\n  color: #4A90E2;\n}\n\n.user-info h4 {\n  margin: 0;\n  color: #2c3e50;\n  font-size: 1.1rem;\n}\n\n.user-info small {\n  color: #6c757d;\n}\n\n.leave-type-form {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem 0;\n}\n\n.leave-type-form .field {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.leave-type-form label {\n  font-weight: 600;\n  color: #2c3e50;\n}\n\n.leave-type-form small {\n  color: #6c757d;\n  font-size: 0.8rem;\n}\n\n.quota-cell {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.quota-cell small {\n  font-size: 0.85rem;\n  color: #6c757d;\n}\n\n@media (max-width: 768px) {\n  .leave-management-container {\n    padding: 0.5rem;\n  }\n\n  .table-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 1rem;\n  }\n\n  .table-header button {\n    width: 100%;\n  }\n  \n  .filters-section {\n    grid-template-columns: 1fr;\n  }\n}\n</style>\n","<template>\n  <div class=\"leave-management-container\">\n    <Toast />\n    \n    <!-- Header -->\n    <Card class=\"header-card mb-4\">\n      <template #content>\n        <div class=\"header-content\">\n          <Button icon=\"pi pi-arrow-left\" text rounded @click=\"$router.push('/management')\" class=\"back-btn\" />\n          <div class=\"header-title\">\n            <i class=\"pi pi-calendar-times\"></i>\n            <h1>จัดการการลางาน</h1>\n          </div>\n        </div>\n      </template>\n    </Card>\n\n    <!-- User Leave Quota Table -->\n    <Card>\n      <template #content>\n        <div class=\"table-header\">\n          <h3>โควต้าการลาของพนักงาน</h3>\n          <Button label=\"เพิ่มประเภทการลา\" icon=\"pi pi-plus\" @click=\"showAddLeaveTypeDialog = true\" />\n        </div>\n        \n        <!-- Search and Filter -->\n        <div class=\"filters-section\">\n          <IconField iconPosition=\"left\" class=\"search-field\">\n            <InputIcon class=\"pi pi-search\" />\n            <InputText v-model=\"searchQuery\" placeholder=\"ค้นหาชื่อ, แผนก, ตำแหน่ง...\" class=\"w-full\" />\n          </IconField>\n          \n          <Dropdown v-model=\"selectedDepartment\" :options=\"departments\" optionLabel=\"label\" optionValue=\"value\" \n                    placeholder=\"ทุกแผนก\" class=\"filter-dropdown\" showClear />\n          \n          <Dropdown v-model=\"selectedPosition\" :options=\"positions\" optionLabel=\"label\" optionValue=\"value\" \n                    placeholder=\"ทุกตำแหน่ง\" class=\"filter-dropdown\" showClear />\n        </div>\n        \n        <div class=\"table-wrapper\">\n          <DataTable :value=\"filteredUsers\" :paginator=\"true\" :rows=\"10\" stripedRows class=\"p-datatable-sm\" scrollable scrollHeight=\"600px\">\n            <Column field=\"firstname\" header=\"ชื่อ\" :sortable=\"true\" frozen style=\"min-width: 150px\">\n              <template #body=\"{ data }\">\n                {{ data.firstname }} {{ data.lastname }}\n              </template>\n            </Column>\n            <Column field=\"department\" header=\"แผนก\" :sortable=\"true\" frozen style=\"min-width: 120px\" />\n            <Column field=\"position\" header=\"ตำแหน่ง\" :sortable=\"true\" frozen style=\"min-width: 120px\" />\n            <Column v-for=\"type in leaveTypes\" :key=\"type.value\" style=\"min-width: 150px\">\n              <template #header>\n                <div class=\"leave-type-header\">\n                  <Badge :value=\"type.label\" :style=\"{ backgroundColor: type.color, color: '#fff', fontWeight: 'bold' }\" />\n                  <Button icon=\"pi pi-trash\" size=\"small\" text severity=\"danger\" @click=\"confirmDeleteLeaveType(type)\" />\n                </div>\n              </template>\n              <template #body=\"{ data }\">\n                <div class=\"quota-cell\">\n                  <div class=\"quota-row\">\n                    <small>โควต้า:</small>\n                    <span class=\"quota-value\">{{ data[`${type.value}_quota`] || 0 }} วัน</span>\n                    <Button icon=\"pi pi-pencil\" size=\"small\" text @click=\"editQuota(data, type)\" />\n                  </div>\n                  <small class=\"remaining\">คงเหลือ: {{ data[`${type.value}_remaining`] || 0 }} วัน</small>\n                </div>\n              </template>\n            </Column>\n          </DataTable>\n        </div>\n      </template>\n    </Card>\n\n    <!-- Add Leave Type Dialog -->\n    <Dialog v-model:visible=\"showAddLeaveTypeDialog\" header=\"เพิ่มประเภทการลาใหม่\" :modal=\"true\" :draggable=\"false\" style=\"width: 400px\">\n      <div class=\"leave-type-form\">\n        <div class=\"field\">\n          <label>ชื่อประเภทการลา *</label>\n          <InputText v-model=\"newLeaveTypeName\" placeholder=\"เช่น ลาบวช, ลาอุปสมบท\" class=\"w-full\" />\n        </div>\n        <div class=\"field\">\n          <label>โควต้าเริ่มต้น (วัน/ปี) *</label>\n          <InputNumber v-model=\"newLeaveTypeQuota\" :min=\"0\" :max=\"365\" showButtons class=\"w-full\" />\n        </div>\n      </div>\n      <template #footer>\n        <Button label=\"ยกเลิก\" icon=\"pi pi-times\" @click=\"closeAddDialog\" severity=\"secondary\" />\n        <Button label=\"เพิ่ม\" icon=\"pi pi-check\" @click=\"addLeaveType\" :loading=\"adding\" />\n      </template>\n    </Dialog>\n    \n    <!-- Edit Quota Dialog -->\n    <Dialog v-model:visible=\"showEditQuotaDialog\" header=\"แก้ไขโควต้าการลา\" :modal=\"true\" :draggable=\"false\" style=\"width: 450px\">\n      <div class=\"edit-quota-form\" v-if=\"editingUser\">\n        <div class=\"user-info\">\n          <i class=\"pi pi-user\"></i>\n          <div>\n            <h4>{{ editingUser.firstname }} {{ editingUser.lastname }}</h4>\n            <small>{{ editingUser.department }} - {{ editingUser.position }}</small>\n          </div>\n        </div>\n        \n        <Divider />\n        \n        <div class=\"field\">\n          <label>ประเภทการลา</label>\n          <Badge :value=\"editingLeaveType?.label\" :style=\"{ backgroundColor: editingLeaveType?.color, color: '#fff' }\" />\n        </div>\n        \n        <div class=\"field\">\n          <label>โควต้าทั้งหมด (วัน/ปี) *</label>\n          <InputNumber v-model=\"newQuota\" :min=\"0\" :max=\"365\" showButtons class=\"w-full\" suffix=\" วัน\" />\n          <small class=\"field-hint\">ปัจจุบัน: {{ currentQuota }} วัน</small>\n        </div>\n        \n        <div class=\"field\">\n          <label>โควต้าคงเหลือ (วัน) *</label>\n          <InputNumber v-model=\"newRemaining\" :min=\"0\" :max=\"newQuota\" showButtons class=\"w-full\" suffix=\" วัน\" />\n          <small class=\"field-hint\">ปัจจุบัน: {{ currentRemaining }} วัน</small>\n        </div>\n      </div>\n      <template #footer>\n        <Button label=\"ยกเลิก\" icon=\"pi pi-times\" @click=\"closeEditDialog\" severity=\"secondary\" />\n        <Button label=\"บันทึก\" icon=\"pi pi-check\" @click=\"saveQuota\" :loading=\"saving\" />\n      </template>\n    </Dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed } from 'vue'\nimport { useToast } from 'primevue/usetoast'\nimport { useConfirm } from 'primevue/useconfirm'\nimport axios from '@/utils/axiosConfig'\nimport InputNumber from 'primevue/inputnumber'\nimport Divider from 'primevue/divider'\n\nconst toast = useToast()\nconst confirm = useConfirm()\nconst users = ref([])\nconst leaveTypes = ref([])\nconst showAddLeaveTypeDialog = ref(false)\nconst showEditQuotaDialog = ref(false)\nconst adding = ref(false)\nconst saving = ref(false)\nconst newLeaveTypeName = ref('')\nconst newLeaveTypeQuota = ref(0)\n\n// Filter states\nconst searchQuery = ref('')\nconst selectedDepartment = ref(null)\nconst selectedPosition = ref(null)\nconst departments = ref([])\nconst positions = ref([])\n\n// Edit quota states\nconst editingUser = ref(null)\nconst editingLeaveType = ref(null)\nconst currentQuota = ref(0)\nconst currentRemaining = ref(0)\nconst newQuota = ref(0)\nconst newRemaining = ref(0)\n\n// Computed filtered users\nconst filteredUsers = computed(() => {\n  let filtered = users.value\n\n  // Search filter\n  if (searchQuery.value) {\n    const query = searchQuery.value.toLowerCase()\n    filtered = filtered.filter(user => \n      user.firstname?.toLowerCase().includes(query) ||\n      user.lastname?.toLowerCase().includes(query) ||\n      user.department?.toLowerCase().includes(query) ||\n      user.position?.toLowerCase().includes(query)\n    )\n  }\n\n  // Department filter\n  if (selectedDepartment.value) {\n    filtered = filtered.filter(user => user.department === selectedDepartment.value)\n  }\n\n  // Position filter\n  if (selectedPosition.value) {\n    filtered = filtered.filter(user => user.position === selectedPosition.value)\n  }\n\n  return filtered\n})\n\nonMounted(() => {\n  loadLeaveTypes()\n  loadUsers()\n})\n\nconst loadLeaveTypes = async () => {\n  try {\n    const response = await axios.get('/api/leave/leave-types')\n    leaveTypes.value = response.data\n  } catch (error) {\n    console.error('Error loading leave types:', error)\n  }\n}\n\nconst loadUsers = async () => {\n  try {\n    const usersRes = await axios.get('/api/users')\n    \n    users.value = await Promise.all(usersRes.data.map(async (user) => {\n      try {\n        const quotaRes = await axios.get(`/api/leave/quota/${user.id}`)\n        const quotaData = quotaRes.data\n        \n        const userData = { ...user }\n        \n        // Add quota data for each leave type dynamically\n        for (const [leaveType, data] of Object.entries(quotaData)) {\n          userData[`${leaveType}_quota`] = data?.quota || 0\n          userData[`${leaveType}_used`] = data?.usedDays || 0\n          userData[`${leaveType}_remaining`] = data?.remainingDays || 0\n        }\n        \n        return userData\n      } catch (error) {\n        console.error(`Error loading quota for user ${user.id}:`, error)\n        return { ...user }\n      }\n    }))\n    \n    // Extract unique departments and positions\n    extractFilters()\n  } catch (error) {\n    toast.add({\n      severity: 'error',\n      summary: 'เกิดข้อผิดพลาด',\n      detail: 'ไม่สามารถโหลดข้อมูลได้',\n      life: 3000\n    })\n  }\n}\n\nconst extractFilters = () => {\n  // Extract unique departments\n  const depts = [...new Set(users.value.map(u => u.department).filter(Boolean))]\n  departments.value = depts.map(d => ({ label: d, value: d }))\n  \n  // Extract unique positions\n  const pos = [...new Set(users.value.map(u => u.position).filter(Boolean))]\n  positions.value = pos.map(p => ({ label: p, value: p }))\n}\n\nconst editQuota = (user, leaveType) => {\n  editingUser.value = user\n  editingLeaveType.value = leaveType\n  currentQuota.value = user[`${leaveType.value}_quota`] || 0\n  currentRemaining.value = user[`${leaveType.value}_remaining`] || 0\n  newQuota.value = currentQuota.value\n  newRemaining.value = currentRemaining.value\n  showEditQuotaDialog.value = true\n}\n\nconst closeEditDialog = () => {\n  showEditQuotaDialog.value = false\n  editingUser.value = null\n  editingLeaveType.value = null\n  currentQuota.value = 0\n  currentRemaining.value = 0\n  newQuota.value = 0\n  newRemaining.value = 0\n}\n\nconst saveQuota = async () => {\n  if (newQuota.value === currentQuota.value && newRemaining.value === currentRemaining.value) {\n    toast.add({\n      severity: 'info',\n      summary: 'ไม่มีการเปลี่ยนแปลง',\n      detail: 'โควต้าไม่ได้เปลี่ยนแปลง',\n      life: 3000\n    })\n    return\n  }\n\n  if (newRemaining.value > newQuota.value) {\n    toast.add({\n      severity: 'error',\n      summary: 'ข้อผิดพลาด',\n      detail: 'โควต้าคงเหลือต้องไม่เกินโควต้าทั้งหมด',\n      life: 3000\n    })\n    return\n  }\n\n  saving.value = true\n  try {\n    await axios.put(`/api/leave/quota/${editingUser.value.id}/${editingLeaveType.value.value}`, {\n      quota: newQuota.value,\n      remaining: newRemaining.value\n    })\n\n    toast.add({\n      severity: 'success',\n      summary: 'สำเร็จ',\n      detail: 'แก้ไขโควต้าเรียบร้อยแล้ว',\n      life: 3000\n    })\n\n    closeEditDialog()\n    await loadUsers()\n  } catch (error) {\n    console.error('Save quota error:', error)\n    toast.add({\n      severity: 'error',\n      summary: 'เกิดข้อผิดพลาด',\n      detail: error.response?.data?.error || 'ไม่สามารถแก้ไขโควต้าได้',\n      life: 3000\n    })\n  } finally {\n    saving.value = false\n  }\n}\n\nconst closeAddDialog = () => {\n  showAddLeaveTypeDialog.value = false\n  newLeaveTypeName.value = ''\n  newLeaveTypeQuota.value = 0\n}\n\nconst addLeaveType = async () => {\n  if (!newLeaveTypeName.value.trim()) {\n    toast.add({\n      severity: 'error',\n      summary: 'ข้อผิดพลาด',\n      detail: 'กรุณากรอกชื่อประเภทการลา',\n      life: 3000\n    })\n    return\n  }\n\n  adding.value = true\n  try {\n    await axios.post('/api/leave/leave-types', {\n      name: newLeaveTypeName.value.trim(),\n      default_quota: newLeaveTypeQuota.value\n    })\n\n    toast.add({\n      severity: 'success',\n      summary: 'สำเร็จ',\n      detail: 'เพิ่มประเภทการลาใหม่เรียบร้อยแล้ว',\n      life: 3000\n    })\n\n    closeAddDialog()\n    await loadLeaveTypes()\n    await loadUsers()\n  } catch (error) {\n    console.error('Add leave type error:', error)\n    toast.add({\n      severity: 'error',\n      summary: 'เกิดข้อผิดพลาด',\n      detail: error.response?.data?.error || 'ไม่สามารถเพิ่มประเภทการลาได้',\n      life: 3000\n    })\n  } finally {\n    adding.value = false\n  }\n}\n\nconst confirmDeleteLeaveType = (type) => {\n  confirm.require({\n    message: `ต้องการลบประเภทการลา \"${type.label}\" ใช่หรือไม่?\\n\\nข้อมูลโควต้าของพนักงานทุกคนจะถูกลบด้วย`,\n    header: 'ยืนยันการลบ',\n    icon: 'pi pi-exclamation-triangle',\n    acceptLabel: 'ลบ',\n    rejectLabel: 'ยกเลิก',\n    acceptClass: 'p-button-danger',\n    accept: () => {\n      deleteLeaveType(type.value)\n    }\n  })\n}\n\nconst deleteLeaveType = async (leaveType) => {\n  try {\n    await axios.delete(`/api/leave/leave-types/${encodeURIComponent(leaveType)}`)\n\n    toast.add({\n      severity: 'success',\n      summary: 'สำเร็จ',\n      detail: 'ลบประเภทการลาเรียบร้อยแล้ว',\n      life: 3000\n    })\n\n    await loadLeaveTypes()\n    await loadUsers()\n  } catch (error) {\n    console.error('Delete leave type error:', error)\n    toast.add({\n      severity: 'error',\n      summary: 'เกิดข้อผิดพลาด',\n      detail: error.response?.data?.error || 'ไม่สามารถลบประเภทการลาได้',\n      life: 3000\n    })\n  }\n}\n</script>\n\n<style scoped>\n.leave-management-container {\n  padding: 1rem;\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n.header-card {\n  background: linear-gradient(135deg, #4A90E2, #D73527);\n  color: white;\n  border: none;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.header-content {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n}\n\n.back-btn {\n  color: white !important;\n}\n\n.header-title {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n\n.header-title i {\n  font-size: 1.5rem;\n}\n\n.header-title h1 {\n  margin: 0;\n  font-size: 1.5rem;\n  font-weight: 600;\n}\n\n.table-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n}\n\n.table-header h3 {\n  margin: 0;\n  color: #2c3e50;\n}\n\n.filters-section {\n  display: grid;\n  grid-template-columns: 2fr 1fr 1fr;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n}\n\n.search-field {\n  width: 100%;\n}\n\n.filter-dropdown {\n  width: 100%;\n}\n\n.table-wrapper {\n  overflow-x: auto;\n}\n\n.leave-type-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n}\n\n.quota-cell {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.quota-row {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.quota-row small {\n  font-size: 0.85rem;\n  color: #6c757d;\n  min-width: 60px;\n}\n\n.quota-value {\n  font-weight: 600;\n  color: #2c3e50;\n  font-size: 0.9rem;\n}\n\n.remaining {\n  font-size: 0.85rem;\n  color: #6c757d;\n  padding-left: 60px;\n}\n\n.edit-quota-form {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem 0;\n}\n\n.edit-quota-form .field {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.edit-quota-form label {\n  font-weight: 600;\n  color: #2c3e50;\n}\n\n.field-hint {\n  color: #6c757d;\n  font-size: 0.85rem;\n  margin-top: 0.25rem;\n}\n\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n  background: #f8f9fa;\n  border-radius: 8px;\n}\n\n.user-info i {\n  font-size: 2rem;\n  color: #4A90E2;\n}\n\n.user-info h4 {\n  margin: 0;\n  color: #2c3e50;\n  font-size: 1.1rem;\n}\n\n.user-info small {\n  color: #6c757d;\n}\n\n.leave-type-form {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem 0;\n}\n\n.leave-type-form .field {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.leave-type-form label {\n  font-weight: 600;\n  color: #2c3e50;\n}\n\n.leave-type-form small {\n  color: #6c757d;\n  font-size: 0.8rem;\n}\n\n.quota-cell {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.quota-cell small {\n  font-size: 0.85rem;\n  color: #6c757d;\n}\n\n@media (max-width: 768px) {\n  .leave-management-container {\n    padding: 0.5rem;\n  }\n\n  .table-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 1rem;\n  }\n\n  .table-header button {\n    width: 100%;\n  }\n  \n  .filters-section {\n    grid-template-columns: 1fr;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}