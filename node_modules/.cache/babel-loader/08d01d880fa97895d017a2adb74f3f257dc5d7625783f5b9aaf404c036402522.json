{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, Fragment as _Fragment } from \"vue\";\nimport _imports_0 from '../assets/images/mobile.png';\nconst _hoisted_1 = {\n  class: \"\",\n  style: {\n    \"margin-top\": \"calc(5vh)\"\n  }\n};\nconst _hoisted_2 = {\n  class: \"row justify-content-center\"\n};\nconst _hoisted_3 = {\n  class: \"col-12 justify-content-center\"\n};\nconst _hoisted_4 = {\n  key: 0\n};\nconst _hoisted_5 = {\n  class: \"row justify-content-center\"\n};\nconst _hoisted_6 = {\n  class: \"col-2 justify-content-center\",\n  style: {\n    \"text-align\": \"center\"\n  }\n};\nconst _hoisted_7 = [\"src\"];\nconst _hoisted_8 = {\n  class: \"row justify-content-center mt-5\"\n};\nconst _hoisted_9 = {\n  class: \"col-4\"\n};\nconst _hoisted_10 = {\n  class: \"row justify-content-center mt-5\"\n};\nconst _hoisted_11 = {\n  class: \"col-4\"\n};\nconst _hoisted_12 = {\n  key: 1\n};\nconst _hoisted_13 = {\n  class: \"row justify-content-center mt-5\"\n};\nconst _hoisted_14 = {\n  class: \"col-4 justify-content-center text-center\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Toast = _resolveComponent(\"Toast\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_Toast), _createCommentVNode(\" <div class=\\\"\\\" style=\\\"margin-top: calc(20vh)\\\">\\n    <div class=\\\"row justify-content-center\\\">\\n      <div class=\\\"col-11 col-sm-8 col-md-6 col-xl-3 justify-content-center\\\">\\n        <div class=\\\"card\\\">\\n          <div class=\\\"card-header\\\">\\n            <h3 class=\\\"text-center\\\">ระบบยืนยันตัวตน 2 ขั้นตอน</h3>\\n          </div>\\n          <div class=\\\"card-body\\\">\\n            <form @submit.prevent=\\\"handleLogin\\\">\\n              <div class=\\\" mt-3 pt-3\\\">\\n                <FloatLabel>\\n                  <InputText type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"username\\\" v-model=\\\"username\\\" :invalid=\\\"isUserValid\\\" />\\n                  <label for=\\\"username\\\">ชื่อผู้ใช้</label>\\n                </FloatLabel>\\n              </div>\\n              <div class=\\\" mt-3 pt-3\\\">\\n                <FloatLabel>\\n                  <Password v-model=\\\"password\\\" :feedback=\\\"false\\\" id=\\\"password\\\" toggle-mask=\\\"\\\" :invalid=\\\"isPasswordValid\\\"\\n                    class=\\\" w-100\\\" />\\n                  <label for=\\\"password\\\">รหัสผ่าน</label>\\n                </FloatLabel>\\n              </div>\\n              <div style=\\\"text-align: center;\\\">\\n                <button type=\\\"submit\\\" class=\\\"btn btn-primary btn-block mt-4 w-100\\\">เข้าสู่ระบบ</button>\\n              </div>\\n            </form>\\n          </div>\\n        </div>\\n      </div>\\n    </div>\\n  </div> \"), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_cache[9] || (_cache[9] = _createElementVNode(\"h2\", {\n    class: \"text-center\"\n  }, \"ระบบยืนยันตัวตน 2 ขั้นตอน\", -1 /* CACHED */)), _cache[10] || (_cache[10] = _createElementVNode(\"h3\", {\n    class: \"text-center\"\n  }, \"โปรดใช้แอพ Microsoft Authenticator หรือ Google Authenticator เพื่อยืนยันตัวตนกับบัญชีของคุณ\", -1 /* CACHED */)), $setup.twofa !== null && $setup.twofa == 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_cache[5] || (_cache[5] = _createElementVNode(\"div\", {\n    class: \"row justify-content-center mt-5\"\n  }, [_createElementVNode(\"div\", {\n    class: \"col-4\"\n  }, [_createElementVNode(\"h4\", null, [_createElementVNode(\"b\", null, \"ขั้นตอนที่ 1: เชื่อมต่อ Authenticator เข้ากับบัญชี\")]), _createElementVNode(\"h5\", null, \"ทางเลือกที่ 1: เปิดแอพ เลือกเพิ่มบัญชีด้วยการสแกน QR Code และสแกน QR Code ด้านล่างนี้\")])], -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"img\", {\n    class: \"justify-content-center\",\n    src: $setup.qrcode,\n    style: {\n      \"width\": \"70%\",\n      \"height\": \"auto\"\n    }\n  }, null, 8 /* PROPS */, _hoisted_7)])]), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_cache[2] || (_cache[2] = _createElementVNode(\"h5\", null, \"ทางเลือกที่ 2: เปิดแอพ เลือกเพิ่มบัญชีด้วยการกรอก key และกรอก key ที่อยู่ด้านล่างนี้\", -1 /* CACHED */)), _createElementVNode(\"h5\", null, \"Key: \" + _toDisplayString($setup.secret), 1 /* TEXT */)])]), _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleLogin, [\"prevent\"])\n  }, [_createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [_cache[3] || (_cache[3] = _createElementVNode(\"h4\", null, [_createElementVNode(\"b\", null, \"ขั้นตอนที่ 2: กรอกหมายเลขที่ได้รับจาก Authenticator ใส่ลงในช่องด้านล่าง\")], -1 /* CACHED */)), _createCommentVNode(\" <FloatLabel> \"), _createVNode($setup[\"InputText\"], {\n    modelValue: $setup.code,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.code = $event),\n    feedback: false,\n    id: \"password\",\n    \"toggle-mask\": \"\",\n    placeholder: \"Authentication code\"\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _cache[4] || (_cache[4] = _createElementVNode(\"div\", {\n    class: \"row\"\n  }, [_createElementVNode(\"div\", {\n    class: \"col-4\"\n  }, [_createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-primary btn-block mt-3\"\n  }, \"ยืนยัน\")])], -1 /* CACHED */)), _createCommentVNode(\" </FloatLabel> \")])])], 32 /* NEED_HYDRATION */)])) : _createCommentVNode(\"v-if\", true), $setup.twofa !== null && $setup.twofa == 1 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [_createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleLogin, [\"prevent\"])\n  }, [_createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_cache[6] || (_cache[6] = _createElementVNode(\"img\", {\n    src: _imports_0,\n    style: {\n      \"height\": \"200px\",\n      \"margin-left\": \"50px\"\n    }\n  }, null, -1 /* CACHED */)), _cache[7] || (_cache[7] = _createElementVNode(\"h4\", {\n    class: \"text-center mt-5\"\n  }, [_createElementVNode(\"b\", null, \"กรอกหมายเลขที่ได้รับจาก Authenticator ใส่ลงในช่องด้านล่าง\")], -1 /* CACHED */)), _createCommentVNode(\" <FloatLabel> \"), _createVNode($setup[\"InputText\"], {\n    modelValue: $setup.code,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.code = $event),\n    feedback: false,\n    id: \"password\",\n    \"toggle-mask\": \"\",\n    placeholder: \"Authentication code\"\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n    class: \"row justify-content-center\"\n  }, [_createElementVNode(\"div\", {\n    class: \"col-4 justify-content-center\"\n  }, [_createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-primary btn-block mt-3\"\n  }, \"ยืนยัน\")])], -1 /* CACHED */)), _createCommentVNode(\" </FloatLabel> \")])])], 32 /* NEED_HYDRATION */)])) : _createCommentVNode(\"v-if\", true)])])])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_imports_0","class","style","_createVNode","_component_Toast","_createCommentVNode","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","$setup","twofa","_createElementBlock","_hoisted_4","_hoisted_5","_hoisted_6","src","qrcode","_hoisted_8","_hoisted_9","_toDisplayString","secret","onSubmit","_withModifiers","handleLogin","_hoisted_10","_hoisted_11","code","$event","feedback","id","placeholder","type","_hoisted_12","_hoisted_13","_hoisted_14"],"sources":["D:\\frontend_cem\\src\\views\\TwoFAAuthPage.vue"],"sourcesContent":["/* eslint-disable no-alert, no-console */\n<template>\n  <Toast />\n  <!-- <div class=\"\" style=\"margin-top: calc(20vh)\">\n    <div class=\"row justify-content-center\">\n      <div class=\"col-11 col-sm-8 col-md-6 col-xl-3 justify-content-center\">\n        <div class=\"card\">\n          <div class=\"card-header\">\n            <h3 class=\"text-center\">ระบบยืนยันตัวตน 2 ขั้นตอน</h3>\n          </div>\n          <div class=\"card-body\">\n            <form @submit.prevent=\"handleLogin\">\n              <div class=\" mt-3 pt-3\">\n                <FloatLabel>\n                  <InputText type=\"text\" class=\"form-control\" id=\"username\" v-model=\"username\" :invalid=\"isUserValid\" />\n                  <label for=\"username\">ชื่อผู้ใช้</label>\n                </FloatLabel>\n              </div>\n              <div class=\" mt-3 pt-3\">\n                <FloatLabel>\n                  <Password v-model=\"password\" :feedback=\"false\" id=\"password\" toggle-mask=\"\" :invalid=\"isPasswordValid\"\n                    class=\" w-100\" />\n                  <label for=\"password\">รหัสผ่าน</label>\n                </FloatLabel>\n              </div>\n              <div style=\"text-align: center;\">\n                <button type=\"submit\" class=\"btn btn-primary btn-block mt-4 w-100\">เข้าสู่ระบบ</button>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div> -->\n  <div class=\"\" style=\"margin-top: calc(5vh)\">\n    <div class=\"row justify-content-center\">\n      <div class=\"col-12 justify-content-center\">\n        <h2 class=\"text-center\">ระบบยืนยันตัวตน 2 ขั้นตอน</h2>\n        <h3 class=\"text-center\">โปรดใช้แอพ Microsoft Authenticator หรือ Google Authenticator เพื่อยืนยันตัวตนกับบัญชีของคุณ</h3>\n        <div v-if=\"twofa !== null && twofa == 0\">\n          <div class=\"row justify-content-center mt-5\">\n            <div class=\"col-4\">\n              <h4><b>ขั้นตอนที่ 1: เชื่อมต่อ Authenticator เข้ากับบัญชี</b></h4>\n              <h5>ทางเลือกที่ 1: เปิดแอพ เลือกเพิ่มบัญชีด้วยการสแกน QR Code และสแกน QR Code ด้านล่างนี้</h5>\n            </div>\n          </div>\n\n          <div class=\"row justify-content-center\">\n            <div class=\"col-2 justify-content-center\" style=\"text-align: center\">\n              <img class=\"justify-content-center\" :src=qrcode style=\"width: 70%; height: auto;\" />\n            </div>\n          </div>\n\n          <div class=\"row justify-content-center mt-5\">\n            <div class=\"col-4\">\n              <h5>ทางเลือกที่ 2: เปิดแอพ เลือกเพิ่มบัญชีด้วยการกรอก key และกรอก key ที่อยู่ด้านล่างนี้</h5>\n              <h5>Key: {{secret}}</h5>\n            </div>\n          </div>\n          <form @submit.prevent=\"handleLogin\">\n            <div class=\"row justify-content-center mt-5\">\n              <div class=\"col-4\">\n                <h4><b>ขั้นตอนที่ 2: กรอกหมายเลขที่ได้รับจาก Authenticator ใส่ลงในช่องด้านล่าง</b></h4>\n                <!-- <FloatLabel> -->\n                <InputText v-model=\"code\" :feedback=\"false\" id=\"password\" toggle-mask=\"\" placeholder=\"Authentication code\"/>\n                <div class=\"row\">\n                  <div class=\"col-4\">\n                    <button type=\"submit\" class=\"btn btn-primary btn-block mt-3\">ยืนยัน</button>\n                  </div>\n                </div>\n                <!-- </FloatLabel> -->\n              </div>\n            </div>\n          </form>\n        </div>\n        <div v-if=\"twofa !== null && twofa == 1\">\n          <form @submit.prevent=\"handleLogin\">\n            <div class=\"row justify-content-center mt-5\">\n              <div class=\"col-4 justify-content-center text-center\">\n                <img src=\"../assets/images/mobile.png\" style=\" height: 200px; margin-left: 50px;\" />\n                <h4 class=\"text-center mt-5\" ><b>กรอกหมายเลขที่ได้รับจาก Authenticator ใส่ลงในช่องด้านล่าง</b></h4>\n                <!-- <FloatLabel> -->\n                <InputText v-model=\"code\" :feedback=\"false\" id=\"password\" toggle-mask=\"\" placeholder=\"Authentication code\"/>\n                <div class=\"row justify-content-center\">\n                  <div class=\"col-4 justify-content-center\">\n                    <button type=\"submit\" class=\"btn btn-primary btn-block mt-3\">ยืนยัน</button>\n                  </div>\n                </div>\n                <!-- </FloatLabel> -->\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue';\nimport axios from 'axios';\nimport router from '@/router';\n/* eslint-disable */\nimport InputText from 'primevue/inputtext';\n// import Password from 'primevue/password';\n\nimport { useToast } from 'primevue/usetoast';\n\nconst toast = useToast();\n/* eslint-disable */\nvar isUserValid = false;\nvar isPasswordValid = false;\nvar qrcode = ref(localStorage.getItem('two-authentication'));\nvar code = ref(\"\");\nvar twofa = ref(localStorage.getItem('twofa'));\nvar secret = ref(localStorage.getItem('secret'));\n\nonMounted(() => {\n  // if (localStorage.length > 0) {\n  //   localStorage.clear();\n  // \n  // qrcode = localStorage.getItem('two-authentication')\n});\nfunction handleLogin() {\n  auth(code.value);\n}\n\nfunction auth(code) {\n  localStorage.getItem('soc_user_id')\n  var ip = \"/auth/verifyotp\";\n  var data = {\n    \"totp\": code,\n    \"userId\": localStorage.getItem('soc_user_id')\n  };\n\n  axios.post(ip, data).then(function (response) {\n    localStorage.removeItem(\"two-authentication\");\n    if (response.data.status == 200) {\n      router.push(\"/dashboard\");\n    }else{\n      toast.add({\n        severity: 'error', summary: 'Fail', detail: 'code incorrect.', life: 3000\n      });\n    }\n  }).catch(function (auth_error) {\n    if (auth_error.message == \"Network Error\") {\n      toast.add({\n        severity: 'error', summary: 'Fail', detail: auth_error.message, life: 3000\n      });\n    } else if (auth_error.message.includes(\"timeout\")) {\n      toast.add({\n        severity: 'error', summary: 'Fail', detail: 'Timeout', life: 3000\n      });\n    }\n    else {\n      toast.add({\n        severity: 'error', summary: 'Fail', detail: 'code incorrect.', life: 3000\n      });\n    }\n  });\n}\n</script>\n\n<style>\nbody {\n  width: 100%;\n}\n</style>\n\n/* eslint-disable no-alert, no-console */\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}