{"ast":null,"code":"import axios from 'axios';\nimport router from '@/router';\n\n// Configure axios defaults\naxios.defaults.baseURL = '';\naxios.defaults.withCredentials = true;\naxios.defaults.timeout = 30000; // 30 seconds\n\n// Request interceptor\naxios.interceptors.request.use(config => {\n  // Add token to Authorization header\n  const token = localStorage.getItem('soc_token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  // Add timestamp to prevent caching\n  config.params = {\n    ...config.params,\n    _t: Date.now()\n  };\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor\naxios.interceptors.response.use(response => {\n  return response;\n}, error => {\n  // Handle different error types\n  if (error.response) {\n    // Server responded with error status\n    const {\n      status,\n      data\n    } = error.response;\n    switch (status) {\n      case 401:\n        // Unauthorized - clear all auth data and redirect to login\n        localStorage.clear();\n        sessionStorage.clear();\n        // Clear all cookies\n        document.cookie.split(\";\").forEach(c => {\n          document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\");\n        });\n\n        // Show message if token expired\n        if (data.expired) {\n          error.userMessage = 'เซสชันหมดอายุ กรุณาเข้าสู่ระบบใหม่อีกครั้ง';\n        } else {\n          error.userMessage = 'กรุณาเข้าสู่ระบบใหม่อีกครั้ง';\n        }\n\n        // Redirect to login\n        if (router.currentRoute.value.path !== '/login') {\n          router.push('/login');\n        }\n        break;\n      case 403:\n        // Forbidden\n        error.userMessage = 'คุณไม่มีสิทธิ์เข้าถึงข้อมูลนี้';\n        break;\n      case 404:\n        // Not found\n        error.userMessage = 'ไม่พบข้อมูลที่ต้องการ';\n        break;\n      case 422:\n        // Validation error\n        error.userMessage = data.error || 'ข้อมูลไม่ถูกต้อง กรุณาตรวจสอบอีกครั้ง';\n        break;\n      case 429:\n        // Too many requests\n        error.userMessage = 'คำขอมากเกินไป กรุณารอสักครู่แล้วลองใหม่';\n        break;\n      case 500:\n      case 502:\n      case 503:\n      case 504:\n        // Server error\n        error.userMessage = 'เกิดข้อผิดพลาดจากเซิร์ฟเวอร์ กรุณาลองใหม่อีกครั้ง';\n        break;\n      default:\n        error.userMessage = data.error || 'เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง';\n    }\n  } else if (error.request) {\n    // Request was made but no response\n    if (error.code === 'ECONNABORTED') {\n      error.userMessage = 'การเชื่อมต่อหมดเวลา กรุณาลองใหม่อีกครั้ง';\n    } else if (error.code === 'ERR_NETWORK') {\n      error.userMessage = 'ไม่สามารถเชื่อมต่อได้ กรุณาตรวจสอบอินเทอร์เน็ต';\n    } else {\n      error.userMessage = 'ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้';\n    }\n  } else {\n    // Something else happened\n    error.userMessage = 'เกิดข้อผิดพลาดที่ไม่คาดคิด';\n  }\n\n  // Log error for debugging\n  console.error('API Error:', {\n    url: error.config?.url,\n    method: error.config?.method,\n    status: error.response?.status,\n    message: error.message,\n    userMessage: error.userMessage\n  });\n  return Promise.reject(error);\n});\nexport default axios;","map":{"version":3,"names":["axios","router","defaults","baseURL","withCredentials","timeout","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","params","_t","Date","now","error","Promise","reject","response","status","data","clear","sessionStorage","document","cookie","split","forEach","c","replace","toUTCString","expired","userMessage","currentRoute","value","path","push","code","console","url","method","message"],"sources":["D:/frontend_cem/src/utils/axiosConfig.js"],"sourcesContent":["import axios from 'axios'\r\nimport router from '@/router'\r\n\r\n// Configure axios defaults\r\naxios.defaults.baseURL = ''\r\naxios.defaults.withCredentials = true\r\naxios.defaults.timeout = 30000 // 30 seconds\r\n\r\n// Request interceptor\r\naxios.interceptors.request.use(\r\n  (config) => {\r\n    // Add token to Authorization header\r\n    const token = localStorage.getItem('soc_token')\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`\r\n    }\r\n    // Add timestamp to prevent caching\r\n    config.params = {\r\n      ...config.params,\r\n      _t: Date.now()\r\n    }\r\n    return config\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error)\r\n  }\r\n)\r\n\r\n// Response interceptor\r\naxios.interceptors.response.use(\r\n  (response) => {\r\n    return response\r\n  },\r\n  (error) => {\r\n    // Handle different error types\r\n    if (error.response) {\r\n      // Server responded with error status\r\n      const { status, data } = error.response\r\n      \r\n      switch (status) {\r\n        case 401:\r\n          // Unauthorized - clear all auth data and redirect to login\r\n          localStorage.clear()\r\n          sessionStorage.clear()\r\n          // Clear all cookies\r\n          document.cookie.split(\";\").forEach((c) => {\r\n            document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\")\r\n          })\r\n          \r\n          // Show message if token expired\r\n          if (data.expired) {\r\n            error.userMessage = 'เซสชันหมดอายุ กรุณาเข้าสู่ระบบใหม่อีกครั้ง'\r\n          } else {\r\n            error.userMessage = 'กรุณาเข้าสู่ระบบใหม่อีกครั้ง'\r\n          }\r\n          \r\n          // Redirect to login\r\n          if (router.currentRoute.value.path !== '/login') {\r\n            router.push('/login')\r\n          }\r\n          break\r\n          \r\n        case 403:\r\n          // Forbidden\r\n          error.userMessage = 'คุณไม่มีสิทธิ์เข้าถึงข้อมูลนี้'\r\n          break\r\n          \r\n        case 404:\r\n          // Not found\r\n          error.userMessage = 'ไม่พบข้อมูลที่ต้องการ'\r\n          break\r\n          \r\n        case 422:\r\n          // Validation error\r\n          error.userMessage = data.error || 'ข้อมูลไม่ถูกต้อง กรุณาตรวจสอบอีกครั้ง'\r\n          break\r\n          \r\n        case 429:\r\n          // Too many requests\r\n          error.userMessage = 'คำขอมากเกินไป กรุณารอสักครู่แล้วลองใหม่'\r\n          break\r\n          \r\n        case 500:\r\n        case 502:\r\n        case 503:\r\n        case 504:\r\n          // Server error\r\n          error.userMessage = 'เกิดข้อผิดพลาดจากเซิร์ฟเวอร์ กรุณาลองใหม่อีกครั้ง'\r\n          break\r\n          \r\n        default:\r\n          error.userMessage = data.error || 'เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง'\r\n      }\r\n    } else if (error.request) {\r\n      // Request was made but no response\r\n      if (error.code === 'ECONNABORTED') {\r\n        error.userMessage = 'การเชื่อมต่อหมดเวลา กรุณาลองใหม่อีกครั้ง'\r\n      } else if (error.code === 'ERR_NETWORK') {\r\n        error.userMessage = 'ไม่สามารถเชื่อมต่อได้ กรุณาตรวจสอบอินเทอร์เน็ต'\r\n      } else {\r\n        error.userMessage = 'ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้'\r\n      }\r\n    } else {\r\n      // Something else happened\r\n      error.userMessage = 'เกิดข้อผิดพลาดที่ไม่คาดคิด'\r\n    }\r\n    \r\n    // Log error for debugging\r\n    console.error('API Error:', {\r\n      url: error.config?.url,\r\n      method: error.config?.method,\r\n      status: error.response?.status,\r\n      message: error.message,\r\n      userMessage: error.userMessage\r\n    })\r\n    \r\n    return Promise.reject(error)\r\n  }\r\n)\r\n\r\nexport default axios\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}