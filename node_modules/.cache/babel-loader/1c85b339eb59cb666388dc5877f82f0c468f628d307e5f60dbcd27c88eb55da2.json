{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { ref, watch } from 'vue';\nimport axios from 'axios';\nexport default {\n  __name: 'UserInfoDialog',\n  props: {\n    visible: Boolean,\n    userName: String,\n    userId: Number\n  },\n  emits: ['update:visible'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const emit = __emit;\n    const user = ref(null);\n    const loading = ref(false);\n    const loadUserInfo = async () => {\n      if (!props.userName && !props.userId) return;\n      loading.value = true;\n      user.value = null;\n      try {\n        let response;\n        if (props.userId) {\n          // ถ้ามี userId ให้ดึงจาก API โดยตรง\n          response = await axios.get(`/api/users`);\n          user.value = response.data.find(u => u.id === props.userId);\n        } else {\n          // ถ้ามีแค่ชื่อ ให้ค้นหาจากชื่อ\n          response = await axios.get(`/api/users`);\n          const fullName = props.userName.trim();\n          user.value = response.data.find(u => {\n            const userName = `${u.firstname} ${u.lastname}`.trim();\n            return userName === fullName;\n          });\n        }\n      } catch (error) {\n        console.error('Error loading user info:', error);\n      } finally {\n        loading.value = false;\n      }\n    };\n    watch(() => props.visible, newVal => {\n      if (newVal) {\n        loadUserInfo();\n      }\n    });\n    const getRoleLabel = role => {\n      const roles = {\n        'admin': 'ผู้ดูแลระบบ',\n        'manager': 'ผู้จัดการ',\n        'hr': 'ฝ่ายบุคคล',\n        'user': 'ผู้ใช้งาน'\n      };\n      return roles[role?.toLowerCase()] || role;\n    };\n    const getRoleSeverity = role => {\n      const severities = {\n        'admin': 'danger',\n        'manager': 'warning',\n        'hr': 'info',\n        'user': 'success'\n      };\n      return severities[role?.toLowerCase()] || 'secondary';\n    };\n    const __returned__ = {\n      props,\n      emit,\n      user,\n      loading,\n      loadUserInfo,\n      getRoleLabel,\n      getRoleSeverity,\n      ref,\n      watch,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","watch","axios","props","__props","emit","__emit","user","loading","loadUserInfo","userName","userId","value","response","get","data","find","u","id","fullName","trim","firstname","lastname","error","console","visible","newVal","getRoleLabel","role","roles","toLowerCase","getRoleSeverity","severities"],"sources":["D:/frontend_cem/src/components/UserInfoDialog.vue"],"sourcesContent":["<template>\n  <Dialog v-model:visible=\"visible\" modal header=\"ข้อมูลผู้ใช้\" :style=\"{ width: '500px' }\" @update:visible=\"$emit('update:visible', $event)\">\n    <div v-if=\"loading\" class=\"loading-state\">\n      <i class=\"pi pi-spin pi-spinner\" style=\"font-size: 2rem\"></i>\n      <p>กำลังโหลดข้อมูล...</p>\n    </div>\n\n    <div v-else-if=\"user\" class=\"user-info-content\">\n      <div class=\"user-header\">\n        <div class=\"user-avatar\">\n          <i class=\"pi pi-user\"></i>\n        </div>\n        <div class=\"user-title\">\n          <h3>{{ user.firstname }} {{ user.lastname }}</h3>\n          <Badge :value=\"getRoleLabel(user.role)\" :severity=\"getRoleSeverity(user.role)\" />\n        </div>\n      </div>\n\n      <Divider />\n\n      <div class=\"user-details\">\n        <div class=\"detail-row\">\n          <span class=\"detail-label\"><i class=\"pi pi-id-card\"></i> รหัสพนักงาน</span>\n          <span class=\"detail-value\">{{ user.employee_id || '-' }}</span>\n        </div>\n\n        <div class=\"detail-row\">\n          <span class=\"detail-label\"><i class=\"pi pi-user\"></i> Username</span>\n          <span class=\"detail-value\">{{ user.username }}</span>\n        </div>\n\n        <div class=\"detail-row\">\n          <span class=\"detail-label\"><i class=\"pi pi-envelope\"></i> Email</span>\n          <span class=\"detail-value\">{{ user.email || '-' }}</span>\n        </div>\n\n        <div class=\"detail-row\">\n          <span class=\"detail-label\"><i class=\"pi pi-phone\"></i> เบอร์โทร</span>\n          <span class=\"detail-value\">{{ user.phone || '-' }}</span>\n        </div>\n\n        <div class=\"detail-row\">\n          <span class=\"detail-label\"><i class=\"pi pi-building\"></i> แผนก</span>\n          <span class=\"detail-value\">{{ user.department || '-' }}</span>\n        </div>\n\n        <div class=\"detail-row\">\n          <span class=\"detail-label\"><i class=\"pi pi-briefcase\"></i> ตำแหน่ง</span>\n          <span class=\"detail-value\">{{ user.position || '-' }}</span>\n        </div>\n\n        <div class=\"detail-row\">\n          <span class=\"detail-label\"><i class=\"pi pi-circle-fill\"></i> สถานะ</span>\n          <Badge :value=\"user.is_active ? 'ใช้งาน' : 'ปิดใช้งาน'\" :severity=\"user.is_active ? 'success' : 'danger'\" />\n        </div>\n      </div>\n    </div>\n\n    <div v-else class=\"error-state\">\n      <i class=\"pi pi-exclamation-triangle\" style=\"font-size: 2rem; color: #f59e0b\"></i>\n      <p>ไม่พบข้อมูลผู้ใช้</p>\n    </div>\n\n    <template #footer>\n      <Button label=\"ปิด\" icon=\"pi pi-times\" @click=\"$emit('update:visible', false)\" />\n    </template>\n  </Dialog>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport axios from 'axios'\n\nconst props = defineProps({\n  visible: Boolean,\n  userName: String,\n  userId: Number\n})\n\nconst emit = defineEmits(['update:visible'])\n\nconst user = ref(null)\nconst loading = ref(false)\n\nconst loadUserInfo = async () => {\n  if (!props.userName && !props.userId) return\n\n  loading.value = true\n  user.value = null\n\n  try {\n    let response\n    if (props.userId) {\n      // ถ้ามี userId ให้ดึงจาก API โดยตรง\n      response = await axios.get(`/api/users`)\n      user.value = response.data.find(u => u.id === props.userId)\n    } else {\n      // ถ้ามีแค่ชื่อ ให้ค้นหาจากชื่อ\n      response = await axios.get(`/api/users`)\n      const fullName = props.userName.trim()\n      user.value = response.data.find(u => {\n        const userName = `${u.firstname} ${u.lastname}`.trim()\n        return userName === fullName\n      })\n    }\n  } catch (error) {\n    console.error('Error loading user info:', error)\n  } finally {\n    loading.value = false\n  }\n}\n\nwatch(() => props.visible, (newVal) => {\n  if (newVal) {\n    loadUserInfo()\n  }\n})\n\nconst getRoleLabel = (role) => {\n  const roles = {\n    'admin': 'ผู้ดูแลระบบ',\n    'manager': 'ผู้จัดการ',\n    'hr': 'ฝ่ายบุคคล',\n    'user': 'ผู้ใช้งาน'\n  }\n  return roles[role?.toLowerCase()] || role\n}\n\nconst getRoleSeverity = (role) => {\n  const severities = {\n    'admin': 'danger',\n    'manager': 'warning',\n    'hr': 'info',\n    'user': 'success'\n  }\n  return severities[role?.toLowerCase()] || 'secondary'\n}\n</script>\n\n<style scoped>\n.loading-state,\n.error-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  gap: 1rem;\n  color: #6c757d;\n}\n\n.user-info-content {\n  padding: 1rem 0;\n}\n\n.user-header {\n  display: flex;\n  align-items: center;\n  gap: 1.5rem;\n  margin-bottom: 1rem;\n}\n\n.user-avatar {\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 2.5rem;\n}\n\n.user-title h3 {\n  margin: 0 0 0.5rem 0;\n  font-size: 1.5rem;\n  color: #2c3e50;\n}\n\n.user-details {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.detail-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem;\n  background: #f8f9fa;\n  border-radius: 8px;\n}\n\n.detail-label {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-weight: 600;\n  color: #495057;\n}\n\n.detail-label i {\n  color: #6c757d;\n}\n\n.detail-value {\n  color: #2c3e50;\n  font-weight: 500;\n}\n</style>\n"],"mappings":";;AAsEA,SAASA,GAAG,EAAEC,KAAK,QAAQ,KAAI;AAC/B,OAAOC,KAAK,MAAM,OAAM;;;;;;;;;;;;;;IAExB,MAAMC,KAAK,GAAGC,OAAA;IAMd,MAAMC,IAAI,GAAGC,MAAA;IAEb,MAAMC,IAAI,GAAGP,GAAG,CAAC,IAAI;IACrB,MAAMQ,OAAO,GAAGR,GAAG,CAAC,KAAK;IAEzB,MAAMS,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B,IAAI,CAACN,KAAK,CAACO,QAAQ,IAAI,CAACP,KAAK,CAACQ,MAAM,EAAE;MAEtCH,OAAO,CAACI,KAAK,GAAG,IAAG;MACnBL,IAAI,CAACK,KAAK,GAAG,IAAG;MAEhB,IAAI;QACF,IAAIC,QAAO;QACX,IAAIV,KAAK,CAACQ,MAAM,EAAE;UAChB;UACAE,QAAQ,GAAG,MAAMX,KAAK,CAACY,GAAG,CAAC,YAAY;UACvCP,IAAI,CAACK,KAAK,GAAGC,QAAQ,CAACE,IAAI,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKf,KAAK,CAACQ,MAAM;QAC5D,CAAC,MAAM;UACL;UACAE,QAAQ,GAAG,MAAMX,KAAK,CAACY,GAAG,CAAC,YAAY;UACvC,MAAMK,QAAQ,GAAGhB,KAAK,CAACO,QAAQ,CAACU,IAAI,CAAC;UACrCb,IAAI,CAACK,KAAK,GAAGC,QAAQ,CAACE,IAAI,CAACC,IAAI,CAACC,CAAC,IAAI;YACnC,MAAMP,QAAQ,GAAG,GAAGO,CAAC,CAACI,SAAS,IAAIJ,CAAC,CAACK,QAAQ,EAAE,CAACF,IAAI,CAAC;YACrD,OAAOV,QAAQ,KAAKS,QAAO;UAC7B,CAAC;QACH;MACF,CAAC,CAAC,OAAOI,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK;MACjD,CAAC,SAAS;QACRf,OAAO,CAACI,KAAK,GAAG,KAAI;MACtB;IACF;IAEAX,KAAK,CAAC,MAAME,KAAK,CAACsB,OAAO,EAAGC,MAAM,IAAK;MACrC,IAAIA,MAAM,EAAE;QACVjB,YAAY,CAAC;MACf;IACF,CAAC;IAED,MAAMkB,YAAY,GAAIC,IAAI,IAAK;MAC7B,MAAMC,KAAK,GAAG;QACZ,OAAO,EAAE,aAAa;QACtB,SAAS,EAAE,WAAW;QACtB,IAAI,EAAE,WAAW;QACjB,MAAM,EAAE;MACV;MACA,OAAOA,KAAK,CAACD,IAAI,EAAEE,WAAW,CAAC,CAAC,CAAC,IAAIF,IAAG;IAC1C;IAEA,MAAMG,eAAe,GAAIH,IAAI,IAAK;MAChC,MAAMI,UAAU,GAAG;QACjB,OAAO,EAAE,QAAQ;QACjB,SAAS,EAAE,SAAS;QACpB,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE;MACV;MACA,OAAOA,UAAU,CAACJ,IAAI,EAAEE,WAAW,CAAC,CAAC,CAAC,IAAI,WAAU;IACtD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}