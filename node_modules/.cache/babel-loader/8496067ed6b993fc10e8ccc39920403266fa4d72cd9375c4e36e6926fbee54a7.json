{"ast":null,"code":"import axios from 'axios';\nexport default {\n  name: 'DailyWorkList',\n  emits: ['refresh-data'],\n  props: {\n    records: {\n      type: Array,\n      default: () => []\n    }\n  },\n  created() {\n    this.$http = axios.create({\n      baseURL: ''\n    });\n    if (!this.records || this.records.length === 0) {\n      this.loadWorkRecords();\n    }\n  },\n  mounted() {\n    // Load status options from localStorage\n    this.loadStatusOptions();\n    this.loadCategoryOptions();\n\n    // Update current time every second for realtime button state\n    setInterval(() => {\n      this.currentTime = new Date();\n      this.$forceUpdate(); // Force component to re-render\n    }, 1000);\n\n    // Listen for task updates\n    window.addEventListener('taskUpdated', () => {\n      this.$emit('refresh-data');\n    });\n\n    // Listen for status updates from TaskManagement\n    window.addEventListener('statusesUpdated', () => {\n      this.loadStatusOptions();\n    });\n\n    // Listen for category updates\n    window.addEventListener('categoriesUpdated', () => {\n      this.loadCategoryOptions();\n    });\n  },\n  beforeUnmount() {\n    window.removeEventListener('taskUpdated', () => {\n      this.$emit('refresh-data');\n    });\n  },\n  computed: {\n    workRecords() {\n      return this.records && this.records.length > 0 ? this.records : this.localRecords;\n    },\n    filteredRecords() {\n      const records = this.workRecords || [];\n      if (!this.searchQuery) return records;\n      const query = this.searchQuery.toLowerCase().trim();\n      return records.filter(record => {\n        const formattedDate = this.formatDate(record.work_date);\n        const timeRange = `${this.formatTime(record.start_time)} - ${this.formatTime(record.end_time)}`;\n        const searchableData = {\n          id: record.id || '',\n          employee_name: record.employee_name || '',\n          employee_position: record.employee_position || '',\n          task_name: record.task_name || '',\n          so_number: record.so_number || '',\n          work_status: record.work_status || '',\n          location: record.location || '',\n          category: record.category || '',\n          work_description: record.work_description || '',\n          work_date: formattedDate,\n          start_time: record.start_time || '',\n          end_time: record.end_time || '',\n          start_time_short: this.formatTime(record.start_time),\n          end_time_short: this.formatTime(record.end_time),\n          time_range: timeRange\n        };\n        return Object.values(searchableData).some(value => {\n          if (value === null || value === undefined) return false;\n          const strValue = String(value).toLowerCase();\n          return strValue.includes(query) || strValue.replace(/\\s/g, '').includes(query.replace(/\\s/g, ''));\n        });\n      });\n    }\n  },\n  data() {\n    return {\n      searchQuery: '',\n      localRecords: [],\n      detailDialog: false,\n      selectedRecord: null,\n      filesDialog: false,\n      selectedRecordFiles: [],\n      editDialog: false,\n      editFormData: {\n        id: null,\n        work_date: null,\n        start_time: null,\n        end_time: null,\n        work_status: null,\n        location: '',\n        work_description: '',\n        existingFiles: [],\n        newFiles: []\n      },\n      statusOptions: [],\n      categoryOptions: []\n    };\n  },\n  methods: {\n    loadStatusOptions() {\n      this.$http.get('/api/settings/statuses').then(response => {\n        this.statusOptions = response.data.map(status => ({\n          label: status.label,\n          value: status.value,\n          color: status.color\n        }));\n      }).catch(error => {\n        console.error('Error loading statuses:', error);\n        // Fallback to default\n        this.statusOptions = [{\n          label: '‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',\n          value: 'pending',\n          color: '#f59e0b'\n        }, {\n          label: 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',\n          value: 'in_progress',\n          color: '#3b82f6'\n        }, {\n          label: '‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô',\n          value: 'completed',\n          color: '#10b981'\n        }, {\n          label: '‚è∏Ô∏è ‡∏£‡∏∞‡∏á‡∏±‡∏ö',\n          value: 'on_hold',\n          color: '#6c757d'\n        }];\n      });\n    },\n    loadCategoryOptions() {\n      this.$http.get('/api/settings/categories').then(response => {\n        this.categoryOptions = response.data;\n      }).catch(error => {\n        console.error('Error loading categories:', error);\n        this.categoryOptions = [];\n      });\n    },\n    isEditDisabled(record) {\n      if (!record || !record.work_date) {\n        return true;\n      }\n\n      // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏á‡∏≤‡∏ô\n      const workDate = new Date(record.work_date);\n\n      // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡πá‡∏≠‡∏Å = 08:00 ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ\n      const cutoff = new Date(workDate);\n      cutoff.setDate(cutoff.getDate() + 1);\n      cutoff.setHours(8, 0, 0, 0);\n\n      // ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô\n      const now = new Date();\n\n      // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏•‡∏±‡∏á 08:00 ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ\n      return now > cutoff;\n    },\n    async loadWorkRecords() {\n      try {\n        const response = await this.$http.get('/api/daily-work');\n        this.localRecords = response.data || [];\n\n        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö\n\n        if (this.localRecords.length === 0) {\n          this.$toast.add({\n            severity: 'info',\n            summary: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',\n            detail: '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô',\n            life: 3000\n          });\n        }\n      } catch (error) {\n        this.localRecords = [];\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\n          life: 5000\n        });\n      }\n    },\n    formatDate(date) {\n      if (!date) return '-';\n      try {\n        const d = new Date(date);\n        const day = String(d.getDate()).padStart(2, '0');\n        const month = String(d.getMonth() + 1).padStart(2, '0');\n        const year = d.getFullYear();\n        return `${day}/${month}/${year}`;\n      } catch (error) {\n        return date;\n      }\n    },\n    formatTime(time) {\n      if (!time) return '-';\n      return time.substring(0, 5);\n    },\n    formatDateForAPI(date) {\n      if (!date || isNaN(date.getTime())) {\n        return null;\n      }\n\n      // ‡πÉ‡∏ä‡πâ local date components ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏û‡∏£‡∏≤‡∏∞ parse ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß)\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0');\n      const day = String(date.getDate()).padStart(2, '0');\n      if (isNaN(year) || isNaN(month) || isNaN(day)) {\n        return null;\n      }\n      const formatted = `${year}-${month}-${day}`;\n      return formatted;\n    },\n    formatTimeForAPI(time) {\n      if (!time) return null;\n      return time.toTimeString().split(' ')[0];\n    },\n    getStatusLabel(status) {\n      const statusMap = {\n        'completed': '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå',\n        'in_progress': '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',\n        'pending': '‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ / ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå'\n      };\n      const label = statusMap[status] || status;\n      // Remove all emoji and special characters\n      return label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim();\n    },\n    getStatusLabelFromOptions(value) {\n      const status = this.statusOptions.find(s => s.value === value);\n      if (status && status.label) {\n        // Remove all emoji and special characters\n        return status.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim();\n      }\n      return value;\n    },\n    getStatusColor(value) {\n      const status = this.statusOptions.find(s => s.value === value);\n      return status?.color || '#6c757d';\n    },\n    getCategoryLabel(value) {\n      const category = this.categoryOptions.find(c => c.value === value);\n      if (category && category.label) {\n        // Remove all emoji and special characters\n        return category.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim();\n      }\n      return value || '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ';\n    },\n    getCategoryColor(value) {\n      const category = this.categoryOptions.find(c => c.value === value);\n      return category?.color || '#6c757d';\n    },\n    getCategorySeverity() {\n      return 'contrast';\n    },\n    hasFiles(record) {\n      return record.files && Array.isArray(record.files) && record.files.length > 0;\n    },\n    downloadFiles(record) {\n      if (this.hasFiles(record)) {\n        this.selectedRecordFiles = record.files;\n        this.filesDialog = true;\n      }\n    },\n    downloadFile(fileName) {\n      // Create download link\n      const link = document.createElement('a');\n      link.href = `/api/files/download/${fileName}`;\n      link.download = fileName;\n      link.target = '_blank';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    },\n    editRecord(record) {\n      // Parse date ‡πÇ‡∏î‡∏¢‡πÅ‡∏¢‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà\n      let workDate = new Date();\n      if (record.work_date) {\n        // ‡πÅ‡∏¢‡∏Å‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å ISO string\n        // \"2025-10-14T17:00:00.000Z\" -> \"2025-10-14\"\n        const dateOnly = record.work_date.split('T')[0];\n        const [year, month, day] = dateOnly.split('-').map(Number);\n\n        // ‡∏™‡∏£‡πâ‡∏≤‡∏á Date ‡πÉ‡∏´‡∏°‡πà (month ‡πÉ‡∏ô JS ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 0 ‡πÅ‡∏ï‡πà‡πÉ‡∏ô ISO string ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 1)\n        workDate = new Date(year, month - 1, day);\n\n        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô 1 ‡∏ß‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ timezone offset\n        workDate.setDate(workDate.getDate() + 1);\n      }\n      this.editFormData = {\n        id: record.id,\n        work_date: workDate,\n        start_time: this.parseTime(record.start_time),\n        end_time: this.parseTime(record.end_time),\n        work_status: record.work_status,\n        location: record.location || '',\n        work_description: record.work_description || '',\n        existingFiles: [...(record.files || [])],\n        newFiles: []\n      };\n      this.editDialog = true;\n    },\n    parseTime(timeString) {\n      if (!timeString) return null;\n      const [hours, minutes, seconds] = timeString.split(':');\n      const date = new Date();\n      date.setHours(parseInt(hours), parseInt(minutes), parseInt(seconds || 0));\n      return date;\n    },\n    handleEditFileUpload(event) {\n      const files = Array.from(event.target.files);\n      this.editFormData.newFiles = [...this.editFormData.newFiles, ...files];\n    },\n    removeExistingFile(index) {\n      this.editFormData.existingFiles.splice(index, 1);\n    },\n    removeNewFile(index) {\n      this.editFormData.newFiles.splice(index, 1);\n    },\n    async uploadNewFiles() {\n      if (this.editFormData.newFiles.length === 0) return [];\n      const formData = new FormData();\n      this.editFormData.newFiles.forEach(file => {\n        formData.append('files', file);\n      });\n      try {\n        const response = await this.$http.post('/api/files/upload', formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        return response.data.files || [];\n      } catch (error) {\n        return [];\n      }\n    },\n    async updateRecord() {\n      try {\n        // Validate ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà\n        if (!this.editFormData.work_date || isNaN(this.editFormData.work_date.getTime())) {\n          this.$toast.add({\n            severity: 'error',\n            summary: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n            detail: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà',\n            life: 3000\n          });\n          return;\n        }\n\n        // Validate ‡πÄ‡∏ß‡∏•‡∏≤\n        if (this.editFormData.start_time && this.editFormData.end_time) {\n          if (new Date(this.editFormData.end_time) <= new Date(this.editFormData.start_time)) {\n            this.$toast.add({\n              severity: 'error',\n              summary: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n              detail: '‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô',\n              life: 3000\n            });\n            return;\n          }\n        }\n\n        // Upload ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà\n        const newUploadedFiles = await this.uploadNewFiles();\n\n        // ‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà\n        const allFiles = [...this.editFormData.existingFiles, ...newUploadedFiles];\n        const formattedDate = this.formatDateForAPI(this.editFormData.work_date);\n        if (!formattedDate) {\n          this.$toast.add({\n            severity: 'error',\n            summary: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n            detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà',\n            life: 3000\n          });\n          return;\n        }\n        const updateData = {\n          work_date: formattedDate,\n          start_time: this.formatTimeForAPI(this.editFormData.start_time),\n          end_time: this.formatTimeForAPI(this.editFormData.end_time),\n          work_status: this.editFormData.work_status,\n          location: this.editFormData.location,\n          work_description: this.editFormData.work_description,\n          files: allFiles\n        };\n        await this.$http.put(`/api/daily-work/${this.editFormData.id}`, updateData);\n        this.$toast.add({\n          severity: 'success',\n          summary: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',\n          detail: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',\n          life: 3000\n        });\n        this.editDialog = false;\n\n        // Auto-refresh data\n        await this.loadWorkRecords();\n\n        // Emit event for parent component to refresh\n        this.$emit('record-updated');\n\n        // Dispatch global event for real-time update\n        window.dispatchEvent(new CustomEvent('workRecordUpdated'));\n        window.dispatchEvent(new CustomEvent('taskStatusChanged'));\n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\n          detail: error.response?.data?.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\n          life: 5000\n        });\n      }\n    },\n    showDetails(record) {\n      this.selectedRecord = record;\n      this.detailDialog = true;\n    },\n    // Method ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏™‡∏±‡πâ‡∏ô\n    truncateText(text, maxLength) {\n      if (!text) return '-';\n      if (text.length <= maxLength) return text;\n      return text.substring(0, maxLength) + '...';\n    },\n    // Method ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö refresh ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å\n    async refreshData() {\n      await this.loadWorkRecords();\n    },\n    // Method ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô\n    validateRecord(record) {\n      const required = ['id', 'work_date', 'work_status'];\n      const missing = required.filter(field => !record[field]);\n      if (missing.length > 0) {\n        return false;\n      }\n      return true;\n    }\n  }\n};","map":{"version":3,"names":["axios","name","emits","props","records","type","Array","default","created","$http","create","baseURL","length","loadWorkRecords","mounted","loadStatusOptions","loadCategoryOptions","setInterval","currentTime","Date","$forceUpdate","window","addEventListener","$emit","beforeUnmount","removeEventListener","computed","workRecords","localRecords","filteredRecords","searchQuery","query","toLowerCase","trim","filter","record","formattedDate","formatDate","work_date","timeRange","formatTime","start_time","end_time","searchableData","id","employee_name","employee_position","task_name","so_number","work_status","location","category","work_description","start_time_short","end_time_short","time_range","Object","values","some","value","undefined","strValue","String","includes","replace","data","detailDialog","selectedRecord","filesDialog","selectedRecordFiles","editDialog","editFormData","existingFiles","newFiles","statusOptions","categoryOptions","methods","get","then","response","map","status","label","color","catch","error","console","isEditDisabled","workDate","cutoff","setDate","getDate","setHours","now","$toast","add","severity","summary","detail","life","date","d","day","padStart","month","getMonth","year","getFullYear","time","substring","formatDateForAPI","isNaN","getTime","formatted","formatTimeForAPI","toTimeString","split","getStatusLabel","statusMap","getStatusLabelFromOptions","find","s","getStatusColor","getCategoryLabel","c","getCategoryColor","getCategorySeverity","hasFiles","files","isArray","downloadFiles","downloadFile","fileName","link","document","createElement","href","download","target","body","appendChild","click","removeChild","editRecord","dateOnly","Number","parseTime","timeString","hours","minutes","seconds","parseInt","handleEditFileUpload","event","from","removeExistingFile","index","splice","removeNewFile","uploadNewFiles","formData","FormData","forEach","file","append","post","headers","updateRecord","newUploadedFiles","allFiles","updateData","put","dispatchEvent","CustomEvent","showDetails","truncateText","text","maxLength","refreshData","validateRecord","required","missing","field"],"sources":["D:\\GEN-T\\WEB\\GenT-CEM\\frontend_cem\\src\\views\\daily_work\\DailyWorkList.vue"],"sourcesContent":["<template>\r\n  <Card class=\"history-card\">\r\n    <template #content>\r\n      <!-- Search Box -->\r\n      <div class=\"search-box mb-3\">\r\n        <IconField iconPosition=\"left\">\r\n          <InputIcon class=\"pi pi-search\" />\r\n          <InputText v-model=\"searchQuery\" placeholder=\"‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...\" class=\"w-full\" />\r\n        </IconField>\r\n      </div>\r\n\r\n      <div v-if=\"filteredRecords.length === 0\" class=\"empty-state\">\r\n        <i class=\"pi pi-calendar-clock\" style=\"font-size: 4rem; color: #ccc;\"></i>\r\n        <p>{{ searchQuery ? '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏á‡∏≤‡∏ô' }}</p>\r\n      </div>\r\n\r\n      <DataTable v-else :value=\"filteredRecords\" :paginator=\"true\" :rows=\"10\" :rowsPerPageOptions=\"[5, 10, 20]\"\r\n        responsiveLayout=\"scroll\" class=\"history-table\" stripedRows>\r\n\r\n        <Column field=\"id\" header=\"ID\" :sortable=\"true\" style=\"width: 80px; text-align: center;\">\r\n          <template #body=\"slotProps\">\r\n            <Badge :value=\"slotProps.data.id\" severity=\"info\" />\r\n          </template>\r\n        </Column>\r\n\r\n        <Column field=\"work_date\" header=\"‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏á‡∏≤‡∏ô\" :sortable=\"true\">\r\n          <template #body=\"slotProps\">\r\n            {{ formatDate(slotProps.data.work_date) }}\r\n          </template>\r\n        </Column>\r\n\r\n        <Column field=\"start_time\" header=\"‡πÄ‡∏ß‡∏•‡∏≤\" style=\"min-width: 120px;\">\r\n          <template #body=\"slotProps\">\r\n            {{ formatTime(slotProps.data.start_time) }} - {{ formatTime(slotProps.data.end_time) }}\r\n          </template>\r\n        </Column>\r\n\r\n        <Column field=\"employee_name\" header=\"‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•\" :sortable=\"true\" style=\"min-width: 150px;\">\r\n          <template #body=\"slotProps\">\r\n            <div class=\"employee-info\">\r\n              <div class=\"employee-name\">{{ slotProps.data.employee_name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}</div>\r\n            </div>\r\n          </template>\r\n        </Column>\r\n\r\n        <Column field=\"employee_position\" header=\"‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á\" :sortable=\"true\" class=\"hide-mobile\">\r\n          <template #body=\"slotProps\">\r\n            <span class=\"position-text\">{{ slotProps.data.employee_position || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}</span>\r\n          </template>\r\n        </Column>\r\n\r\n        <!-- <Column field=\"employee_department\" header=\"‡πÅ‡∏ú‡∏ô‡∏Å\" :sortable=\"true\" class=\"hide-mobile\">\r\n          <template #body=\"slotProps\">\r\n            <span class=\"department-text\">{{ slotProps.data.employee_department || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}</span>\r\n          </template>\r\n        </Column> -->\r\n\r\n        <Column field=\"task_name\" header=\"‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£\" :sortable=\"true\">\r\n          <template #body=\"slotProps\">\r\n            <div class=\"task-info\">\r\n              <div class=\"task-name\">{{ slotProps.data.task_name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô' }}</div>\r\n              <div v-if=\"slotProps.data.so_number\" class=\"so-number\">SO: {{ slotProps.data.so_number }}</div>\r\n            </div>\r\n          </template>\r\n        </Column>\r\n\r\n        <Column field=\"work_status\" header=\"‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô\" :sortable=\"true\" style=\"text-align: center; min-width: 140px;\">\r\n          <template #body=\"slotProps\">\r\n            <div class=\"badge-container\">\r\n              <Badge :value=\"getStatusLabel(slotProps.data.work_status)\"\r\n                :style=\"{ backgroundColor: getStatusColor(slotProps.data.work_status), color: '#fff' }\" />\r\n            </div>\r\n          </template>\r\n        </Column>\r\n\r\n        <Column field=\"location\" header=\"‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà\" class=\"hide-mobile\" />\r\n\r\n        <Column field=\"category\" header=\"‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏á‡∏≤‡∏ô\" :sortable=\"true\" style=\"text-align: center; min-width: 100px;\">\r\n          <template #body=\"slotProps\">\r\n            <div class=\"badge-container\">\r\n              <Badge :value=\"getCategoryLabel(slotProps.data.category)\" \r\n                     :style=\"{ backgroundColor: getCategoryColor(slotProps.data.category), color: '#fff' }\" />\r\n            </div>\r\n          </template>\r\n        </Column>\r\n\r\n        <!-- <Column header=\"Sale ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô\" class=\"hide-mobile\">\r\n          <template #body=\"slotProps\">\r\n            <div v-if=\"slotProps.data.sale_owner\" class=\"sale-info\">\r\n              <i class=\"pi pi-user\"></i>\r\n              {{ slotProps.data.sale_owner }}\r\n            </div>\r\n            <span v-else class=\"text-muted\">-</span>\r\n          </template>\r\n        </Column> -->\r\n\r\n        <Column header=\"‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô\" class=\"hide-mobile\">\r\n          <template #body=\"slotProps\">\r\n            <Button label=\"‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î\" icon=\"pi pi-info-circle\" size=\"small\" severity=\"info\" outlined\r\n              @click=\"showDetails(slotProps.data)\" />\r\n          </template>\r\n        </Column>\r\n\r\n        <Column header=\"‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£\" style=\"width: 80px;\">\r\n          <template #body=\"slotProps\">\r\n            <div class=\"action-buttons\" v-if=\"slotProps.data\">\r\n              <Button v-if=\"!isEditDisabled(slotProps.data)\" icon=\"pi pi-pencil\" size=\"small\" severity=\"warning\"\r\n                outlined @click=\"editRecord(slotProps.data)\" v-tooltip=\"'‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç'\" />\r\n              <span v-else class=\"disabled-text\">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ</span>\r\n            </div>\r\n          </template>\r\n        </Column>\r\n\r\n        <Column header=\"‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö\" style=\"width: 80px;\">\r\n          <template #body=\"slotProps\">\r\n            <div v-if=\"hasFiles(slotProps.data)\" class=\"attachments-info\">\r\n              <Button icon=\"pi pi-paperclip\" size=\"small\" severity=\"info\" outlined\r\n                @click=\"downloadFiles(slotProps.data)\" v-tooltip=\"`${slotProps.data.files.length} ‡πÑ‡∏ü‡∏•‡πå`\" />\r\n            </div>\r\n            <span v-else class=\"no-files\">-</span>\r\n          </template>\r\n        </Column>\r\n      </DataTable>\r\n    </template>\r\n  </Card>\r\n\r\n  <!-- Dialog ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô -->\r\n  <div v-if=\"detailDialog\" class=\"dialog-overlay\" @click=\"detailDialog = false\">\r\n    <div class=\"dialog-content\" @click.stop>\r\n      <div class=\"dialog-header\">\r\n        <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô</h3>\r\n        <button class=\"dialog-close\" @click=\"detailDialog = false\">&times;</button>\r\n      </div>\r\n      <div class=\"dialog-body\">\r\n        <div class=\"work-description\">\r\n          {{ selectedRecord?.work_description || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î' }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Files Dialog -->\r\n  <Dialog v-model:visible=\"filesDialog\" modal header=\"‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö\" :style=\"{ width: '50rem' }\">\r\n    <div v-if=\"selectedRecordFiles && selectedRecordFiles.length > 0\" class=\"files-list\">\r\n      <div v-for=\"(file, index) in selectedRecordFiles\" :key=\"index\" class=\"file-item\">\r\n        <div class=\"file-info\">\r\n          <i class=\"pi pi-file\"></i>\r\n          <span class=\"file-name\">{{ file }}</span>\r\n        </div>\r\n        <Button icon=\"pi pi-download\" size=\"small\" severity=\"success\" outlined @click=\"downloadFile(file)\"\r\n          v-tooltip=\"'‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î'\" />\r\n      </div>\r\n    </div>\r\n    <div v-else class=\"no-files-dialog\">\r\n      <p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</p>\r\n    </div>\r\n  </Dialog>\r\n\r\n  <!-- Edit Record Dialog -->\r\n  <Dialog v-model:visible=\"editDialog\" modal header=\"‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô\" :style=\"{ width: '50rem' }\" position=\"center\" :draggable=\"false\">\r\n    <form @submit.prevent=\"updateRecord\" class=\"edit-form\">\r\n      <div class=\"form-grid\">\r\n        <div class=\"input-group\">\r\n          <label class=\"input-label\">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏á‡∏≤‡∏ô *</label>\r\n          <Calendar v-model=\"editFormData.work_date\" dateFormat=\"dd/mm/yy\" class=\"corporate-input\" required />\r\n        </div>\r\n\r\n        <div class=\"input-group\">\r\n          <label class=\"input-label\">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô *</label>\r\n          <Calendar v-model=\"editFormData.start_time\" timeOnly hourFormat=\"24\" class=\"corporate-input\" required />\r\n        </div>\r\n\r\n        <div class=\"input-group\">\r\n          <label class=\"input-label\">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏á‡∏≤‡∏ô *</label>\r\n          <Calendar v-model=\"editFormData.end_time\" timeOnly hourFormat=\"24\" class=\"corporate-input\" required />\r\n        </div>\r\n\r\n        <div class=\"input-group\">\r\n          <label class=\"input-label\">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô *</label>\r\n          <Dropdown v-model=\"editFormData.work_status\" :options=\"statusOptions\" optionLabel=\"label\" optionValue=\"value\"\r\n            class=\"corporate-dropdown\" required>\r\n            <template #value=\"slotProps\">\r\n              <span v-if=\"slotProps.value\">{{ getStatusLabelFromOptions(slotProps.value) }}</span>\r\n              <span v-else>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</span>\r\n            </template>\r\n            <template #option=\"slotProps\">\r\n              <span>{{ slotProps.option.label }}</span>\r\n            </template>\r\n          </Dropdown>\r\n        </div>\r\n\r\n        <div class=\"input-group full-width\">\r\n          <label class=\"input-label\">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà *</label>\r\n          <InputText v-model=\"editFormData.location\" required class=\"corporate-input\" />\r\n        </div>\r\n\r\n        <div class=\"input-group full-width\">\r\n          <label class=\"input-label\">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô *</label>\r\n          <Textarea v-model=\"editFormData.work_description\" rows=\"4\" required class=\"corporate-input\" />\r\n        </div>\r\n\r\n        <div class=\"input-group full-width\">\r\n          <label class=\"input-label\">‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</label>\r\n          <div class=\"file-upload-section\">\r\n            <input type=\"file\" ref=\"editFileInput\" @change=\"handleEditFileUpload\"\r\n              accept=\"image/*,.pdf,.doc,.docx,.xls,.xlsx\" multiple class=\"file-input\" style=\"display: none;\">\r\n            <Button type=\"button\" label=\"‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå\" icon=\"pi pi-upload\" severity=\"secondary\" outlined\r\n              @click=\"$refs.editFileInput.click()\" />\r\n          </div>\r\n\r\n          <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏° -->\r\n          <div v-if=\"editFormData.existingFiles?.length > 0\" class=\"existing-files\">\r\n            <h4>‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°:</h4>\r\n            <div v-for=\"(file, index) in editFormData.existingFiles\" :key=\"index\" class=\"file-item\">\r\n              <i class=\"pi pi-file\"></i>\r\n              <span class=\"file-name\">{{ file }}</span>\r\n              <Button icon=\"pi pi-times\" size=\"small\" severity=\"danger\" text @click=\"removeExistingFile(index)\" />\r\n            </div>\r\n          </div>\r\n\r\n          <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà -->\r\n          <div v-if=\"editFormData.newFiles?.length > 0\" class=\"new-files\">\r\n            <h4>‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà:</h4>\r\n            <div v-for=\"(file, index) in editFormData.newFiles\" :key=\"index\" class=\"file-item\">\r\n              <i class=\"pi pi-file\"></i>\r\n              <span class=\"file-name\">{{ file.name }}</span>\r\n              <Button icon=\"pi pi-times\" size=\"small\" severity=\"danger\" text @click=\"removeNewFile(index)\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"form-actions\">\r\n        <Button type=\"button\" label=\"‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å\" severity=\"secondary\" outlined @click=\"editDialog = false\" />\r\n        <Button type=\"submit\" label=\"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å\" severity=\"success\" />\r\n      </div>\r\n    </form>\r\n  </Dialog>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'DailyWorkList',\r\n  emits: ['refresh-data'],\r\n  props: {\r\n    records: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  created() {\r\n    this.$http = axios.create({\r\n      baseURL: ''\r\n    })\r\n    if (!this.records || this.records.length === 0) {\r\n      this.loadWorkRecords()\r\n    }\r\n  },\r\n  mounted() {\r\n    // Load status options from localStorage\r\n    this.loadStatusOptions()\r\n    this.loadCategoryOptions()\r\n\r\n    // Update current time every second for realtime button state\r\n    setInterval(() => {\r\n      this.currentTime = new Date()\r\n      this.$forceUpdate() // Force component to re-render\r\n    }, 1000)\r\n    \r\n    // Listen for task updates\r\n    window.addEventListener('taskUpdated', () => {\r\n      this.$emit('refresh-data')\r\n    })\r\n\r\n    // Listen for status updates from TaskManagement\r\n    window.addEventListener('statusesUpdated', () => {\r\n      this.loadStatusOptions()\r\n    })\r\n\r\n    // Listen for category updates\r\n    window.addEventListener('categoriesUpdated', () => {\r\n      this.loadCategoryOptions()\r\n    })\r\n  },\r\n  \r\n  beforeUnmount() {\r\n    window.removeEventListener('taskUpdated', () => {\r\n      this.$emit('refresh-data')\r\n    })\r\n  },\r\n  computed: {\r\n    workRecords() {\r\n      return this.records && this.records.length > 0 ? this.records : this.localRecords\r\n    },\r\n    filteredRecords() {\r\n      const records = this.workRecords || []\r\n      if (!this.searchQuery) return records\r\n\r\n      const query = this.searchQuery.toLowerCase().trim()\r\n      return records.filter(record => {\r\n        const formattedDate = this.formatDate(record.work_date)\r\n        const timeRange = `${this.formatTime(record.start_time)} - ${this.formatTime(record.end_time)}`\r\n        const searchableData = {\r\n          id: record.id || '',\r\n          employee_name: record.employee_name || '',\r\n          employee_position: record.employee_position || '',\r\n          task_name: record.task_name || '',\r\n          so_number: record.so_number || '',\r\n          work_status: record.work_status || '',\r\n          location: record.location || '',\r\n          category: record.category || '',\r\n          work_description: record.work_description || '',\r\n          work_date: formattedDate,\r\n          start_time: record.start_time || '',\r\n          end_time: record.end_time || '',\r\n          start_time_short: this.formatTime(record.start_time),\r\n          end_time_short: this.formatTime(record.end_time),\r\n          time_range: timeRange\r\n        }\r\n        \r\n        return Object.values(searchableData).some(value => {\r\n          if (value === null || value === undefined) return false\r\n          const strValue = String(value).toLowerCase()\r\n          return strValue.includes(query) || strValue.replace(/\\s/g, '').includes(query.replace(/\\s/g, ''))\r\n        })\r\n      })\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      searchQuery: '',\r\n      localRecords: [],\r\n      detailDialog: false,\r\n      selectedRecord: null,\r\n      filesDialog: false,\r\n      selectedRecordFiles: [],\r\n      editDialog: false,\r\n      editFormData: {\r\n        id: null,\r\n        work_date: null,\r\n        start_time: null,\r\n        end_time: null,\r\n        work_status: null,\r\n        location: '',\r\n        work_description: '',\r\n        existingFiles: [],\r\n        newFiles: []\r\n      },\r\n      statusOptions: [],\r\n      categoryOptions: []\r\n    }\r\n  },\r\n  methods: {\r\n    loadStatusOptions() {\r\n      this.$http.get('/api/settings/statuses')\r\n        .then(response => {\r\n          this.statusOptions = response.data.map(status => ({\r\n            label: status.label,\r\n            value: status.value,\r\n            color: status.color\r\n          }))\r\n        })\r\n        .catch(error => {\r\n          console.error('Error loading statuses:', error)\r\n          // Fallback to default\r\n          this.statusOptions = [\r\n            { label: '‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', value: 'pending', color: '#f59e0b' },\r\n            { label: 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', value: 'in_progress', color: '#3b82f6' },\r\n            { label: '‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', value: 'completed', color: '#10b981' },\r\n            { label: '‚è∏Ô∏è ‡∏£‡∏∞‡∏á‡∏±‡∏ö', value: 'on_hold', color: '#6c757d' }\r\n          ]\r\n        })\r\n    },\r\n    loadCategoryOptions() {\r\n      this.$http.get('/api/settings/categories')\r\n        .then(response => {\r\n          this.categoryOptions = response.data\r\n        })\r\n        .catch(error => {\r\n          console.error('Error loading categories:', error)\r\n          this.categoryOptions = []\r\n        })\r\n    },\r\n    isEditDisabled(record) {\r\n      if (!record || !record.work_date) {\r\n        return true\r\n      }\r\n\r\n      // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏á‡∏≤‡∏ô\r\n      const workDate = new Date(record.work_date)\r\n\r\n      // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡πá‡∏≠‡∏Å = 08:00 ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ\r\n      const cutoff = new Date(workDate)\r\n      cutoff.setDate(cutoff.getDate() + 1)\r\n      cutoff.setHours(8, 0, 0, 0)\r\n\r\n      // ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô\r\n      const now = new Date()\r\n\r\n      // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏•‡∏±‡∏á 08:00 ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ\r\n      return now > cutoff\r\n    },\r\n\r\n    async loadWorkRecords() {\r\n      try {\r\n        const response = await this.$http.get('/api/daily-work')\r\n        this.localRecords = response.data || []\r\n\r\n        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö\r\n\r\n        if (this.localRecords.length === 0) {\r\n          this.$toast.add({\r\n            severity: 'info',\r\n            summary: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',\r\n            detail: '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô',\r\n            life: 3000\r\n          })\r\n        }\r\n      } catch (error) {\r\n        this.localRecords = []\r\n\r\n        this.$toast.add({\r\n          severity: 'error',\r\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\r\n          detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\r\n          life: 5000\r\n        })\r\n      }\r\n    },\r\n    formatDate(date) {\r\n      if (!date) return '-'\r\n      try {\r\n        const d = new Date(date)\r\n        const day = String(d.getDate()).padStart(2, '0')\r\n        const month = String(d.getMonth() + 1).padStart(2, '0')\r\n        const year = d.getFullYear()\r\n        return `${day}/${month}/${year}`\r\n      } catch (error) {\r\n        return date\r\n      }\r\n    },\r\n    formatTime(time) {\r\n      if (!time) return '-'\r\n      return time.substring(0, 5)\r\n    },\r\n    formatDateForAPI(date) {\r\n      if (!date || isNaN(date.getTime())) {\r\n        return null;\r\n      }\r\n\r\n      // ‡πÉ‡∏ä‡πâ local date components ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏û‡∏£‡∏≤‡∏∞ parse ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß)\r\n      const year = date.getFullYear();\r\n      const month = String(date.getMonth() + 1).padStart(2, '0');\r\n      const day = String(date.getDate()).padStart(2, '0');\r\n\r\n      if (isNaN(year) || isNaN(month) || isNaN(day)) {\r\n        return null;\r\n      }\r\n\r\n      const formatted = `${year}-${month}-${day}`;\r\n      return formatted;\r\n    },\r\n    formatTimeForAPI(time) {\r\n      if (!time) return null\r\n      return time.toTimeString().split(' ')[0]\r\n    },\r\n    getStatusLabel(status) {\r\n      const statusMap = {\r\n        'completed': '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå',\r\n        'in_progress': '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',\r\n        'pending': '‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ / ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå'\r\n      }\r\n      const label = statusMap[status] || status\r\n      // Remove all emoji and special characters\r\n      return label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim()\r\n    },\r\n    getStatusLabelFromOptions(value) {\r\n      const status = this.statusOptions.find(s => s.value === value)\r\n      if (status && status.label) {\r\n        // Remove all emoji and special characters\r\n        return status.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim()\r\n      }\r\n      return value\r\n    },\r\n    getStatusColor(value) {\r\n      const status = this.statusOptions.find(s => s.value === value)\r\n      return status?.color || '#6c757d'\r\n    },\r\n    getCategoryLabel(value) {\r\n      const category = this.categoryOptions.find(c => c.value === value)\r\n      if (category && category.label) {\r\n        // Remove all emoji and special characters\r\n        return category.label.replace(/[\\u{1F000}-\\u{1FFFF}]|[\\u{2600}-\\u{27BF}]|[\\u{2300}-\\u{23FF}]|[\\u{2B50}]|[\\u{203C}-\\u{3299}]/gu, '').trim()\r\n      }\r\n      return value || '‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ'\r\n    },\r\n    getCategoryColor(value) {\r\n      const category = this.categoryOptions.find(c => c.value === value)\r\n      return category?.color || '#6c757d'\r\n    },\r\n    getCategorySeverity() {\r\n      return 'contrast'\r\n    },\r\n    hasFiles(record) {\r\n      return record.files && Array.isArray(record.files) && record.files.length > 0\r\n    },\r\n    downloadFiles(record) {\r\n      if (this.hasFiles(record)) {\r\n        this.selectedRecordFiles = record.files\r\n        this.filesDialog = true\r\n      }\r\n    },\r\n    downloadFile(fileName) {\r\n      // Create download link\r\n      const link = document.createElement('a')\r\n      link.href = `/api/files/download/${fileName}`\r\n      link.download = fileName\r\n      link.target = '_blank'\r\n      document.body.appendChild(link)\r\n      link.click()\r\n      document.body.removeChild(link)\r\n    },\r\n    editRecord(record) {\r\n\r\n      // Parse date ‡πÇ‡∏î‡∏¢‡πÅ‡∏¢‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà\r\n      let workDate = new Date();\r\n      if (record.work_date) {\r\n        // ‡πÅ‡∏¢‡∏Å‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å ISO string\r\n        // \"2025-10-14T17:00:00.000Z\" -> \"2025-10-14\"\r\n        const dateOnly = record.work_date.split('T')[0];\r\n        const [year, month, day] = dateOnly.split('-').map(Number);\r\n\r\n        // ‡∏™‡∏£‡πâ‡∏≤‡∏á Date ‡πÉ‡∏´‡∏°‡πà (month ‡πÉ‡∏ô JS ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 0 ‡πÅ‡∏ï‡πà‡πÉ‡∏ô ISO string ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 1)\r\n        workDate = new Date(year, month - 1, day);\r\n\r\n        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô 1 ‡∏ß‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏î‡πÄ‡∏ä‡∏¢ timezone offset\r\n        workDate.setDate(workDate.getDate() + 1);\r\n\r\n      }\r\n\r\n\r\n      this.editFormData = {\r\n        id: record.id,\r\n        work_date: workDate,\r\n        start_time: this.parseTime(record.start_time),\r\n        end_time: this.parseTime(record.end_time),\r\n        work_status: record.work_status,\r\n        location: record.location || '',\r\n        work_description: record.work_description || '',\r\n        existingFiles: [...(record.files || [])],\r\n        newFiles: []\r\n      }\r\n      this.editDialog = true\r\n    },\r\n    parseTime(timeString) {\r\n      if (!timeString) return null\r\n      const [hours, minutes, seconds] = timeString.split(':')\r\n      const date = new Date()\r\n      date.setHours(parseInt(hours), parseInt(minutes), parseInt(seconds || 0))\r\n      return date\r\n    },\r\n    handleEditFileUpload(event) {\r\n      const files = Array.from(event.target.files)\r\n      this.editFormData.newFiles = [...this.editFormData.newFiles, ...files]\r\n    },\r\n    removeExistingFile(index) {\r\n      this.editFormData.existingFiles.splice(index, 1)\r\n    },\r\n    removeNewFile(index) {\r\n      this.editFormData.newFiles.splice(index, 1)\r\n    },\r\n    async uploadNewFiles() {\r\n      if (this.editFormData.newFiles.length === 0) return []\r\n\r\n      const formData = new FormData()\r\n      this.editFormData.newFiles.forEach(file => {\r\n        formData.append('files', file)\r\n      })\r\n\r\n      try {\r\n        const response = await this.$http.post('/api/files/upload', formData, {\r\n          headers: { 'Content-Type': 'multipart/form-data' }\r\n        })\r\n        return response.data.files || []\r\n      } catch (error) {\r\n        return []\r\n      }\r\n    },\r\n    async updateRecord() {\r\n      try {\r\n        // Validate ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà\r\n        if (!this.editFormData.work_date || isNaN(this.editFormData.work_date.getTime())) {\r\n          this.$toast.add({\r\n            severity: 'error',\r\n            summary: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\r\n            detail: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà',\r\n            life: 3000\r\n          })\r\n          return\r\n        }\r\n\r\n        // Validate ‡πÄ‡∏ß‡∏•‡∏≤\r\n        if (this.editFormData.start_time && this.editFormData.end_time) {\r\n          if (new Date(this.editFormData.end_time) <= new Date(this.editFormData.start_time)) {\r\n            this.$toast.add({\r\n              severity: 'error',\r\n              summary: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\r\n              detail: '‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô',\r\n              life: 3000\r\n            })\r\n            return\r\n          }\r\n        }\r\n\r\n        // Upload ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà\r\n        const newUploadedFiles = await this.uploadNewFiles()\r\n\r\n        // ‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà\r\n        const allFiles = [...this.editFormData.existingFiles, ...newUploadedFiles]\r\n\r\n        const formattedDate = this.formatDateForAPI(this.editFormData.work_date)\r\n\r\n        if (!formattedDate) {\r\n          this.$toast.add({\r\n            severity: 'error',\r\n            summary: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\r\n            detail: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà',\r\n            life: 3000\r\n          })\r\n          return\r\n        }\r\n\r\n        const updateData = {\r\n          work_date: formattedDate,\r\n          start_time: this.formatTimeForAPI(this.editFormData.start_time),\r\n          end_time: this.formatTimeForAPI(this.editFormData.end_time),\r\n          work_status: this.editFormData.work_status,\r\n          location: this.editFormData.location,\r\n          work_description: this.editFormData.work_description,\r\n          files: allFiles\r\n        }\r\n\r\n\r\n        await this.$http.put(`/api/daily-work/${this.editFormData.id}`, updateData)\r\n\r\n        this.$toast.add({\r\n          severity: 'success',\r\n          summary: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',\r\n          detail: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',\r\n          life: 3000\r\n        })\r\n\r\n        this.editDialog = false\r\n\r\n        // Auto-refresh data\r\n        await this.loadWorkRecords()\r\n\r\n        // Emit event for parent component to refresh\r\n        this.$emit('record-updated')\r\n\r\n        // Dispatch global event for real-time update\r\n        window.dispatchEvent(new CustomEvent('workRecordUpdated'))\r\n        window.dispatchEvent(new CustomEvent('taskStatusChanged'))\r\n\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: 'error',\r\n          summary: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',\r\n          detail: error.response?.data?.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',\r\n          life: 5000\r\n        })\r\n      }\r\n    },\r\n    showDetails(record) {\r\n      this.selectedRecord = record\r\n      this.detailDialog = true\r\n    },\r\n    // Method ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏™‡∏±‡πâ‡∏ô\r\n    truncateText(text, maxLength) {\r\n      if (!text) return '-'\r\n      if (text.length <= maxLength) return text\r\n      return text.substring(0, maxLength) + '...'\r\n    },\r\n    // Method ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö refresh ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å\r\n    async refreshData() {\r\n      await this.loadWorkRecords()\r\n    },\r\n    // Method ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô\r\n    validateRecord(record) {\r\n      const required = ['id', 'work_date', 'work_status']\r\n      const missing = required.filter(field => !record[field])\r\n\r\n      if (missing.length > 0) {\r\n        return false\r\n      }\r\n      return true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.history-card {\r\n  width: 100%;\r\n  margin: 0;\r\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\r\n  border: 1px solid #e9ecef;\r\n}\r\n\r\n.badge-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100%;\r\n  min-height: 40px;\r\n}\r\n\r\n.badge-container :deep(.p-badge) {\r\n  white-space: normal !important;\r\n  word-break: keep-all !important;\r\n  overflow-wrap: break-word !important;\r\n  text-align: center;\r\n  font-weight: 600;\r\n  font-size: 0.9rem;\r\n  padding: 0.25rem 0.4rem !important;\r\n  line-height: 1.5 !important;\r\n  display: inline-block !important;\r\n  max-width: 100%;\r\n  height: auto !important;\r\n}\r\n\r\n.empty-state {\r\n  text-align: center;\r\n  padding: 4rem 2rem;\r\n  color: #6c757d;\r\n  background: #f8f9fa;\r\n  border-radius: 8px;\r\n  margin: 1rem;\r\n}\r\n\r\n.empty-state p {\r\n  margin-top: 1rem;\r\n  font-size: 1.1rem;\r\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\r\n}\r\n\r\n.history-table :deep(.p-datatable) {\r\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\r\n}\r\n\r\n.history-table :deep(.p-datatable-thead > tr > th) {\r\n  background: #f8f9fa;\r\n  color: #495057;\r\n  font-weight: 600;\r\n  border-bottom: 2px solid #e9ecef;\r\n  padding: 1rem 0.75rem;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.history-table :deep(.p-datatable-tbody > tr > td) {\r\n  padding: 1rem 0.75rem;\r\n  border-bottom: 1px solid #f1f3f4;\r\n  vertical-align: middle;\r\n}\r\n\r\n.history-table :deep(.p-datatable-tbody > tr:hover) {\r\n  background: #f8f9fa;\r\n}\r\n\r\n.history-table :deep(.p-paginator) {\r\n  background: #f8f9fa;\r\n  border-top: 2px solid #e9ecef;\r\n  padding: 1rem;\r\n}\r\n\r\n.employee-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.employee-name {\r\n  font-weight: 600;\r\n  color: #495057;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.position-text {\r\n  color: #6c757d;\r\n  font-size: 0.85rem;\r\n  font-weight: 500;\r\n}\r\n\r\n.department-text {\r\n  color: #868e96;\r\n  font-size: 0.85rem;\r\n  font-weight: 500;\r\n}\r\n\r\n.id-badge-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.custom-id-badge {\r\n  background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%) !important;\r\n  color: white !important;\r\n  font-weight: 700 !important;\r\n  padding: 0.4rem 0.6rem !important;\r\n  border-radius: 8px !important;\r\n  font-size: 0.85rem !important;\r\n  border: 2px solid rgba(59, 130, 246, 0.2) !important;\r\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3) !important;\r\n  letter-spacing: 0.5px !important;\r\n  min-width: 50px !important;\r\n  text-align: center !important;\r\n  display: inline-flex !important;\r\n  align-items: center !important;\r\n  justify-content: center !important;\r\n}\r\n\r\n.task-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.25rem;\r\n}\r\n\r\n.task-name {\r\n  font-weight: 600;\r\n  color: #495057;\r\n  word-wrap: break-word;\r\n  white-space: normal;\r\n}\r\n\r\n.so-number {\r\n  font-size: 0.8rem;\r\n  color: #6c757d;\r\n  background: #e3f2fd;\r\n  padding: 0.2rem 0.5rem;\r\n  border-radius: 12px;\r\n  display: inline-block;\r\n  width: fit-content;\r\n}\r\n\r\n.time-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.25rem;\r\n}\r\n\r\n.time-info i {\r\n  margin-right: 0.5rem;\r\n  color: #667eea;\r\n}\r\n\r\n.total-hours {\r\n  font-size: 0.8rem;\r\n  color: #28a745;\r\n  font-weight: 600;\r\n}\r\n\r\n.sale-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  color: #495057;\r\n}\r\n\r\n.sale-info i {\r\n  color: #667eea;\r\n}\r\n\r\n.text-muted {\r\n  color: #6c757d;\r\n}\r\n\r\n.description-preview {\r\n  font-size: 0.9rem;\r\n  color: #495057;\r\n  line-height: 1.3;\r\n}\r\n\r\n.edit-form {\r\n  padding: 1rem 0;\r\n}\r\n\r\n.form-grid {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr;\r\n  gap: 1rem;\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\n.input-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.input-group.full-width {\r\n  grid-column: 1 / -1;\r\n}\r\n\r\n.input-label {\r\n  font-weight: 500;\r\n  color: #333;\r\n}\r\n\r\n.corporate-input,\r\n.corporate-dropdown {\r\n  width: 100%;\r\n}\r\n\r\n.form-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 1rem;\r\n  padding-top: 1rem;\r\n  border-top: 1px solid #e0e0e0;\r\n}\r\n\r\n.file-upload-section {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.existing-files,\r\n.new-files {\r\n  margin-top: 1rem;\r\n}\r\n\r\n.existing-files h4,\r\n.new-files h4 {\r\n  margin: 0 0 0.5rem 0;\r\n  font-size: 0.9rem;\r\n  color: #666;\r\n}\r\n\r\n.action-buttons {\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  justify-content: center;\r\n}\r\n\r\n.disabled-text {\r\n  color: #6c757d;\r\n  font-size: 0.8rem;\r\n  font-style: italic;\r\n}\r\n\r\n.attachments-info {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.files-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.75rem;\r\n}\r\n\r\n.file-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 0.75rem;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 6px;\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n.file-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.file-name {\r\n  font-weight: 500;\r\n}\r\n\r\n.no-files-dialog {\r\n  text-align: center;\r\n  padding: 2rem;\r\n  color: #666;\r\n}\r\n\r\n.file-upload-section {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.existing-files,\r\n.new-files {\r\n  margin-top: 1rem;\r\n}\r\n\r\n.existing-files h4,\r\n.new-files h4 {\r\n  margin: 0 0 0.5rem 0;\r\n  font-size: 0.9rem;\r\n  color: #666;\r\n}\r\n\r\n.no-files {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  color: #999;\r\n  font-size: 0.9rem;\r\n  width: 100%;\r\n  text-align: center;\r\n}\r\n\r\n.file-indicator {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  color: #667eea;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.file-indicator i {\r\n  color: #667eea;\r\n}\r\n\r\n.dialog-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.dialog-content {\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);\r\n  max-width: 600px;\r\n  width: 90%;\r\n  max-height: 80vh;\r\n  overflow: hidden;\r\n  animation: dialogSlideIn 0.3s ease-out;\r\n}\r\n\r\n@keyframes dialogSlideIn {\r\n  from {\r\n    opacity: 0;\r\n    transform: scale(0.8) translateY(-20px);\r\n  }\r\n\r\n  to {\r\n    opacity: 1;\r\n    transform: scale(1) translateY(0);\r\n  }\r\n}\r\n\r\n.dialog-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 1.5rem;\r\n  border-bottom: 1px solid #e9ecef;\r\n  background: #f8f9fa;\r\n}\r\n\r\n.dialog-header h3 {\r\n  margin: 0;\r\n  color: #495057;\r\n  font-size: 1.25rem;\r\n}\r\n\r\n.dialog-close {\r\n  background: none;\r\n  border: none;\r\n  font-size: 1.5rem;\r\n  cursor: pointer;\r\n  color: #6c757d;\r\n  padding: 0;\r\n  width: 30px;\r\n  height: 30px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 50%;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.dialog-close:hover {\r\n  background: #e9ecef;\r\n  color: #495057;\r\n}\r\n\r\n.dialog-body {\r\n  padding: 1.5rem;\r\n}\r\n\r\n.work-description {\r\n  background: #f8f9fa;\r\n  padding: 1rem;\r\n  border-radius: 6px;\r\n  border-left: 4px solid #667eea;\r\n  white-space: pre-wrap;\r\n  line-height: 1.6;\r\n  color: #495057;\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.detail-content {\r\n  line-height: 1.6;\r\n}\r\n\r\n.detail-content p {\r\n  margin: 0.5rem 0;\r\n}\r\n\r\n/* Mobile Responsive */\r\n@media (max-width: 768px) {\r\n  :deep(.hide-mobile) {\r\n    display: none !important;\r\n  }\r\n\r\n  .history-table :deep(.p-datatable-tbody > tr > td) {\r\n    padding: 0.75rem 0.5rem;\r\n    font-size: 0.9rem;\r\n  }\r\n\r\n  .history-table :deep(.p-datatable-thead > tr > th) {\r\n    padding: 0.75rem 0.5rem;\r\n    font-size: 0.85rem;\r\n  }\r\n\r\n  .task-info {\r\n    max-width: 150px;\r\n  }\r\n\r\n  .task-name {\r\n    font-size: 0.9rem;\r\n    line-height: 1.2;\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .history-table :deep(.p-datatable-tbody > tr > td) {\r\n    padding: 0.5rem 0.25rem;\r\n    font-size: 0.8rem;\r\n  }\r\n\r\n  .history-table :deep(.p-datatable-thead > tr > th) {\r\n    padding: 0.5rem 0.25rem;\r\n    font-size: 0.8rem;\r\n  }\r\n\r\n  .custom-id-badge {\r\n    font-size: 0.7rem;\r\n    padding: 0.3rem 0.5rem;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"AAiPA,OAAOA,KAAI,MAAO,OAAM;AAExB,eAAe;EACbC,IAAI,EAAE,eAAe;EACrBC,KAAK,EAAE,CAAC,cAAc,CAAC;EACvBC,KAAK,EAAE;IACLC,OAAO,EAAE;MACPC,IAAI,EAAEC,KAAK;MACXC,OAAO,EAAEA,CAAA,KAAM;IACjB;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,KAAI,GAAIT,KAAK,CAACU,MAAM,CAAC;MACxBC,OAAO,EAAE;IACX,CAAC;IACD,IAAI,CAAC,IAAI,CAACP,OAAM,IAAK,IAAI,CAACA,OAAO,CAACQ,MAAK,KAAM,CAAC,EAAE;MAC9C,IAAI,CAACC,eAAe,CAAC;IACvB;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR;IACA,IAAI,CAACC,iBAAiB,CAAC;IACvB,IAAI,CAACC,mBAAmB,CAAC;;IAEzB;IACAC,WAAW,CAAC,MAAM;MAChB,IAAI,CAACC,WAAU,GAAI,IAAIC,IAAI,CAAC;MAC5B,IAAI,CAACC,YAAY,CAAC,GAAE;IACtB,CAAC,EAAE,IAAI;;IAEP;IACAC,MAAM,CAACC,gBAAgB,CAAC,aAAa,EAAE,MAAM;MAC3C,IAAI,CAACC,KAAK,CAAC,cAAc;IAC3B,CAAC;;IAED;IACAF,MAAM,CAACC,gBAAgB,CAAC,iBAAiB,EAAE,MAAM;MAC/C,IAAI,CAACP,iBAAiB,CAAC;IACzB,CAAC;;IAED;IACAM,MAAM,CAACC,gBAAgB,CAAC,mBAAmB,EAAE,MAAM;MACjD,IAAI,CAACN,mBAAmB,CAAC;IAC3B,CAAC;EACH,CAAC;EAEDQ,aAAaA,CAAA,EAAG;IACdH,MAAM,CAACI,mBAAmB,CAAC,aAAa,EAAE,MAAM;MAC9C,IAAI,CAACF,KAAK,CAAC,cAAc;IAC3B,CAAC;EACH,CAAC;EACDG,QAAQ,EAAE;IACRC,WAAWA,CAAA,EAAG;MACZ,OAAO,IAAI,CAACvB,OAAM,IAAK,IAAI,CAACA,OAAO,CAACQ,MAAK,GAAI,IAAI,IAAI,CAACR,OAAM,GAAI,IAAI,CAACwB,YAAW;IAClF,CAAC;IACDC,eAAeA,CAAA,EAAG;MAChB,MAAMzB,OAAM,GAAI,IAAI,CAACuB,WAAU,IAAK,EAAC;MACrC,IAAI,CAAC,IAAI,CAACG,WAAW,EAAE,OAAO1B,OAAM;MAEpC,MAAM2B,KAAI,GAAI,IAAI,CAACD,WAAW,CAACE,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC;MAClD,OAAO7B,OAAO,CAAC8B,MAAM,CAACC,MAAK,IAAK;QAC9B,MAAMC,aAAY,GAAI,IAAI,CAACC,UAAU,CAACF,MAAM,CAACG,SAAS;QACtD,MAAMC,SAAQ,GAAI,GAAG,IAAI,CAACC,UAAU,CAACL,MAAM,CAACM,UAAU,CAAC,MAAM,IAAI,CAACD,UAAU,CAACL,MAAM,CAACO,QAAQ,CAAC,EAAC;QAC9F,MAAMC,cAAa,GAAI;UACrBC,EAAE,EAAET,MAAM,CAACS,EAAC,IAAK,EAAE;UACnBC,aAAa,EAAEV,MAAM,CAACU,aAAY,IAAK,EAAE;UACzCC,iBAAiB,EAAEX,MAAM,CAACW,iBAAgB,IAAK,EAAE;UACjDC,SAAS,EAAEZ,MAAM,CAACY,SAAQ,IAAK,EAAE;UACjCC,SAAS,EAAEb,MAAM,CAACa,SAAQ,IAAK,EAAE;UACjCC,WAAW,EAAEd,MAAM,CAACc,WAAU,IAAK,EAAE;UACrCC,QAAQ,EAAEf,MAAM,CAACe,QAAO,IAAK,EAAE;UAC/BC,QAAQ,EAAEhB,MAAM,CAACgB,QAAO,IAAK,EAAE;UAC/BC,gBAAgB,EAAEjB,MAAM,CAACiB,gBAAe,IAAK,EAAE;UAC/Cd,SAAS,EAAEF,aAAa;UACxBK,UAAU,EAAEN,MAAM,CAACM,UAAS,IAAK,EAAE;UACnCC,QAAQ,EAAEP,MAAM,CAACO,QAAO,IAAK,EAAE;UAC/BW,gBAAgB,EAAE,IAAI,CAACb,UAAU,CAACL,MAAM,CAACM,UAAU,CAAC;UACpDa,cAAc,EAAE,IAAI,CAACd,UAAU,CAACL,MAAM,CAACO,QAAQ,CAAC;UAChDa,UAAU,EAAEhB;QACd;QAEA,OAAOiB,MAAM,CAACC,MAAM,CAACd,cAAc,CAAC,CAACe,IAAI,CAACC,KAAI,IAAK;UACjD,IAAIA,KAAI,KAAM,IAAG,IAAKA,KAAI,KAAMC,SAAS,EAAE,OAAO,KAAI;UACtD,MAAMC,QAAO,GAAIC,MAAM,CAACH,KAAK,CAAC,CAAC3B,WAAW,CAAC;UAC3C,OAAO6B,QAAQ,CAACE,QAAQ,CAAChC,KAAK,KAAK8B,QAAQ,CAACG,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAACD,QAAQ,CAAChC,KAAK,CAACiC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;QAClG,CAAC;MACH,CAAC;IACH;EACF,CAAC;EACDC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLnC,WAAW,EAAE,EAAE;MACfF,YAAY,EAAE,EAAE;MAChBsC,YAAY,EAAE,KAAK;MACnBC,cAAc,EAAE,IAAI;MACpBC,WAAW,EAAE,KAAK;MAClBC,mBAAmB,EAAE,EAAE;MACvBC,UAAU,EAAE,KAAK;MACjBC,YAAY,EAAE;QACZ3B,EAAE,EAAE,IAAI;QACRN,SAAS,EAAE,IAAI;QACfG,UAAU,EAAE,IAAI;QAChBC,QAAQ,EAAE,IAAI;QACdO,WAAW,EAAE,IAAI;QACjBC,QAAQ,EAAE,EAAE;QACZE,gBAAgB,EAAE,EAAE;QACpBoB,aAAa,EAAE,EAAE;QACjBC,QAAQ,EAAE;MACZ,CAAC;MACDC,aAAa,EAAE,EAAE;MACjBC,eAAe,EAAE;IACnB;EACF,CAAC;EACDC,OAAO,EAAE;IACP7D,iBAAiBA,CAAA,EAAG;MAClB,IAAI,CAACN,KAAK,CAACoE,GAAG,CAAC,wBAAwB,EACpCC,IAAI,CAACC,QAAO,IAAK;QAChB,IAAI,CAACL,aAAY,GAAIK,QAAQ,CAACd,IAAI,CAACe,GAAG,CAACC,MAAK,KAAM;UAChDC,KAAK,EAAED,MAAM,CAACC,KAAK;UACnBvB,KAAK,EAAEsB,MAAM,CAACtB,KAAK;UACnBwB,KAAK,EAAEF,MAAM,CAACE;QAChB,CAAC,CAAC;MACJ,CAAC,EACAC,KAAK,CAACC,KAAI,IAAK;QACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK;QAC9C;QACA,IAAI,CAACX,aAAY,GAAI,CACnB;UAAEQ,KAAK,EAAE,eAAe;UAAEvB,KAAK,EAAE,SAAS;UAAEwB,KAAK,EAAE;QAAU,CAAC,EAC9D;UAAED,KAAK,EAAE,mBAAmB;UAAEvB,KAAK,EAAE,aAAa;UAAEwB,KAAK,EAAE;QAAU,CAAC,EACtE;UAAED,KAAK,EAAE,aAAa;UAAEvB,KAAK,EAAE,WAAW;UAAEwB,KAAK,EAAE;QAAU,CAAC,EAC9D;UAAED,KAAK,EAAE,UAAU;UAAEvB,KAAK,EAAE,SAAS;UAAEwB,KAAK,EAAE;QAAU,EAC1D;MACF,CAAC;IACL,CAAC;IACDnE,mBAAmBA,CAAA,EAAG;MACpB,IAAI,CAACP,KAAK,CAACoE,GAAG,CAAC,0BAA0B,EACtCC,IAAI,CAACC,QAAO,IAAK;QAChB,IAAI,CAACJ,eAAc,GAAII,QAAQ,CAACd,IAAG;MACrC,CAAC,EACAmB,KAAK,CAACC,KAAI,IAAK;QACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK;QAChD,IAAI,CAACV,eAAc,GAAI,EAAC;MAC1B,CAAC;IACL,CAAC;IACDY,cAAcA,CAACpD,MAAM,EAAE;MACrB,IAAI,CAACA,MAAK,IAAK,CAACA,MAAM,CAACG,SAAS,EAAE;QAChC,OAAO,IAAG;MACZ;;MAEA;MACA,MAAMkD,QAAO,GAAI,IAAIrE,IAAI,CAACgB,MAAM,CAACG,SAAS;;MAE1C;MACA,MAAMmD,MAAK,GAAI,IAAItE,IAAI,CAACqE,QAAQ;MAChCC,MAAM,CAACC,OAAO,CAACD,MAAM,CAACE,OAAO,CAAC,IAAI,CAAC;MACnCF,MAAM,CAACG,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;;MAE1B;MACA,MAAMC,GAAE,GAAI,IAAI1E,IAAI,CAAC;;MAErB;MACA,OAAO0E,GAAE,GAAIJ,MAAK;IACpB,CAAC;IAED,MAAM5E,eAAeA,CAAA,EAAG;MACtB,IAAI;QACF,MAAMkE,QAAO,GAAI,MAAM,IAAI,CAACtE,KAAK,CAACoE,GAAG,CAAC,iBAAiB;QACvD,IAAI,CAACjD,YAAW,GAAImD,QAAQ,CAACd,IAAG,IAAK,EAAC;;QAEtC;;QAEA,IAAI,IAAI,CAACrC,YAAY,CAAChB,MAAK,KAAM,CAAC,EAAE;UAClC,IAAI,CAACkF,MAAM,CAACC,GAAG,CAAC;YACdC,QAAQ,EAAE,MAAM;YAChBC,OAAO,EAAE,aAAa;YACtBC,MAAM,EAAE,wBAAwB;YAChCC,IAAI,EAAE;UACR,CAAC;QACH;MACF,EAAE,OAAOd,KAAK,EAAE;QACd,IAAI,CAACzD,YAAW,GAAI,EAAC;QAErB,IAAI,CAACkE,MAAM,CAACC,GAAG,CAAC;UACdC,QAAQ,EAAE,OAAO;UACjBC,OAAO,EAAE,gBAAgB;UACzBC,MAAM,EAAE,gCAAgC;UACxCC,IAAI,EAAE;QACR,CAAC;MACH;IACF,CAAC;IACD9D,UAAUA,CAAC+D,IAAI,EAAE;MACf,IAAI,CAACA,IAAI,EAAE,OAAO,GAAE;MACpB,IAAI;QACF,MAAMC,CAAA,GAAI,IAAIlF,IAAI,CAACiF,IAAI;QACvB,MAAME,GAAE,GAAIxC,MAAM,CAACuC,CAAC,CAACV,OAAO,CAAC,CAAC,CAAC,CAACY,QAAQ,CAAC,CAAC,EAAE,GAAG;QAC/C,MAAMC,KAAI,GAAI1C,MAAM,CAACuC,CAAC,CAACI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAACF,QAAQ,CAAC,CAAC,EAAE,GAAG;QACtD,MAAMG,IAAG,GAAIL,CAAC,CAACM,WAAW,CAAC;QAC3B,OAAO,GAAGL,GAAG,IAAIE,KAAK,IAAIE,IAAI,EAAC;MACjC,EAAE,OAAOrB,KAAK,EAAE;QACd,OAAOe,IAAG;MACZ;IACF,CAAC;IACD5D,UAAUA,CAACoE,IAAI,EAAE;MACf,IAAI,CAACA,IAAI,EAAE,OAAO,GAAE;MACpB,OAAOA,IAAI,CAACC,SAAS,CAAC,CAAC,EAAE,CAAC;IAC5B,CAAC;IACDC,gBAAgBA,CAACV,IAAI,EAAE;MACrB,IAAI,CAACA,IAAG,IAAKW,KAAK,CAACX,IAAI,CAACY,OAAO,CAAC,CAAC,CAAC,EAAE;QAClC,OAAO,IAAI;MACb;;MAEA;MACA,MAAMN,IAAG,GAAIN,IAAI,CAACO,WAAW,CAAC,CAAC;MAC/B,MAAMH,KAAI,GAAI1C,MAAM,CAACsC,IAAI,CAACK,QAAQ,CAAC,IAAI,CAAC,CAAC,CAACF,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;MAC1D,MAAMD,GAAE,GAAIxC,MAAM,CAACsC,IAAI,CAACT,OAAO,CAAC,CAAC,CAAC,CAACY,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;MAEnD,IAAIQ,KAAK,CAACL,IAAI,KAAKK,KAAK,CAACP,KAAK,KAAKO,KAAK,CAACT,GAAG,CAAC,EAAE;QAC7C,OAAO,IAAI;MACb;MAEA,MAAMW,SAAQ,GAAI,GAAGP,IAAI,IAAIF,KAAK,IAAIF,GAAG,EAAE;MAC3C,OAAOW,SAAS;IAClB,CAAC;IACDC,gBAAgBA,CAACN,IAAI,EAAE;MACrB,IAAI,CAACA,IAAI,EAAE,OAAO,IAAG;MACrB,OAAOA,IAAI,CAACO,YAAY,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;IACzC,CAAC;IACDC,cAAcA,CAACpC,MAAM,EAAE;MACrB,MAAMqC,SAAQ,GAAI;QAChB,WAAW,EAAE,cAAc;QAC3B,aAAa,EAAE,sBAAsB;QACrC,SAAS,EAAE;MACb;MACA,MAAMpC,KAAI,GAAIoC,SAAS,CAACrC,MAAM,KAAKA,MAAK;MACxC;MACA,OAAOC,KAAK,CAAClB,OAAO,CAAC,gGAAgG,EAAE,EAAE,CAAC,CAAC/B,IAAI,CAAC;IAClI,CAAC;IACDsF,yBAAyBA,CAAC5D,KAAK,EAAE;MAC/B,MAAMsB,MAAK,GAAI,IAAI,CAACP,aAAa,CAAC8C,IAAI,CAACC,CAAA,IAAKA,CAAC,CAAC9D,KAAI,KAAMA,KAAK;MAC7D,IAAIsB,MAAK,IAAKA,MAAM,CAACC,KAAK,EAAE;QAC1B;QACA,OAAOD,MAAM,CAACC,KAAK,CAAClB,OAAO,CAAC,gGAAgG,EAAE,EAAE,CAAC,CAAC/B,IAAI,CAAC;MACzI;MACA,OAAO0B,KAAI;IACb,CAAC;IACD+D,cAAcA,CAAC/D,KAAK,EAAE;MACpB,MAAMsB,MAAK,GAAI,IAAI,CAACP,aAAa,CAAC8C,IAAI,CAACC,CAAA,IAAKA,CAAC,CAAC9D,KAAI,KAAMA,KAAK;MAC7D,OAAOsB,MAAM,EAAEE,KAAI,IAAK,SAAQ;IAClC,CAAC;IACDwC,gBAAgBA,CAAChE,KAAK,EAAE;MACtB,MAAMR,QAAO,GAAI,IAAI,CAACwB,eAAe,CAAC6C,IAAI,CAACI,CAAA,IAAKA,CAAC,CAACjE,KAAI,KAAMA,KAAK;MACjE,IAAIR,QAAO,IAAKA,QAAQ,CAAC+B,KAAK,EAAE;QAC9B;QACA,OAAO/B,QAAQ,CAAC+B,KAAK,CAAClB,OAAO,CAAC,gGAAgG,EAAE,EAAE,CAAC,CAAC/B,IAAI,CAAC;MAC3I;MACA,OAAO0B,KAAI,IAAK,WAAU;IAC5B,CAAC;IACDkE,gBAAgBA,CAAClE,KAAK,EAAE;MACtB,MAAMR,QAAO,GAAI,IAAI,CAACwB,eAAe,CAAC6C,IAAI,CAACI,CAAA,IAAKA,CAAC,CAACjE,KAAI,KAAMA,KAAK;MACjE,OAAOR,QAAQ,EAAEgC,KAAI,IAAK,SAAQ;IACpC,CAAC;IACD2C,mBAAmBA,CAAA,EAAG;MACpB,OAAO,UAAS;IAClB,CAAC;IACDC,QAAQA,CAAC5F,MAAM,EAAE;MACf,OAAOA,MAAM,CAAC6F,KAAI,IAAK1H,KAAK,CAAC2H,OAAO,CAAC9F,MAAM,CAAC6F,KAAK,KAAK7F,MAAM,CAAC6F,KAAK,CAACpH,MAAK,GAAI;IAC9E,CAAC;IACDsH,aAAaA,CAAC/F,MAAM,EAAE;MACpB,IAAI,IAAI,CAAC4F,QAAQ,CAAC5F,MAAM,CAAC,EAAE;QACzB,IAAI,CAACkC,mBAAkB,GAAIlC,MAAM,CAAC6F,KAAI;QACtC,IAAI,CAAC5D,WAAU,GAAI,IAAG;MACxB;IACF,CAAC;IACD+D,YAAYA,CAACC,QAAQ,EAAE;MACrB;MACA,MAAMC,IAAG,GAAIC,QAAQ,CAACC,aAAa,CAAC,GAAG;MACvCF,IAAI,CAACG,IAAG,GAAI,uBAAuBJ,QAAQ,EAAC;MAC5CC,IAAI,CAACI,QAAO,GAAIL,QAAO;MACvBC,IAAI,CAACK,MAAK,GAAI,QAAO;MACrBJ,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACP,IAAI;MAC9BA,IAAI,CAACQ,KAAK,CAAC;MACXP,QAAQ,CAACK,IAAI,CAACG,WAAW,CAACT,IAAI;IAChC,CAAC;IACDU,UAAUA,CAAC5G,MAAM,EAAE;MAEjB;MACA,IAAIqD,QAAO,GAAI,IAAIrE,IAAI,CAAC,CAAC;MACzB,IAAIgB,MAAM,CAACG,SAAS,EAAE;QACpB;QACA;QACA,MAAM0G,QAAO,GAAI7G,MAAM,CAACG,SAAS,CAAC8E,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAC/C,MAAM,CAACV,IAAI,EAAEF,KAAK,EAAEF,GAAG,IAAI0C,QAAQ,CAAC5B,KAAK,CAAC,GAAG,CAAC,CAACpC,GAAG,CAACiE,MAAM,CAAC;;QAE1D;QACAzD,QAAO,GAAI,IAAIrE,IAAI,CAACuF,IAAI,EAAEF,KAAI,GAAI,CAAC,EAAEF,GAAG,CAAC;;QAEzC;QACAd,QAAQ,CAACE,OAAO,CAACF,QAAQ,CAACG,OAAO,CAAC,IAAI,CAAC,CAAC;MAE1C;MAGA,IAAI,CAACpB,YAAW,GAAI;QAClB3B,EAAE,EAAET,MAAM,CAACS,EAAE;QACbN,SAAS,EAAEkD,QAAQ;QACnB/C,UAAU,EAAE,IAAI,CAACyG,SAAS,CAAC/G,MAAM,CAACM,UAAU,CAAC;QAC7CC,QAAQ,EAAE,IAAI,CAACwG,SAAS,CAAC/G,MAAM,CAACO,QAAQ,CAAC;QACzCO,WAAW,EAAEd,MAAM,CAACc,WAAW;QAC/BC,QAAQ,EAAEf,MAAM,CAACe,QAAO,IAAK,EAAE;QAC/BE,gBAAgB,EAAEjB,MAAM,CAACiB,gBAAe,IAAK,EAAE;QAC/CoB,aAAa,EAAE,CAAC,IAAIrC,MAAM,CAAC6F,KAAI,IAAK,EAAE,CAAC,CAAC;QACxCvD,QAAQ,EAAE;MACZ;MACA,IAAI,CAACH,UAAS,GAAI,IAAG;IACvB,CAAC;IACD4E,SAASA,CAACC,UAAU,EAAE;MACpB,IAAI,CAACA,UAAU,EAAE,OAAO,IAAG;MAC3B,MAAM,CAACC,KAAK,EAAEC,OAAO,EAAEC,OAAO,IAAIH,UAAU,CAAC/B,KAAK,CAAC,GAAG;MACtD,MAAMhB,IAAG,GAAI,IAAIjF,IAAI,CAAC;MACtBiF,IAAI,CAACR,QAAQ,CAAC2D,QAAQ,CAACH,KAAK,CAAC,EAAEG,QAAQ,CAACF,OAAO,CAAC,EAAEE,QAAQ,CAACD,OAAM,IAAK,CAAC,CAAC;MACxE,OAAOlD,IAAG;IACZ,CAAC;IACDoD,oBAAoBA,CAACC,KAAK,EAAE;MAC1B,MAAMzB,KAAI,GAAI1H,KAAK,CAACoJ,IAAI,CAACD,KAAK,CAACf,MAAM,CAACV,KAAK;MAC3C,IAAI,CAACzD,YAAY,CAACE,QAAO,GAAI,CAAC,GAAG,IAAI,CAACF,YAAY,CAACE,QAAQ,EAAE,GAAGuD,KAAK;IACvE,CAAC;IACD2B,kBAAkBA,CAACC,KAAK,EAAE;MACxB,IAAI,CAACrF,YAAY,CAACC,aAAa,CAACqF,MAAM,CAACD,KAAK,EAAE,CAAC;IACjD,CAAC;IACDE,aAAaA,CAACF,KAAK,EAAE;MACnB,IAAI,CAACrF,YAAY,CAACE,QAAQ,CAACoF,MAAM,CAACD,KAAK,EAAE,CAAC;IAC5C,CAAC;IACD,MAAMG,cAAcA,CAAA,EAAG;MACrB,IAAI,IAAI,CAACxF,YAAY,CAACE,QAAQ,CAAC7D,MAAK,KAAM,CAAC,EAAE,OAAO,EAAC;MAErD,MAAMoJ,QAAO,GAAI,IAAIC,QAAQ,CAAC;MAC9B,IAAI,CAAC1F,YAAY,CAACE,QAAQ,CAACyF,OAAO,CAACC,IAAG,IAAK;QACzCH,QAAQ,CAACI,MAAM,CAAC,OAAO,EAAED,IAAI;MAC/B,CAAC;MAED,IAAI;QACF,MAAMpF,QAAO,GAAI,MAAM,IAAI,CAACtE,KAAK,CAAC4J,IAAI,CAAC,mBAAmB,EAAEL,QAAQ,EAAE;UACpEM,OAAO,EAAE;YAAE,cAAc,EAAE;UAAsB;QACnD,CAAC;QACD,OAAOvF,QAAQ,CAACd,IAAI,CAAC+D,KAAI,IAAK,EAAC;MACjC,EAAE,OAAO3C,KAAK,EAAE;QACd,OAAO,EAAC;MACV;IACF,CAAC;IACD,MAAMkF,YAAYA,CAAA,EAAG;MACnB,IAAI;QACF;QACA,IAAI,CAAC,IAAI,CAAChG,YAAY,CAACjC,SAAQ,IAAKyE,KAAK,CAAC,IAAI,CAACxC,YAAY,CAACjC,SAAS,CAAC0E,OAAO,CAAC,CAAC,CAAC,EAAE;UAChF,IAAI,CAAClB,MAAM,CAACC,GAAG,CAAC;YACdC,QAAQ,EAAE,OAAO;YACjBC,OAAO,EAAE,YAAY;YACrBC,MAAM,EAAE,uCAAuC;YAC/CC,IAAI,EAAE;UACR,CAAC;UACD;QACF;;QAEA;QACA,IAAI,IAAI,CAAC5B,YAAY,CAAC9B,UAAS,IAAK,IAAI,CAAC8B,YAAY,CAAC7B,QAAQ,EAAE;UAC9D,IAAI,IAAIvB,IAAI,CAAC,IAAI,CAACoD,YAAY,CAAC7B,QAAQ,KAAK,IAAIvB,IAAI,CAAC,IAAI,CAACoD,YAAY,CAAC9B,UAAU,CAAC,EAAE;YAClF,IAAI,CAACqD,MAAM,CAACC,GAAG,CAAC;cACdC,QAAQ,EAAE,OAAO;cACjBC,OAAO,EAAE,YAAY;cACrBC,MAAM,EAAE,oCAAoC;cAC5CC,IAAI,EAAE;YACR,CAAC;YACD;UACF;QACF;;QAEA;QACA,MAAMqE,gBAAe,GAAI,MAAM,IAAI,CAACT,cAAc,CAAC;;QAEnD;QACA,MAAMU,QAAO,GAAI,CAAC,GAAG,IAAI,CAAClG,YAAY,CAACC,aAAa,EAAE,GAAGgG,gBAAgB;QAEzE,MAAMpI,aAAY,GAAI,IAAI,CAAC0E,gBAAgB,CAAC,IAAI,CAACvC,YAAY,CAACjC,SAAS;QAEvE,IAAI,CAACF,aAAa,EAAE;UAClB,IAAI,CAAC0D,MAAM,CAACC,GAAG,CAAC;YACdC,QAAQ,EAAE,OAAO;YACjBC,OAAO,EAAE,YAAY;YACrBC,MAAM,EAAE,6CAA6C;YACrDC,IAAI,EAAE;UACR,CAAC;UACD;QACF;QAEA,MAAMuE,UAAS,GAAI;UACjBpI,SAAS,EAAEF,aAAa;UACxBK,UAAU,EAAE,IAAI,CAACyE,gBAAgB,CAAC,IAAI,CAAC3C,YAAY,CAAC9B,UAAU,CAAC;UAC/DC,QAAQ,EAAE,IAAI,CAACwE,gBAAgB,CAAC,IAAI,CAAC3C,YAAY,CAAC7B,QAAQ,CAAC;UAC3DO,WAAW,EAAE,IAAI,CAACsB,YAAY,CAACtB,WAAW;UAC1CC,QAAQ,EAAE,IAAI,CAACqB,YAAY,CAACrB,QAAQ;UACpCE,gBAAgB,EAAE,IAAI,CAACmB,YAAY,CAACnB,gBAAgB;UACpD4E,KAAK,EAAEyC;QACT;QAGA,MAAM,IAAI,CAAChK,KAAK,CAACkK,GAAG,CAAC,mBAAmB,IAAI,CAACpG,YAAY,CAAC3B,EAAE,EAAE,EAAE8H,UAAU;QAE1E,IAAI,CAAC5E,MAAM,CAACC,GAAG,CAAC;UACdC,QAAQ,EAAE,SAAS;UACnBC,OAAO,EAAE,QAAQ;UACjBC,MAAM,EAAE,6BAA6B;UACrCC,IAAI,EAAE;QACR,CAAC;QAED,IAAI,CAAC7B,UAAS,GAAI,KAAI;;QAEtB;QACA,MAAM,IAAI,CAACzD,eAAe,CAAC;;QAE3B;QACA,IAAI,CAACU,KAAK,CAAC,gBAAgB;;QAE3B;QACAF,MAAM,CAACuJ,aAAa,CAAC,IAAIC,WAAW,CAAC,mBAAmB,CAAC;QACzDxJ,MAAM,CAACuJ,aAAa,CAAC,IAAIC,WAAW,CAAC,mBAAmB,CAAC;MAE3D,EAAE,OAAOxF,KAAK,EAAE;QACd,IAAI,CAACS,MAAM,CAACC,GAAG,CAAC;UACdC,QAAQ,EAAE,OAAO;UACjBC,OAAO,EAAE,gBAAgB;UACzBC,MAAM,EAAEb,KAAK,CAACN,QAAQ,EAAEd,IAAI,EAAEoB,KAAI,IAAK,4BAA4B;UACnEc,IAAI,EAAE;QACR,CAAC;MACH;IACF,CAAC;IACD2E,WAAWA,CAAC3I,MAAM,EAAE;MAClB,IAAI,CAACgC,cAAa,GAAIhC,MAAK;MAC3B,IAAI,CAAC+B,YAAW,GAAI,IAAG;IACzB,CAAC;IACD;IACA6G,YAAYA,CAACC,IAAI,EAAEC,SAAS,EAAE;MAC5B,IAAI,CAACD,IAAI,EAAE,OAAO,GAAE;MACpB,IAAIA,IAAI,CAACpK,MAAK,IAAKqK,SAAS,EAAE,OAAOD,IAAG;MACxC,OAAOA,IAAI,CAACnE,SAAS,CAAC,CAAC,EAAEoE,SAAS,IAAI,KAAI;IAC5C,CAAC;IACD;IACA,MAAMC,WAAWA,CAAA,EAAG;MAClB,MAAM,IAAI,CAACrK,eAAe,CAAC;IAC7B,CAAC;IACD;IACAsK,cAAcA,CAAChJ,MAAM,EAAE;MACrB,MAAMiJ,QAAO,GAAI,CAAC,IAAI,EAAE,WAAW,EAAE,aAAa;MAClD,MAAMC,OAAM,GAAID,QAAQ,CAAClJ,MAAM,CAACoJ,KAAI,IAAK,CAACnJ,MAAM,CAACmJ,KAAK,CAAC;MAEvD,IAAID,OAAO,CAACzK,MAAK,GAAI,CAAC,EAAE;QACtB,OAAO,KAAI;MACb;MACA,OAAO,IAAG;IACZ;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}