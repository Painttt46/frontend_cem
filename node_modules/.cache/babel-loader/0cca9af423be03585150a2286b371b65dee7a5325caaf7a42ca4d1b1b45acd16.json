{"ast":null,"code":"import AutoComplete from 'primevue/autocomplete';\nimport Dropdown from 'primevue/dropdown';\nimport axios from '@/utils/axiosConfig';\nimport { isActive } from '@/utils/statusHelper';\nexport default {\n  name: 'BookingFormPrime',\n  components: {\n    AutoComplete,\n    Dropdown\n  },\n  emits: ['close-form', 'submit-borrow', 'submit-return', 'submit-cancel', 'handle-image-upload', 'remove-image', 'update-borrow-form', 'updateReturnForm', 'update-cancel-form'],\n  props: {\n    showForm: Boolean,\n    selectedDate: Date,\n    activeForm: String,\n    borrowForm: Object,\n    returnForm: Object,\n    cancelForm: Object,\n    availableBorrows: Array,\n    pendingBorrows: Array,\n    currentReturnTime: String,\n    selectedBorrowProject: String,\n    selectedBorrowDescription: String\n  },\n  data() {\n    return {\n      selectedReturnBorrow: '',\n      selectedCancelBorrow: '',\n      showConfirm: false,\n      confirmMessage: '',\n      pendingAction: null,\n      users: [],\n      filteredUsers: [],\n      maxDisplayUsers: 50,\n      selectedColleague: null,\n      projectOptions: []\n    };\n  },\n  async created() {\n    this.$http = axios;\n    await this.loadUsers();\n    await this.loadProjects();\n    this.filteredUsers = this.users.slice(0, this.maxDisplayUsers);\n  },\n  computed: {\n    currentUserName() {\n      const firstName = localStorage.getItem('soc_firstname') || '';\n      const lastName = localStorage.getItem('soc_lastname') || '';\n      return `${firstName} ${lastName}`.trim();\n    },\n    formattedAvailableBorrows() {\n      return this.availableBorrows.map(borrow => ({\n        id: borrow.id,\n        displayText: `${borrow.id} - ${borrow.name} (${borrow.project}) - ${this.formatDate(borrow.selected_date)} ${borrow.time}`\n      }));\n    },\n    formattedPendingBorrows() {\n      return this.pendingBorrows.map(borrow => ({\n        id: borrow.id,\n        displayText: `${borrow.id} - ${borrow.name} (${borrow.project}) - ${this.formatDate(borrow.selected_date)} ${borrow.time}`\n      }));\n    },\n    selectedProject: {\n      get() {\n        return this.borrowForm.project;\n      },\n      set(value) {\n        this.$emit('update-borrow-form', {\n          field: 'project',\n          value\n        });\n      }\n    }\n  },\n  watch: {\n    selectedReturnBorrow(newVal) {\n      this.$emit('updateReturnForm', 'borrowId', newVal);\n      if (newVal && this.selectedBorrowDescription) {\n        this.$emit('updateReturnForm', 'discription', this.selectedBorrowDescription);\n      }\n    },\n    selectedCancelBorrow(newVal) {\n      this.$emit('update-cancel-form', {\n        field: 'borrowId',\n        value: newVal\n      });\n    }\n  },\n  methods: {\n    getImagePreview(image) {\n      if (image instanceof File) {\n        return URL.createObjectURL(image);\n      }\n      return image;\n    },\n    triggerBorrowUpload() {\n      this.$refs.borrowFileInput.value = '';\n      this.$refs.borrowFileInput.click();\n    },\n    triggerReturnUpload() {\n      this.$refs.returnFileInput.value = '';\n      this.$refs.returnFileInput.click();\n    },\n    handleBorrowUpload(event) {\n      this.$emit('handle-image-upload', event, 'borrow');\n      event.target.value = '';\n    },\n    handleReturnUpload(event) {\n      this.$emit('handle-image-upload', event, 'return');\n      event.target.value = '';\n    },\n    async loadProjects() {\n      try {\n        const response = await this.$http.get('/api/tasks');\n        if (response.data && Array.isArray(response.data)) {\n          this.projectOptions = response.data.filter(task => isActive(task.status)).map(task => ({\n            label: task.task_name,\n            value: task.task_name\n          }));\n        }\n      } catch {// ignore\n      }\n    },\n    async loadUsers() {\n      try {\n        const response = await this.$http.get('/api/users');\n        if (response.data && Array.isArray(response.data)) {\n          // กรองผู้ใช้ปัจจุบันออก\n          const currentUserName = this.currentUserName;\n          this.users = response.data.filter(user => {\n            const userName = `${user.firstname} ${user.lastname}`.trim();\n            return userName !== currentUserName;\n          }).map(user => ({\n            ...user,\n            displayName: `${user.firstname} ${user.lastname}`.trim()\n          }));\n          this.filteredUsers = this.users.slice(0, this.maxDisplayUsers);\n        }\n      } catch {// ignore\n      }\n    },\n    searchUsers(event) {\n      const query = event.query.toLowerCase().trim();\n\n      // Get already selected colleagues\n      const selectedColleagues = this.borrowForm?.colleagues || [];\n      const selectedNames = selectedColleagues.map(c => c.name);\n\n      // Filter out already selected colleagues\n      let availableUsers = this.users.filter(user => !selectedNames.includes(user.displayName));\n      if (query === '') {\n        this.filteredUsers = availableUsers.slice(0, this.maxDisplayUsers);\n      } else {\n        const filtered = availableUsers.filter(user => user.displayName.toLowerCase().includes(query) || user.username.toLowerCase().includes(query) || user.position && user.position.toLowerCase().includes(query) || user.department && user.department.toLowerCase().includes(query));\n        this.filteredUsers = filtered.slice(0, this.maxDisplayUsers);\n      }\n    },\n    showAllUsers() {\n      // Get already selected colleagues\n      const selectedColleagues = this.borrowForm?.colleagues || [];\n      const selectedNames = selectedColleagues.map(c => c.name);\n\n      // Filter out already selected colleagues\n      const availableUsers = this.users.filter(user => !selectedNames.includes(user.displayName));\n      this.filteredUsers = availableUsers.slice(0, this.maxDisplayUsers);\n    },\n    onColleagueSelect(event) {\n      const user = event.value;\n      if (user && user.displayName) {\n        // ตรวจสอบว่าไม่ได้เลือกซ้ำ\n        const colleagues = this.borrowForm?.colleagues || [];\n        const alreadySelected = colleagues.some(c => c.name === user.displayName);\n        if (!alreadySelected) {\n          const newColleagues = [...colleagues, {\n            name: user.displayName,\n            position: user.position || '',\n            department: user.department || ''\n          }];\n          this.$emit('update-borrow-form', {\n            field: 'colleagues',\n            value: newColleagues\n          });\n        }\n\n        // Clear selection\n        this.selectedColleague = null;\n      }\n    },\n    removeColleague(index) {\n      const colleagues = [...(this.borrowForm?.colleagues || [])];\n      colleagues.splice(index, 1);\n      this.$emit('update-borrow-form', {\n        field: 'colleagues',\n        value: colleagues\n      });\n    },\n    getFormTitle() {\n      const titles = {\n        borrow: 'แจ้งใช้รถ',\n        return: 'แจ้งคืนรถ',\n        cancel: 'ยกเลิกการจอง'\n      };\n      return titles[this.activeForm] || 'ฟอร์ม';\n    },\n    handleDialogClose() {\n      this.$emit('close-form');\n    },\n    confirmSubmit(type) {\n      const messages = {\n        borrow: 'ยืนยันการแจ้งใช้รถ?',\n        return: 'ยืนยันการแจ้งคืนรถ?',\n        cancel: 'ยืนยันการยกเลิกการจอง?'\n      };\n      this.confirmMessage = messages[type];\n      this.pendingAction = type;\n      this.showConfirm = true;\n    },\n    handleConfirm() {\n      this.showConfirm = false;\n      if (this.pendingAction === 'borrow') {\n        this.$emit('submit-borrow');\n      } else if (this.pendingAction === 'return') {\n        this.$emit('submit-return');\n      } else if (this.pendingAction === 'cancel') {\n        this.$emit('submit-cancel');\n      }\n      this.pendingAction = null;\n    },\n    updateBorrowForm(field, value) {\n      this.$emit('update-borrow-form', {\n        field,\n        value\n      });\n    },\n    updateReturnForm(field, value) {\n      this.$emit('update-return-form', {\n        field,\n        value\n      });\n    },\n    updateCancelForm(field, value) {\n      this.$emit('update-cancel-form', {\n        field,\n        value\n      });\n    },\n    formatDate(date) {\n      return new Date(date).toLocaleDateString('th-TH', {\n        day: '2-digit',\n        month: '2-digit',\n        year: 'numeric'\n      });\n    }\n  }\n};","map":{"version":3,"names":["AutoComplete","Dropdown","axios","isActive","name","components","emits","props","showForm","Boolean","selectedDate","Date","activeForm","String","borrowForm","Object","returnForm","cancelForm","availableBorrows","Array","pendingBorrows","currentReturnTime","selectedBorrowProject","selectedBorrowDescription","data","selectedReturnBorrow","selectedCancelBorrow","showConfirm","confirmMessage","pendingAction","users","filteredUsers","maxDisplayUsers","selectedColleague","projectOptions","created","$http","loadUsers","loadProjects","slice","computed","currentUserName","firstName","localStorage","getItem","lastName","trim","formattedAvailableBorrows","map","borrow","id","displayText","project","formatDate","selected_date","time","formattedPendingBorrows","selectedProject","get","set","value","$emit","field","watch","newVal","methods","getImagePreview","image","File","URL","createObjectURL","triggerBorrowUpload","$refs","borrowFileInput","click","triggerReturnUpload","returnFileInput","handleBorrowUpload","event","target","handleReturnUpload","response","isArray","filter","task","status","label","task_name","user","userName","firstname","lastname","displayName","searchUsers","query","toLowerCase","selectedColleagues","colleagues","selectedNames","c","availableUsers","includes","filtered","username","position","department","showAllUsers","onColleagueSelect","alreadySelected","some","newColleagues","removeColleague","index","splice","getFormTitle","titles","return","cancel","handleDialogClose","confirmSubmit","type","messages","handleConfirm","updateBorrowForm","updateReturnForm","updateCancelForm","date","toLocaleDateString","day","month","year"],"sources":["D:\\frontend_cem\\src\\views\\car_booking\\BookingFormPrime.vue"],"sourcesContent":["<template>\n  <Dialog :visible=\"showForm\" modal :header=\"getFormTitle()\" :style=\"{ width: '90vw', maxWidth: '700px' }\"\n    @update:visible=\"handleDialogClose\" :closable=\"true\" :draggable=\"false\" class=\"corporate-dialog\">\n    <div class=\"p-fluid dialog-content\">\n      <!-- แจ้งใช้รถ -->\n      <form v-if=\"activeForm === 'borrow'\" @submit.prevent=\"confirmSubmit('borrow')\" class=\"form-container\">\n        <div class=\"form-grid\">\n          <div class=\"input-group\">\n            <label for=\"name\" class=\"input-label\">ชื่อ-นามสกุล</label>\n            <InputText id=\"name\" :value=\"currentUserName\" readonly class=\"corporate-input readonly-field\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"license\" class=\"input-label\">ทะเบียนรถ</label>\n            <InputText id=\"license\" :value=\"borrowForm.license\" readonly class=\"corporate-input readonly-field\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"time\" class=\"input-label\">เวลา *</label>\n            <InputText id=\"time\" :value=\"borrowForm.time\" @input=\"updateBorrowForm('time', $event.target.value)\"\n              type=\"time\" required class=\"corporate-input\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"location\" class=\"input-label\">สถานที่ *</label>\n            <InputText id=\"location\" :value=\"borrowForm.location\"\n              @input=\"updateBorrowForm('location', $event.target.value)\" required class=\"corporate-input\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"project\" class=\"input-label\">โครงการ *</label>\n            <Dropdown id=\"project\" v-model=\"selectedProject\" :options=\"projectOptions\" \n              optionLabel=\"label\" optionValue=\"value\" placeholder=\"เลือกโครงการ\"\n              required class=\"corporate-input\" filter />\n          </div>\n\n\n\n          <div class=\"input-group\">\n            <label for=\"description\" class=\"input-label\">ข้อมูลเพิ่มเติม</label>\n            <Textarea \n              id=\"description\" \n              :value=\"borrowForm.discription\" \n              @input=\"$emit('update-borrow-form', { field: 'discription', value: $event.target.value })\"\n              placeholder=\"ระบุข้อมูลเพิ่มเติม (ถ้ามี)\"\n              rows=\"3\"\n              class=\"corporate-input\"\n            />\n          </div>\n\n          <div class=\"input-group full-width\">\n            <label class=\"input-label\">ผู้ร่วมงาน</label>\n            <div class=\"colleagues-section\">\n              <div class=\"colleague-search\">\n                <AutoComplete v-model=\"selectedColleague\" :suggestions=\"filteredUsers\" @complete=\"searchUsers\"\n                  @item-select=\"onColleagueSelect\" @dropdown-click=\"showAllUsers\" optionLabel=\"displayName\"\n                  placeholder=\"ค้นหาหรือเลือกผู้ร่วมงาน...\" class=\"corporate-input\" :dropdown=\"true\"\n                  :forceSelection=\"false\" :scrollHeight=\"200\">\n                  <template #option=\"slotProps\">\n                    <div class=\"user-option\">\n                      <div class=\"user-name\">{{ slotProps.option.displayName }}</div>\n                      <div class=\"user-role\">{{ slotProps.option.position }} - {{ slotProps.option.department }}</div>\n                    </div>\n                  </template>\n                </AutoComplete>\n              </div>\n\n              <div v-if=\"borrowForm.colleagues && borrowForm.colleagues.length > 0\" class=\"selected-colleagues\">\n                <h6 class=\"colleagues-title\">ผู้ร่วมงานที่เลือก:</h6>\n                <div class=\"colleagues-list\">\n                  <div v-for=\"(colleague, index) in borrowForm.colleagues\" :key=\"index\" class=\"colleague-card\">\n                    <div class=\"colleague-details\">\n                      <div class=\"colleague-name\">{{ colleague.name }}</div>\n                      <div class=\"colleague-position\">\n                        <i class=\"pi pi-briefcase\"></i>\n                        {{ colleague.position }}\n                      </div>\n                      <div class=\"colleague-department\">\n                        <i class=\"pi pi-building\"></i>\n                        {{ colleague.department }}\n                      </div>\n                    </div>\n                    <Button type=\"button\" icon=\"pi pi-times\" severity=\"danger\" text rounded size=\"small\"\n                      @click=\"removeColleague(index)\" class=\"remove-btn\" />\n                  </div>\n                </div>\n              </div>\n\n              <div v-else class=\"no-colleagues\">\n                <i class=\"pi pi-users\"></i>\n                <span>ยังไม่มีผู้ร่วมงาน</span>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"file-upload-section\">\n            <label class=\"upload-label\">รูปภาพ</label>\n            <div class=\"file-upload-wrapper\">\n              <input ref=\"borrowFileInput\" @change=\"handleBorrowUpload\" type=\"file\"\n                accept=\"image/*\" multiple class=\"file-input\">\n              <Button type=\"button\"\n                :label=\"borrowForm.images?.length > 0 ? `เลือกแล้ว ${borrowForm.images.length} รูป` : 'เลือกรูปภาพ'\"\n                icon=\"pi pi-upload\" severity=\"secondary\" outlined @click=\"triggerBorrowUpload\" />\n            </div>\n            <div v-if=\"borrowForm.images?.length > 0\" class=\"image-preview-list\">\n              <div v-for=\"(image, index) in borrowForm.images\" :key=\"index\" class=\"image-preview-item\">\n                <img :src=\"getImagePreview(image)\" alt=\"preview\" class=\"preview-img\" />\n                <span class=\"remove-btn\" @click=\"$emit('remove-image', index, 'borrow')\">\n                  <i class=\"pi pi-times\"></i>\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <Divider />\n\n        <div class=\"form-actions\">\n          <Button type=\"button\" label=\"ยกเลิก\" icon=\"pi pi-times\" severity=\"secondary\" outlined\n            @click=\"handleDialogClose\" />\n          <Button type=\"submit\" label=\"บันทึกการแจ้งใช้รถ\" icon=\"pi pi-check\" severity=\"success\" />\n        </div>\n      </form>\n\n      <!-- แจ้งคืนรถ -->\n      <form v-if=\"activeForm === 'return'\" @submit.prevent=\"confirmSubmit('return')\" class=\"form-container\">\n        <div class=\"form-grid\">\n          <div class=\"input-group full-width\">\n            <label class=\"input-label\">เลือกการแจ้งใช้รถที่ต้องการคืน *</label>\n            <Dropdown v-model=\"selectedReturnBorrow\" :options=\"formattedAvailableBorrows\" optionLabel=\"displayText\"\n              optionValue=\"id\" class=\"corporate-dropdown\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"returnName\" class=\"input-label\">ชื่อ-นามสกุล</label>\n            <InputText id=\"returnName\" :value=\"currentUserName\" readonly class=\"corporate-input readonly-field\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"returnLicense\" class=\"input-label\">ทะเบียนรถ</label>\n            <InputText id=\"returnLicense\" :value=\"returnForm.license\" readonly class=\"corporate-input readonly-field\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"returnTime\" class=\"input-label\">เวลาคืนรถ</label>\n            <InputText id=\"returnTime\" :value=\"currentReturnTime\" readonly class=\"corporate-input readonly-field\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"returnLocation\" class=\"input-label\">สถานที่คืนรถ *</label>\n            <InputText id=\"returnLocation\" :value=\"returnForm.location\"\n              @input=\"$emit('updateReturnForm', 'location', $event.target.value)\" required class=\"corporate-input\" />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"returnDescription\" class=\"input-label\">ข้อมูลเพิ่มเติม</label>\n            <Textarea \n              id=\"returnDescription\" \n              :value=\"returnForm.discription || selectedBorrowDescription\" \n              @input=\"$emit('updateReturnForm', 'discription', $event.target.value)\"\n              :disabled=\"!selectedReturnBorrow\"\n              placeholder=\"กรุณาเลือกการแจ้งใช้รถที่ต้องการคืนก่อน\"\n              rows=\"3\"\n              class=\"corporate-input\"\n            />\n          </div>\n\n          <div class=\"input-group\">\n            <label for=\"returnProject\" class=\"input-label\">โครงการ</label>\n            <InputText id=\"returnProject\" :value=\"selectedBorrowProject\" readonly\n              class=\"corporate-input readonly-field\" />\n          </div>\n\n          <div class=\"file-upload-section\">\n            <label class=\"upload-label\">รูปภาพ</label>\n            <div class=\"file-upload-wrapper\">\n              <input ref=\"returnFileInput\" @change=\"handleReturnUpload\" type=\"file\"\n                accept=\"image/*\" multiple class=\"file-input\">\n              <Button type=\"button\"\n                :label=\"returnForm.images?.length > 0 ? `เลือกแล้ว ${returnForm.images.length} รูป` : 'เลือกรูปภาพ'\"\n                icon=\"pi pi-upload\" severity=\"secondary\" outlined @click=\"triggerReturnUpload\" />\n            </div>\n            <div v-if=\"returnForm.images?.length > 0\" class=\"image-preview-list\">\n              <div v-for=\"(image, index) in returnForm.images\" :key=\"index\" class=\"image-preview-item\">\n                <img :src=\"getImagePreview(image)\" alt=\"preview\" class=\"preview-img\" />\n                <span class=\"remove-btn\" @click=\"$emit('remove-image', index, 'return')\">\n                  <i class=\"pi pi-times\"></i>\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <Divider />\n\n        <div class=\"form-actions\">\n          <Button type=\"button\" label=\"ยกเลิก\" icon=\"pi pi-times\" severity=\"secondary\" outlined\n            @click=\"handleDialogClose\" />\n          <Button type=\"submit\" label=\"บันทึกการแจ้งคืนรถ\" icon=\"pi pi-check\" severity=\"success\" />\n        </div>\n      </form>\n\n      <!-- ยกเลิกการจอง -->\n      <form v-if=\"activeForm === 'cancel'\" @submit.prevent=\"confirmSubmit('cancel')\" class=\"form-container\">\n        <div class=\"form-grid\">\n          <div class=\"input-group full-width\">\n            <label class=\"input-label\">เลือกการจองที่ต้องการยกเลิก *</label>\n            <Dropdown v-model=\"selectedCancelBorrow\" :options=\"formattedPendingBorrows\" optionLabel=\"displayText\"\n              optionValue=\"id\" class=\"corporate-dropdown\" />\n          </div>\n        </div>\n\n        <Divider />\n\n        <div class=\"form-actions\">\n          <Button type=\"button\" label=\"ยกเลิก\" icon=\"pi pi-times\" severity=\"secondary\" outlined\n            @click=\"handleDialogClose\" />\n          <Button type=\"submit\" label=\"ยืนยันการยกเลิก\" icon=\"pi pi-trash\" severity=\"danger\" />\n        </div>\n      </form>\n    </div>\n  </Dialog>\n\n  <!-- Confirmation Dialog -->\n  <Dialog :visible=\"showConfirm\" modal header=\"ยืนยันการดำเนินการ\" :style=\"{ width: '90vw', maxWidth: '450px' }\" :closable=\"false\"\n    :draggable=\"false\" class=\"confirm-dialog\">\n    <div class=\"confirm-content\">\n      <div class=\"confirm-icon\">\n        <i class=\"pi pi-question-circle\"></i>\n      </div>\n      <p class=\"confirm-message\">{{ confirmMessage }}</p>\n      <div class=\"confirm-buttons\">\n        <Button @click=\"handleConfirm\" label=\"ยืนยัน\" icon=\"pi pi-check\" severity=\"success\" />\n        <Button @click=\"showConfirm = false\" label=\"ยกเลิก\" icon=\"pi pi-times\" severity=\"secondary\" outlined />\n      </div>\n    </div>\n  </Dialog>\n</template>\n\n<script>\nimport AutoComplete from 'primevue/autocomplete'\nimport Dropdown from 'primevue/dropdown'\nimport axios from '@/utils/axiosConfig'\nimport { isActive } from '@/utils/statusHelper'\n\nexport default {\n  name: 'BookingFormPrime',\n  components: {\n    AutoComplete,\n    Dropdown\n  },\n  emits: ['close-form', 'submit-borrow', 'submit-return', 'submit-cancel', 'handle-image-upload', 'remove-image', 'update-borrow-form', 'updateReturnForm', 'update-cancel-form'],\n  props: {\n    showForm: Boolean,\n    selectedDate: Date,\n    activeForm: String,\n    borrowForm: Object,\n    returnForm: Object,\n    cancelForm: Object,\n    availableBorrows: Array,\n    pendingBorrows: Array,\n    currentReturnTime: String,\n    selectedBorrowProject: String,\n    selectedBorrowDescription: String\n  },\n  data() {\n    return {\n      selectedReturnBorrow: '',\n      selectedCancelBorrow: '',\n      showConfirm: false,\n      confirmMessage: '',\n      pendingAction: null,\n      users: [],\n      filteredUsers: [],\n      maxDisplayUsers: 50,\n      selectedColleague: null,\n      projectOptions: []\n    }\n  },\n  async created() {\n    this.$http = axios\n    await this.loadUsers();\n    await this.loadProjects();\n    this.filteredUsers = this.users.slice(0, this.maxDisplayUsers);\n  },\n  computed: {\n    currentUserName() {\n      const firstName = localStorage.getItem('soc_firstname') || ''\n      const lastName = localStorage.getItem('soc_lastname') || ''\n      return `${firstName} ${lastName}`.trim()\n    },\n    formattedAvailableBorrows() {\n      return this.availableBorrows.map(borrow => ({\n        id: borrow.id,\n        displayText: `${borrow.id} - ${borrow.name} (${borrow.project}) - ${this.formatDate(borrow.selected_date)} ${borrow.time}`\n      }))\n    },\n    formattedPendingBorrows() {\n      return this.pendingBorrows.map(borrow => ({\n        id: borrow.id,\n        displayText: `${borrow.id} - ${borrow.name} (${borrow.project}) - ${this.formatDate(borrow.selected_date)} ${borrow.time}`\n      }))\n    },\n    selectedProject: {\n      get() {\n        return this.borrowForm.project\n      },\n      set(value) {\n        this.$emit('update-borrow-form', { field: 'project', value })\n      }\n    }\n  },\n  watch: {\n    selectedReturnBorrow(newVal) {\n      this.$emit('updateReturnForm', 'borrowId', newVal)\n      if (newVal && this.selectedBorrowDescription) {\n        this.$emit('updateReturnForm', 'discription', this.selectedBorrowDescription)\n      }\n    },\n    selectedCancelBorrow(newVal) {\n      this.$emit('update-cancel-form', { field: 'borrowId', value: newVal })\n    }\n  },\n  methods: {\n    getImagePreview(image) {\n      if (image instanceof File) {\n        return URL.createObjectURL(image)\n      }\n      return image\n    },\n    triggerBorrowUpload() {\n      this.$refs.borrowFileInput.value = ''\n      this.$refs.borrowFileInput.click()\n    },\n    triggerReturnUpload() {\n      this.$refs.returnFileInput.value = ''\n      this.$refs.returnFileInput.click()\n    },\n    handleBorrowUpload(event) {\n      this.$emit('handle-image-upload', event, 'borrow')\n      event.target.value = ''\n    },\n    handleReturnUpload(event) {\n      this.$emit('handle-image-upload', event, 'return')\n      event.target.value = ''\n    },\n    async loadProjects() {\n      try {\n        const response = await this.$http.get('/api/tasks')\n        if (response.data && Array.isArray(response.data)) {\n          this.projectOptions = response.data\n            .filter(task => isActive(task.status))\n            .map(task => ({\n              label: task.task_name,\n              value: task.task_name\n            }))\n        }\n      } catch { // ignore\n        \n      }\n    },\n    async loadUsers() {\n      try {\n        const response = await this.$http.get('/api/users')\n        if (response.data && Array.isArray(response.data)) {\n          // กรองผู้ใช้ปัจจุบันออก\n          const currentUserName = this.currentUserName\n          this.users = response.data\n            .filter(user => {\n              const userName = `${user.firstname} ${user.lastname}`.trim()\n              return userName !== currentUserName\n            })\n            .map(user => ({\n              ...user,\n              displayName: `${user.firstname} ${user.lastname}`.trim()\n            }))\n          this.filteredUsers = this.users.slice(0, this.maxDisplayUsers)\n        }\n      } catch { // ignore\n        \n      }\n    },\n\n    searchUsers(event) {\n      const query = event.query.toLowerCase().trim()\n\n      // Get already selected colleagues\n      const selectedColleagues = this.borrowForm?.colleagues || []\n      const selectedNames = selectedColleagues.map(c => c.name)\n\n      // Filter out already selected colleagues\n      let availableUsers = this.users.filter(user =>\n        !selectedNames.includes(user.displayName)\n      )\n\n      if (query === '') {\n        this.filteredUsers = availableUsers.slice(0, this.maxDisplayUsers)\n      } else {\n        const filtered = availableUsers.filter(user =>\n          user.displayName.toLowerCase().includes(query) ||\n          user.username.toLowerCase().includes(query) ||\n          (user.position && user.position.toLowerCase().includes(query)) ||\n          (user.department && user.department.toLowerCase().includes(query))\n        )\n        this.filteredUsers = filtered.slice(0, this.maxDisplayUsers)\n      }\n    },\n\n    showAllUsers() {\n      // Get already selected colleagues\n      const selectedColleagues = this.borrowForm?.colleagues || []\n      const selectedNames = selectedColleagues.map(c => c.name)\n\n      // Filter out already selected colleagues\n      const availableUsers = this.users.filter(user =>\n        !selectedNames.includes(user.displayName)\n      )\n\n      this.filteredUsers = availableUsers.slice(0, this.maxDisplayUsers)\n    },\n\n    onColleagueSelect(event) {\n      const user = event.value\n      if (user && user.displayName) {\n        // ตรวจสอบว่าไม่ได้เลือกซ้ำ\n        const colleagues = this.borrowForm?.colleagues || []\n        const alreadySelected = colleagues.some(c => c.name === user.displayName)\n\n        if (!alreadySelected) {\n          const newColleagues = [...colleagues, {\n            name: user.displayName,\n            position: user.position || '',\n            department: user.department || ''\n          }]\n          this.$emit('update-borrow-form', { field: 'colleagues', value: newColleagues })\n        }\n\n        // Clear selection\n        this.selectedColleague = null\n      }\n    },\n\n    removeColleague(index) {\n      const colleagues = [...(this.borrowForm?.colleagues || [])]\n      colleagues.splice(index, 1)\n      this.$emit('update-borrow-form', { field: 'colleagues', value: colleagues })\n    },\n\n    getFormTitle() {\n      const titles = {\n        borrow: 'แจ้งใช้รถ',\n        return: 'แจ้งคืนรถ',\n        cancel: 'ยกเลิกการจอง'\n      }\n      return titles[this.activeForm] || 'ฟอร์ม'\n    },\n    handleDialogClose() {\n      this.$emit('close-form')\n    },\n    confirmSubmit(type) {\n      const messages = {\n        borrow: 'ยืนยันการแจ้งใช้รถ?',\n        return: 'ยืนยันการแจ้งคืนรถ?',\n        cancel: 'ยืนยันการยกเลิกการจอง?'\n      }\n\n      this.confirmMessage = messages[type]\n      this.pendingAction = type\n      this.showConfirm = true\n    },\n    handleConfirm() {\n      this.showConfirm = false\n\n      if (this.pendingAction === 'borrow') {\n        this.$emit('submit-borrow')\n      } else if (this.pendingAction === 'return') {\n        this.$emit('submit-return')\n      } else if (this.pendingAction === 'cancel') {\n        this.$emit('submit-cancel')\n      }\n\n      this.pendingAction = null\n    },\n    updateBorrowForm(field, value) {\n      this.$emit('update-borrow-form', { field, value })\n    },\n    updateReturnForm(field, value) {\n      this.$emit('update-return-form', { field, value })\n    },\n    updateCancelForm(field, value) {\n      this.$emit('update-cancel-form', { field, value })\n    },\n    formatDate(date) {\n      return new Date(date).toLocaleDateString('th-TH', {\n        day: '2-digit',\n        month: '2-digit',\n        year: 'numeric'\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.colleagues-section {\n  margin-top: 0.5rem;\n}\n\n.colleague-search {\n  margin-bottom: 1rem;\n}\n\n.colleagues-title {\n  margin: 1rem 0 0.5rem 0;\n  color: #495057;\n  font-weight: 600;\n}\n\n.colleagues-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.colleague-card {\n  display: flex;\n  align-items: center;\n  padding: 1rem;\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  background: #f8f9fa;\n  transition: all 0.2s ease;\n}\n\n.colleague-card:hover {\n  border-color: #dee2e6;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.colleague-details {\n  flex: 1;\n}\n\n.colleague-name {\n  font-weight: 600;\n  color: #212529;\n  margin-bottom: 0.25rem;\n}\n\n.colleague-position,\n.colleague-department {\n  font-size: 0.875rem;\n  color: #6c757d;\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  margin-bottom: 0.125rem;\n}\n\n.colleague-position i,\n.colleague-department i {\n  font-size: 0.75rem;\n}\n\n.remove-btn {\n  margin-left: 0.5rem;\n}\n\n.no-colleagues {\n  text-align: center;\n  padding: 2rem;\n  color: #6c757d;\n  font-style: italic;\n}\n\n.no-colleagues i {\n  font-size: 2rem;\n  margin-bottom: 0.5rem;\n  display: block;\n}\n\n.user-option {\n  padding: 0.5rem;\n}\n\n.user-name {\n  font-weight: 600;\n  margin-bottom: 0.25rem;\n}\n\n.user-role {\n  font-size: 0.875rem;\n  color: #6c757d;\n}\n</style>\n\n<style scoped>\n.input-group {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.input-label {\n  font-weight: 500;\n  color: #495057;\n  font-size: 0.9rem;\n}\n\n.corporate-dialog {\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n}\n\n.corporate-dialog :deep(.p-dialog-header) {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  border-radius: 8px 8px 0 0;\n  padding: 1.5rem;\n}\n\n.corporate-dialog :deep(.p-dialog-title) {\n  font-weight: 600;\n  font-size: 1.25rem;\n}\n\n.dialog-content {\n  padding: 2rem;\n  background: #fafafa;\n}\n\n.form-container {\n  background: white;\n  padding: 2rem;\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n}\n\n.form-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 1.5rem;\n  margin-bottom: 1.5rem;\n}\n\n.full-width {\n  grid-column: 1 / -1;\n}\n\n.corporate-input,\n.corporate-dropdown {\n  border: 2px solid #e9ecef;\n  border-radius: 6px;\n  padding: 0.75rem;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n}\n\n.corporate-input:focus,\n.corporate-dropdown:focus {\n  border-color: #667eea;\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n}\n\n.readonly-field {\n  background: #f8f9fa;\n  color: #6c757d;\n}\n\n.file-upload-section {\n  grid-column: 1 / -1;\n}\n\n.upload-label {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 500;\n  color: #495057;\n}\n\n.file-input {\n  display: none;\n}\n\n.image-preview-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.75rem;\n  margin-top: 0.75rem;\n}\n\n.image-preview-item {\n  position: relative;\n  width: 80px;\n  height: 80px;\n}\n\n.preview-img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  border-radius: 8px;\n  border: 1px solid #dee2e6;\n}\n\n.image-preview-list .remove-btn {\n  position: absolute;\n  top: -8px;\n  right: -8px;\n  width: 22px;\n  height: 22px;\n  background: #ef4444;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  color: white;\n  font-size: 12px;\n}\n\n.image-preview-list .remove-btn:hover {\n  background: #dc2626;\n}\n\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 1rem;\n  margin-top: 1.5rem;\n}\n\n.form-actions .p-button {\n  min-width: 140px;\n  padding: 0.75rem 1.5rem;\n  font-weight: 500;\n}\n\n/* Confirmation Dialog */\n.confirm-dialog :deep(.p-dialog-header) {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  border-radius: 8px 8px 0 0;\n  padding: 1.5rem;\n}\n\n.confirm-content {\n  text-align: center;\n  padding: 2rem;\n}\n\n.confirm-icon {\n  margin-bottom: 1rem;\n}\n\n.confirm-icon i {\n  font-size: 3rem;\n  color: #667eea;\n}\n\n.confirm-message {\n  font-size: 1.1rem;\n  margin-bottom: 2rem;\n  color: #495057;\n}\n\n.confirm-buttons {\n  display: flex;\n  justify-content: center;\n  gap: 1rem;\n}\n\n.confirm-buttons .p-button {\n  min-width: 120px;\n  padding: 0.75rem 1.5rem;\n  font-weight: 500;\n}\n\n@media (max-width: 768px) {\n  .form-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .corporate-dialog {\n    width: 95vw !important;\n    max-width: none !important;\n  }\n\n  .dialog-content {\n    padding: 1rem;\n  }\n\n  .form-container {\n    padding: 1rem;\n  }\n\n  .confirm-content {\n    padding: 1.5rem;\n  }\n\n  .confirm-buttons {\n    flex-direction: column;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}